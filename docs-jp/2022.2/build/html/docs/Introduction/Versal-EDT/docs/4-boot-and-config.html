<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!-- OneTrust Cookies Consent Notice start for xilinx.github.io --> <!-- OneTrust Cookies Consent Notice end for xilinx.github.io --><title>ボードおよびコンフィギュレーション - エンベデッド デザイン チュートリアル 2022.2 の資料</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" /><!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]--><link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Debugging Using the Vitis Software Platform" href="3-debugging.html" />
    <link rel="prev" title="Versal ACAP CIPS and NoC (DDR) IP Core Configuration" href="2-cips-noc-ip-config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> エンベデッド デザイン チュートリアル
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">入門</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Versal-EDT.html">Versal ACAP エンベデッド デザイン チュートリアル</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-getting-started.html">入門</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-cips-noc-ip-config.html">Versal ACAP CIPS および NoC (DDR) IP コアの設定</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ブートおよびコンフィギュレーション</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#system-software">システム ソフトウェア</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#platform-loader-and-manager">プラットフォーム ローダーおよびマネージャー</a></li>
<li class="toctree-l4"><a class="reference internal" href="#u-boot">U-Boot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trusted-firmware-a">Trusted Firmware-A</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#generating-boot-image-for-standalone-application">スタンドアロン アプリケーションのブート イメージの生成</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-petalinux-images-on-a-versal-board-using-jtag">JTAG を使用した Versal ボードへの PetaLinux イメージのロード</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-sd-boot-mode">SD ブート モードのブート シーケンス</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-qspi-boot-mode">QSPI ブート モードのブート シーケンス</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-ospi-boot-mode">OSPI ブート モードのブート シーケンス</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-emmc-boot-mode">eMMC ブート モードのブート シーケンス</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flashing-linux-images-to-the-emmc-flash">eMMC フラッシュ メモリへの Linux イメージの書き込み</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3-debugging.html">Vitis ソフトウェア プラットフォームを使用したデバッグ</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-system-design-example.html">スカラー型エンジンと適応型エンジンを使用したシステム デザイン例</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-system-design-example-HSDP.html">SmartLynq+ モジュールを使用した高速デバッグ ポート (HSDP) のシステム デザイン例</a></li>
<li class="toctree-l2"><a class="reference internal" href="7-system-design-example-ssit-device.html">SSI デバイスのシステム デザイン例</a></li>
<li class="toctree-l2"><a class="reference internal" href="A-creating-plm.html">付録: PLM の作成</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ZynqMPSoC-EDT/ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC エンベデッド デザイン チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 エンベデッド デザイン チュートリアル</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">機能チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">FSBL (First Stage Boot Loader)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/microblaze-system/README.html">エンベデッド MicroBlaze プロセッサのプログラム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/sw-profiling/sw-profiling.html">システム デバッガーを使用したアプリケーションのプロファイル</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">設計チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Design_Tutorials/MPSoC_Graphic_Subsystem/README.html">グラフィックスおよび DisplayPort ベースのサブシステムのセットアップ例</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">デバッグ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis エンベデッド ソフトウェア デバッグ ガイド (UG1515) 2021.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ユーザー ガイド</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/SPA-UG/SPA-UG.html">システム パフォーマンス解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone ベンチマーク</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">すべてのリリース</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2022.1/build/html/index.html">2022.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2020.2/build/html/index.html">2020.2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">エンベデッド デザイン チュートリアル</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Versal-EDT.html">Versal ACAP エンベデッド デザイン チュートリアル</a> &raquo;</li>
      <li>ブートおよびコンフィギュレーション</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Introduction/Versal-EDT/docs/4-boot-and-config.rst.txt" rel="nofollow"> このページのソースを表示</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="boot-and-configuration">
<h1>ブートおよびコンフィギュレーション<a class="headerlink" href="#boot-and-configuration" title="Permalink to this heading">¶</a></h1>
<p>Versal® ACAP 用にブートローダー、ベアメタル アプリケーション (APU/RPU 用)、および Linux オペレーティング システムを統合してロードする方法を示します。この章では、次のトピックについて説明します。</p>
<ul class="simple">
<li><p>システム ソフトウェア: PLM、トラステッド ファームウェア A (TF-A)、U-Boot</p></li>
<li><p>スタンドアロン アプリケーションのブート イメージを生成する手順。</p></li>
<li><p>SD ブート、QSPI、および OSPI ブート モードのブート シーケンス。</p></li>
</ul>
<p>Vitis™ ソフトウェア プラットフォームと PetaLinux ツール フローを使用して、これらの構成にします。<a class="reference internal" href="2-cips-noc-ip-config.html"><span class="doc">「Versal ACAP CIPS および NoC (DDR) IP コアの設定」</span></a>では、PS 内に各プロセッシング ユニットのソフトウェア ブロックを作成することにのみに重点を置いていましたが、この章ではより大規模なシステムの一部としてこれらのブロックをロードする方法を説明します。</p>
<section id="system-software">
<h2>システム ソフトウェア<a class="headerlink" href="#system-software" title="Permalink to this heading">¶</a></h2>
<p>この章のブートおよびコンフィギュレーションの説明の大部分は、ここで挙げるシステム ソフトウェア ブロックについてです。</p>
<section id="platform-loader-and-manager">
<h3>プラットフォーム ローダーおよびマネージャー<a class="headerlink" href="#platform-loader-and-manager" title="Permalink to this heading">¶</a></h3>
<p>PLM (プラットフォーム ローダーおよびマネージャー) は、Versal ACAP の PMC (Platform Management Controller) ブロック内の専用プロセッサの 1 つで実行されるソフトウェアです。プラットフォーム管理、エラー管理、パーシャル リコンフィギュレーション、デバイスのサブシステム再起動など、ブートおよびランタイムを管理します。PLM はイメージを再ロードし、パーシャル PDI とサービス割り込みをロードできます。PLM はブート ソースからプログラマブル デバイス イメージを読み取り、NoC の初期化、DDR メモリの初期化、プログラマブル ロジック、およびプロセッシング システムを、含むシステムのコンポーネントを設定してから、デバイスのブートを完了します。</p>
</section>
<section id="u-boot">
<h3>U-Boot<a class="headerlink" href="#u-boot" title="Permalink to this heading">¶</a></h3>
<p>U-Boot はセカンダリ ブートローダーとして機能します。U-Boot は、PLM ハンドオフ後に Linux を Arm A72 APU にロードし、ボード コンフィギュレーションに基づいてプロセッシング システム内の残りのペリフェラルをコンフィギュレーションします。U-Boot は、eMMC、SATA、TFTP、SD、QSPI などのさまざまなメモリ ソースからイメージを取得できます。U-Boot は、PetaLinux ツール フローを使用して設定およびビルドできます。</p>
</section>
<section id="trusted-firmware-a">
<h3>トラステッド ファームウェア A<a class="headerlink" href="#trusted-firmware-a" title="Permalink to this heading">¶</a></h3>
<p>トラステッド ファームウェア A (ATF) は、APU の EL3 (例外レベル 3) で実行される透過的なベアメタル アプリケーション レイヤーです。ATF には、セキュア ワールドと非セキュア ワールドを切り替えるためのセキュア モニター レイヤーが含まれます。セキュア モニターの呼び出しと TBBR (Trusted Board Boot Requirements) の実装により、Versal ACAP の APU に Linux をロードするには ATF レイヤーが必須です。PLM は APU で実行される ATF をロードします。ATF は EL3 で動作し続けてサービス要求を待ちます。PLM はまた、APU が実行される DDR メモリに U-Boot をロードします。DDR メモリは、Linux OS を SMP モードで APU にロードします。ATF (<cite>bl31.elf</cite>) は、デフォルトで PetaLinux に構築されます。このファイルは、PetaLinux プロジェクト イメージ ディレクトリにあります。</p>
</section>
</section>
<section id="generating-boot-image-for-standalone-application">
<span id="id1"></span><h2>スタンドアロン アプリケーションのブート イメージの生成<a class="headerlink" href="#generating-boot-image-for-standalone-application" title="Permalink to this heading">¶</a></h2>
<p>Vitis ソフトウェア プラットフォームでは、Versal ACAP のブート イメージ作成ウィザードがサポートされています。ブート イメージ PDI または <code class="docutils literal notranslate"><span class="pre">Boot.bin</span></code> を生成するには、Bootgen コマンド ライン オプションを使用するか、Vitis のウィザードを使用します。このチュートリアルでは、Vitis ソフトウェア プラットフォーム パッケージに含まれる Bootgen を使用したブート イメージを作成する方法を説明します。Bootgen の主な機能は、ブータブル イメージのさまざまなパーティションを統合することです。Bootgen は、Bootgen イメージ フォーマット (BIF) ファイルを入力として使用し、バイナリ BIN または PDI フォーマットで 1 つのファイル イメージを生成します。不揮発性メモリ (QSPI または SD カード) にロードできる単一のファイル イメージを出力します。次の手順に従って、PDI/BIN ファイルを生成します。</p>
<ol class="arabic">
<li><p>Vitis IDE で [XSCT Console] ビューがまだ開いていない場合は、<strong>[Window] → [Show View]</strong> をクリックして開きます。Show View ウィザードの検索バーに「<cite>xsct console</cite>」と入力します。<strong>[Open]</strong> をクリックして、コンソールを開きます。</p>
<img alt="../../../../_images/image49.png" src="../../../../_images/image49.png" />
</li>
<li><p>[XSCT Console] で次のコマンドを入力して、ブート イメージを生成するフォルダーを作成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">bootimages</span>
<span class="n">cd</span> <span class="n">bootimages</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;board-name&gt;/ready_to_test/qspi_images/standalone/&lt;cips</span> <span class="pre">or</span> <span class="pre">cips_noc&gt;/&lt;apu</span> <span class="pre">or</span> <span class="pre">rpu&gt;/</span></code> ディレクトリにある sd_boot.bif ファイル、<code class="docutils literal notranslate"><span class="pre">&lt;Vitis</span> <span class="pre">platform</span> <span class="pre">project&gt;/hw/&lt;.pdi-file&gt;</span></code> ディレクトリにある PDI ファイル、<code class="docutils literal notranslate"><span class="pre">&lt;Vitis</span> <span class="pre">application-project&gt;/Debug</span></code> フォルダーにあるアプリケーションの ELF ファイルを、手順 2 で作成したフォルダーにコピーします。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>必要に応じて、任意のテキスト エディターで <code class="docutils literal notranslate"><span class="pre">sd_boot.bif</span></code> ファイルを開き、Vitis プロジェクトごとに PDI または ELF の名前を変更します。</p>
</div>
</li>
<li><p>[XSCT Console] ビューで次のコマンドを実行します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bootgen</span> <span class="o">-</span><span class="n">image</span> <span class="o">&lt;</span><span class="n">bif</span> <span class="n">filename</span><span class="o">&gt;.</span><span class="n">bif</span> <span class="o">-</span><span class="n">arch</span> <span class="n">versal</span> <span class="o">-</span><span class="n">o</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span>
</pre></div>
</div>
<p>[XSCT Console] ビューには、次のログが表示されます。</p>
<img alt="../../../../_images/image51.jpeg" src="../../../../_images/image51.jpeg" />
</li>
</ol>
</section>
<section id="loading-petalinux-images-on-a-versal-board-using-jtag">
<span id="loading-petalinux-images-versal-board-using-jtag"></span><h2>JTAG を使用した Versal ボードへの Petalinux イメージのロード<a class="headerlink" href="#loading-petalinux-images-on-a-versal-board-using-jtag" title="Permalink to this heading">¶</a></h2>
<p>このセクションでは、Versal ボードで JTAG モードを使用して Versal PetaLinux イメージをロードする方法について説明します。</p>
<ol class="arabic">
<li><p>次のコマンドを使用して、Linux イメージをビルドします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-build
</pre></div>
</div>
</li>
<li><p>次のコマンドを実行して BOOT.BIN をビルドします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-package --boot --uboot
</pre></div>
</div>
</li>
<li><p>次のように、Versal プロジェクト ディレクトリから <cite>petalinux</cite> コマンドを使用して Tcl スクリプトを作成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-boot --jtag --kernel --tcl versal.tcl
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p><code class="docutils literal notranslate"><span class="pre">versal.tcl</span></code> ファイルには、適切なターゲットを選択し、DDR メモリ内の必要な場所にアプリケーション ファイルをダウンロードするためのコマンドが含まれています。</p>
<img alt="../../../../_images/versal_tcl.JPG" src="../../../../_images/versal_tcl.JPG" />
</div>
</li>
<li><p>次のように、生成されたファイル <cite>versal.tcl</cite> を変更します。</p>
<ol class="loweralpha">
<li><p>このチュートリアルでは <cite>rootfs</cite> イメージを使用するため、<cite>ramdisk.cpio.gz</cite> の名前を <cite>rootfs.cpio.gz.u-boot</cite> に変更します。</p></li>
<li><p><cite>con</cite> コマンドの前に次の行を追加して、<cite>BOOT.BIN</cite> を DDR メモリにロードします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">puts</span> <span class="n">stderr</span> <span class="s2">&quot;INFO: Loading image: BOOT.BIN at 0x70000000&quot;</span>
<span class="n">dow</span> <span class="o">-</span><span class="n">data</span> <span class="o">-</span><span class="n">force</span> <span class="s2">&quot;BOOT.BIN&quot;</span> <span class="mh">0x70000000</span>
     <span class="n">after</span> <span class="mi">2000</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>次の図と同じように、ブート モード スイッチ SW1 を ON-ON-ON-ON JTAG に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/jtag-boot-mode.png"><img alt="../../../../_images/jtag-boot-mode.png" src="../../../../_images/jtag-boot-mode.png" style="width: 500px;" /></a>
</li>
<li><p>Tera Term シリアル アプリケーションをデフォルトの <strong>115200,N8</strong> に設定し、Tera Term コンソールを開きます。</p></li>
<li><p>XSCT コンソールで、<cite>connect</cite> コマンドを使用して JTAG を介してターゲットに接続します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">connect</span>
</pre></div>
</div>
<p>connect コマンドは、接続のチャネル ID を返します。</p>
</li>
<li><p>次の target コマンドを実行して、使用可能なターゲットを一覧表示し、ID を使用してターゲットを選択します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span>
</pre></div>
</div>
<p>ターゲットが JTAG チェーンで検出されると ID が割り当てられるため、ID はセッションごとに変更される可能性があります。</p>
</li>
<li><p>次のコマンドを使用して、VCK190 ボードの DDR メモリに <cite>BOOT.BIN</cite>、<cite>rootfs.cpio.gz.uboot</cite>、および <cite>boot.scr</cite> イメージをロードする <cite>versal.tcl</cite> ファイルをダウンロードします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span> <span class="mi">1</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">rst</span>
<span class="n">xsct</span> <span class="o">&gt;</span> <span class="n">source</span> <span class="n">versal</span><span class="o">.</span><span class="n">tcl</span>
</pre></div>
</div>
</li>
<li><p>先のコマンドを実行したあとに、シリアル コンソールに PLM と U-Boot のブート ログが表示されます。例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">-</span><span class="n">Boot</span> <span class="mf">2022.01</span> <span class="p">(</span><span class="n">Feb</span> <span class="mi">16</span> <span class="mi">2022</span> <span class="o">-</span> <span class="mi">14</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">10</span> <span class="o">+</span><span class="mi">0000</span><span class="p">)</span>

<span class="n">CPU</span><span class="p">:</span>   <span class="n">Versal</span>
<span class="n">Silicon</span><span class="p">:</span> <span class="n">v2</span>
<span class="n">Model</span><span class="p">:</span> <span class="n">Xilinx</span> <span class="n">Versal</span> <span class="n">vck190</span> <span class="n">Eval</span> <span class="n">board</span> <span class="n">revA</span>
<span class="n">DRAM</span><span class="p">:</span>  <span class="mi">8</span> <span class="n">GiB</span>
<span class="n">EL</span> <span class="n">Level</span><span class="p">:</span>       <span class="n">EL2</span>
<span class="n">MMC</span><span class="p">:</span>   <span class="n">mmc</span><span class="nd">@f1050000</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Loading</span> <span class="n">Environment</span> <span class="kn">from</span> <span class="nn">nowhere...</span> <span class="n">OK</span>
<span class="n">In</span><span class="p">:</span>    <span class="n">serial</span><span class="nd">@ff000000</span>
<span class="n">Out</span><span class="p">:</span>   <span class="n">serial</span><span class="nd">@ff000000</span>
<span class="n">Err</span><span class="p">:</span>   <span class="n">serial</span><span class="nd">@ff000000</span>
<span class="n">Bootmode</span><span class="p">:</span> <span class="n">JTAG_MODE</span>
<span class="n">Net</span><span class="p">:</span>
<span class="n">ZYNQ</span> <span class="n">GEM</span><span class="p">:</span> <span class="n">ff0c0000</span><span class="p">,</span> <span class="n">mdio</span> <span class="n">bus</span> <span class="n">ff0c0000</span><span class="p">,</span> <span class="n">phyaddr</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interface</span> <span class="n">rgmii</span><span class="o">-</span><span class="nb">id</span>
<span class="n">zynq_gem</span> <span class="n">ethernet</span><span class="nd">@ff0c0000</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">eth</span> <span class="n">PHY</span> <span class="nb">id</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span>

<span class="ne">Warning</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0c0000</span> <span class="p">(</span><span class="n">eth0</span><span class="p">)</span> <span class="n">using</span> <span class="n">random</span> <span class="n">MAC</span> <span class="n">address</span> <span class="o">-</span> <span class="n">fe</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="n">f4</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="mi">5</span><span class="n">c</span><span class="p">:</span><span class="n">c7</span>
<span class="n">eth0</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0c0000</span>
<span class="n">ZYNQ</span> <span class="n">GEM</span><span class="p">:</span> <span class="n">ff0d0000</span><span class="p">,</span> <span class="n">mdio</span> <span class="n">bus</span> <span class="n">ff0c0000</span><span class="p">,</span> <span class="n">phyaddr</span> <span class="mi">2</span><span class="p">,</span> <span class="n">interface</span> <span class="n">rgmii</span><span class="o">-</span><span class="nb">id</span>
<span class="n">zynq_gem</span> <span class="n">ethernet</span><span class="nd">@ff0d0000</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">eth</span> <span class="n">PHY</span> <span class="nb">id</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span>

<span class="ne">Warning</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0d0000</span> <span class="p">(</span><span class="n">eth1</span><span class="p">)</span> <span class="n">using</span> <span class="n">random</span> <span class="n">MAC</span> <span class="n">address</span> <span class="o">-</span> <span class="n">c6</span><span class="p">:</span><span class="n">e7</span><span class="p">:</span><span class="n">dd</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b1</span><span class="p">:</span><span class="mi">05</span>
<span class="p">,</span> <span class="n">eth1</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0d0000</span>
      <span class="n">Hit</span> <span class="nb">any</span> <span class="n">key</span> <span class="n">to</span> <span class="n">stop</span> <span class="n">autoboot</span><span class="p">:</span>  <span class="mi">5</span>  <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">0</span>
      <span class="n">Versal</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="boot-sequence-for-sd-boot-mode">
<span id="boot-sequence-sd-boot-mode"></span><h2>SD ブート モードのブート シーケンス<a class="headerlink" href="#boot-sequence-for-sd-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>次の手順は、SD ブートモードのブート シーケンスを示しています。</p>
<ol class="arabic">
<li><p>イメージを確認するには、必要なイメージを SD カードにコピーします。</p>
<ul class="simple">
<li><p>スタンドアロンの場合は、<cite>BOOT.BIN</cite> を SD カードにコピーします。</p></li>
<li><p>Linux イメージの場合は、<cite>&lt;plnx-proj-root&gt;/images/linux</cite> に移動し、<cite>BOOT.BIN</cite>、イメージ、<cite>rootfs.cpio.gz.uboot</cite>、<cite>boot.scr</cite> を SD カードにコピーします。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>リリースされたパッケージ パス (<code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;vck190</span> <span class="pre">or</span> <span class="pre">vmk180</span> <span class="pre">or</span> <span class="pre">vpk180&gt;/ready_to_test/qspi_images/linux/</span></code>) の一部として、すぐにテスト可能なイメージを使用して VCK190/VMK180/VPK180 ボードを起動するか、<a class="reference internal" href="7-system-design-example-ssit-device.html#creating-linux-images-using-petalinux"><span class="std std-ref">「サンプル プロジェクト: PetaLinux を使用した Linux イメージの作成」</span></a>を参照し、PetaLinux ツールを使用して独自の Linux イメージ セットをビルドします。</p>
</div>
</li>
<li><p>SD カードを VMK180/VCK190/VPK180 ボードの J302 コネクタに挿入します。</p></li>
<li><p>Micro USB ケーブルの一端を VMK180/VCK190/VPK180 ボードの Micro USB ポート (J207) に接続し、もう一端をホスト コンピューターの空いている USB ポートに接続します。</p></li>
<li><p>スイッチ SW1 を次の図のように設定し、ボードを SD ブート モード (1-ON、2-OFF、3-OFF、4-OFF) に設定します。</p>
<img alt="../../../../_images/sd_boot_mode.JPG" src="../../../../_images/sd_boot_mode.JPG" />
</li>
<li><p>12V 電源を VMK180/VCK190/VPK180 の 6 ピン Molex コネクタに接続します。</p></li>
<li><p>使用しているホスト コンピューターで Tera Term または Minicom を使用して、端末セッションを開始します。次の図に示すように、システムの COM ポートとボー レートを設定します。</p>
<img alt="../../../../_images/image46.png" src="../../../../_images/image46.png" />
</li>
<li><p>ポート設定では、デバイス マネージャーで COM ポートを検証し、com ポートに対して Interface-0 を選択します。</p></li>
<li><p>電源スイッチ (SW13) を使用して VMK180/VCK190/VPK180 ボードに電源を投入します。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>スタンドアロン イメージのログが端末に表示されます。Linux イメージの場合は、端末で起動シーケンスの後に <cite>user: root</cite> および <cite>pw: root</cite> を使用してログインできます。その後、端末で <cite>gpiotest</cite> を実行します。次の図のようにログが表示されます。</p>
</div>
<img alt="../../../../_images/led_example_console_prints.PNG" src="../../../../_images/led_example_console_prints.PNG" />
</li>
</ol>
</section>
<section id="boot-sequence-for-qspi-boot-mode">
<h2>QSPI ブート モードのブート シーケンス<a class="headerlink" href="#boot-sequence-for-qspi-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>このセクションでは、QSPI ブートモードのブート シーケンスを示します。このためには、次の図に示すように QSPI ドーター カード (製品番号: X_EBM-01、REV_A01) を接続する必要があります。</p>
<p><strong>図 2:<em> </em>VCK190 のドーター カード</strong></p>
<img alt="../../../../_images/vck190_production_board_QSPI_daughter_card.jpg" src="../../../../_images/vck190_production_board_QSPI_daughter_card.jpg" />
<p>次の手順に従って、イメージをドーター カードのフラッシュ メモリに書き込む必要があります。</p>
<ol class="arabic">
<li><p>カードの電源を切った状態で、QSPI ドーター カードを取り付けます。</p></li>
<li><p>ボードに電源を投入します。<a class="reference internal" href="#loading-petalinux-images-versal-board-using-jtag"><span class="std std-ref">「JTAG を使用した Versal ボードへの PetaLinux イメージのロード」</span></a>セクションから Versal Tcl の修正バージョンを実行し、U-Boot が実行されていて、Boot.BIN が DDR の場所にコピーされていることを確認します。</p></li>
<li><p>U-Boot の段階で、「<strong>Hit any key to stop autoboot:</strong>」というメッセージが表示されたら、いずれかのキーを押し、次のコマンドを実行して QSPI ドーター カードのイメージをフラッシュ メモリに書き込みます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">check</span> <span class="n">QSPI</span> <span class="ow">is</span> <span class="n">available</span> <span class="ow">or</span> <span class="ow">not</span>
<span class="n">sf</span> <span class="n">probe</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">//</span> <span class="n">Erase</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">256</span> <span class="n">MB</span>
<span class="n">sf</span> <span class="n">erase</span> <span class="mh">0x0</span> <span class="mh">0x10000000</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x70000000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x0</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x70000000</span> <span class="mh">0x0</span> <span class="o">&lt;</span><span class="n">BOOT</span><span class="o">.</span><span class="n">BIN_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">Image</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x00200000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0xF00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x00200000</span> <span class="mh">0xF00000</span> <span class="o">&lt;</span><span class="n">Image_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x04000000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x2E00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x04000000</span> <span class="mh">0x2E00000</span> <span class="o">&lt;</span><span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x20000000</span>  <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x7F80000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x20000000</span> <span class="mh">0x7F80000</span> <span class="o">&lt;</span><span class="n">boot</span><span class="o">.</span><span class="n">scr_filesize_in_hex</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>次の図のように、メージをフラッシュ メモリに書き込んだ後、ボードの電源スイッチをオフにし、SW1 ブート モード ピンの設定を QSPI ブート モード (ON-OFF-ON-ON, M[0:3] = 0100) に変更します。</p>
<img alt="../../../../_images/image52.png" src="../../../../_images/image52.png" />
</li>
<li><p>ボードの電源を切って入れ直します。これで、QSPI フラッシュ内のイメージを使用してボードが起動します。</p></li>
</ol>
</section>
<section id="boot-sequence-for-ospi-boot-mode">
<h2>OSPI ブート モードのブート シーケンス<a class="headerlink" href="#boot-sequence-for-ospi-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>OSPI ブート モード用にデザインをコンフィギュレーションするには、「OSPI ブート モードのコンフィギュレーション」を参照してください。このセクションでは、OSPI ブートモードのブート シーケンスを示します。このためには、次の図のように OSPI ドーター カード (パーツ番号 X-EBM-03 REV_A02) を接続する必要があります。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>OSPI ドーター カードは VCK190 キットには含まれていません。</p>
</div>
<img alt="../../../../_images/X-EBM-03_OSPI_Daughter_card.jpg" src="../../../../_images/X-EBM-03_OSPI_Daughter_card.jpg" />
<p>イメージをドーター カードのフラッシュ メモリに書き込むには、次の手順に従います。</p>
<ol class="arabic">
<li><p>カードの電源を切った状態で、OSPI ドーター カードを取り付けます。</p></li>
<li><p>ボードに電源を投入します。<a class="reference internal" href="#loading-petalinux-images-versal-board-using-jtag"><span class="std std-ref">「JTAG を使用した Versal ボードへの PetaLinux イメージのロード」</span></a> セクションで、セクションから Versal Tcl の修正バージョンを実行し、U-Boot が実行されていて、Boot.BIN が DDR の場所にコピーされていることを確認します。</p></li>
<li><p>U-Boot の段階で、「<strong>Hit any key to stop autoboot:</strong>」というメッセージが表示されたら、いずれかのキーを押し、次のコマンドを実行して OSPI ドーター カードのイメージをフラッシュ メモリに書き込みます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Check</span> <span class="k">if</span> <span class="n">OSPI</span> <span class="n">flash</span> <span class="ow">is</span> <span class="n">available</span> <span class="ow">or</span> <span class="ow">not</span>
<span class="n">sf</span> <span class="n">probe</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">//</span> <span class="n">Erase</span> <span class="n">the</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">256</span> <span class="n">MB</span>
<span class="n">sf</span> <span class="n">erase</span> <span class="mh">0x0</span> <span class="mh">0x10000000</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x70000000</span> <span class="n">to</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x0</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x70000000</span> <span class="mh">0x0</span> <span class="o">&lt;</span><span class="n">BOOT</span><span class="o">.</span><span class="n">BIN_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">Image</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x00200000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0xF00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x00200000</span> <span class="mh">0xF00000</span> <span class="o">&lt;</span><span class="n">Image_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x04000000</span> <span class="n">to</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x2E00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x04000000</span> <span class="mh">0x2E00000</span> <span class="o">&lt;</span><span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x20000000</span> <span class="n">to</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x7F80000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x20000000</span> <span class="mh">0x7F80000</span> <span class="o">&lt;</span><span class="n">boot</span><span class="o">.</span><span class="n">scr_filesize_in_hex</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>イメージを書き込んだら、ボードの電源スイッチをオフにします。</p></li>
<li><p>SW1 ブート モードのピン設定を OSPI ブート モードに変更します。つまり、MODE[0:3] pins = 0001、ON-ON-ON-OFF に変更します。</p></li>
<li><p>ボードの電源を切って入れ直します。これで、OSPI フラッシュ内のイメージを使用してボードが起動します。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>VPK180 量産ボードの場合、OSPI イメージはデザイン パッケージの一部として提供されません。VCK190 および VMK180の OSPI イメージのみがデザイン パッケージの一部として共有されます。</p>
</div>
</section>
<section id="boot-sequence-for-emmc-boot-mode">
<h2>eMMC ブート モードのブート シーケンス<a class="headerlink" href="#boot-sequence-for-emmc-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>eMMC ブート モード用にデザインをコンフィギュレーションするには、「eMMC ブート モードのコンフィギュレーション」を参照してください。このセクションでは、eMMC ブート モードのブート シーケンスを示します。このためには、次の図のように eMMC ドーター カード (パーツ番号 X-EBM-02、REV_A02) を接続する必要があります。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>eMMC ドーター カードは VCK190 キットには含まれていません。</p>
</div>
<img alt="../../../../_images/X-EBM-02_emmc_Daughter_card.jpg" src="../../../../_images/X-EBM-02_emmc_Daughter_card.jpg" />
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>VPK180 プロダクション ボードの場合、emmc イメージはデザイン パッケージの一部として提供されません。VCK190 および VMK180 の emmc イメージのみがデザイン パッケージの一部として共有されます。</p>
</div>
<p>Versal ACAP ボード上の eMMC フラッシュ メモリを初めてフォーマットする場合は、次の手順に従います。</p>
<ol class="arabic">
<li><p>カードの電源を切った状態で、eMMC ドーター カードを取り付けます。</p></li>
<li><p>次の図と同じように、ブート モード スイッチ SW1 を ON-ON-ON-ON JTAG に設定します。</p>
<img alt="../../../../_images/vck190_jtag_boot_mode_sw1_settings.png" src="../../../../_images/vck190_jtag_boot_mode_sw1_settings.png" />
<p>この例では、XSCT コンソールを使用して、ブート イメージ ファイル (boot.bin) をダウンロードします。eMMC フラッシュ メモリをフォーマットするのに Linux イメージをロードするため、U-boot コンソールを使用します。</p>
</li>
<li><p>ボードとホスト コンピューターにイーサネット ケーブルが接続されていることを確認してください。ホスト コンピューター上で dhcp および tftpb サーバーを設定します。</p></li>
<li><p>Linux イメージの <cite>BOOT.BIN</cite>、イメージ、<cite>rootfs.cpio.gz.u-boot</cite>、および <cite>boot.scr</cite> をホスト tftp ホーム ディレクトリにコピーします。</p></li>
<li><p>XSCT コンソールで、<cite>connect</cite> コマンドを使用して JTAG を介してターゲットに接続します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">connect</span>
</pre></div>
</div>
<p>connect コマンドは、接続のチャネル ID を返します。</p>
</li>
<li><p>次の <cite>target</cite> コマンドを実行して、使用可能なターゲットを一覧表示し、ID を使用してターゲットを選択します。ターゲットには JTAG チェーンで検出されたときに ID が割り当てられるので、ターゲット ID はセッションごとに変わります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span>
</pre></div>
</div>
</li>
<li><p>次のコマンドを使用して、VCK190 ボードに boot.bin をダウンロードし、U-Boot コンソールを取得します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span> <span class="mi">1</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">rst</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">device</span> <span class="n">program</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span>
</pre></div>
</div>
<p>このコマンドを実行したあとに、シリアル コンソールに PLM と U-Boot のブート ログが表示されます。</p>
</li>
<li><p>U-Boot の段階で、「<strong>Hit any key to stop autoboot:</strong>」というメッセージが表示されたら、いずれかのキーを押し、次のコマンドを実行して eMMC ドーター カードのイメージをフラッシュ メモリに書き込みます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dhcp</span>
<span class="n">tftpboot</span> <span class="mh">0x80000</span> <span class="n">Image</span>
<span class="n">tftpboot</span> <span class="mh">0x2000000</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span>
<span class="n">booti</span> <span class="mh">0x80000</span> <span class="mh">0x2000000</span> <span class="mh">0x1000</span>
</pre></div>
</div>
<p>先の U-Boot コマンドを実行したあと、Linux がブートを開始し、Linux コンソール プロンプトで停止し、ユーザーがコマンドを入力するのを待ちます。</p>
</li>
<li><p>Linux コンソール プロンプトから次のコマンドを実行して、eMMC Linux のブータブル パーティションを作成し、eMMC を FAT32 ファイルシステムでフォーマットします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>xilinx-vck190-20221:~$ fdisk /dev/mmcblk0
The number of cylinders for this disk is set to 233472.
There is nothing wrong with that, but this is larger than 1024,
and could in certain setups cause problems with:
1) software that runs at boot time (e.g., old versions of LILO)
2) booting and partitioning software from other OSs
(e.g., DOS FDISK, OS/2 FDISK)

Command (m for help): m
Command Action
a       toggle a bootable flag
b       edit bsd disklabel
c       toggle the dos compatibility flag
d       delete a partition
l       list known partition types
n       add a new partition
o       create a new empty DOS partition table
p       print the partition table
q       quit without saving changes
s       create a new empty Sun disklabel
t       change a partition&apos;s system id
u       change display/entry units
v       verify the partition table
w       write table to disk and exit

Command (m for help): n
Partition type
p   primary partition (1-4)
e   extended
p
Partition number (1-4): 1
First sector (16-14942207, default 16):
Using default value 16
Last sector or +size{,K,M,G,T} (16-14942207, default 14942207):
Using default value 14942207

Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table
fdisk: WARNING: rereading partition table failed, kernel still uses old table: Device or resource busy

xilinx-vck190-20221:~$ mkfs.vfat -F 32 -n boot /dev/mmcblk0p1
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>eMMC フラッシュ メモリは FAT32 ファイルシステムでフォーマットされています。</p>
</div>
<section id="flashing-linux-images-to-the-emmc-flash">
<h3>eMMC フラッシュ メモリへの Linux イメージの書き込み<a class="headerlink" href="#flashing-linux-images-to-the-emmc-flash" title="Permalink to this heading">¶</a></h3>
<p>Linux イメージを eMMC フラッシュ メモリに書き込むには、次の手順に従います。</p>
<ol class="arabic">
<li><p>カードの電源を切った状態で、eMMC ドーター カードを取り付けます。</p></li>
<li><p>ブート モード スイッチ SW1 を ON-ON-ON-ON JTAG に設定します。</p></li>
<li><p>ボードに電源を投入します。JTAG を介して DDR メモリにイメージをロードする方法については、<a class="reference internal" href="#loading-petalinux-images-versal-board-using-jtag"><span class="std std-ref">「JTAG を使用した Versal ボードへの PetaLinux イメージのロード」</span></a>を参照してください。</p></li>
<li><p>U-Boot の段階で、「<strong>Hit any key to stop autoboot:</strong>」というメッセージが表示されたら、いずれかのキーを押し、次のコマンドを実行して eMMC ドーター カードのイメージをフラッシュ メモリに書き込みます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Check</span> <span class="n">emmc</span> <span class="ow">is</span>  <span class="n">FAT</span> <span class="n">filesystem</span> <span class="n">formatted</span> <span class="ow">or</span> <span class="ow">not</span><span class="o">.</span>
<span class="n">fatls</span> <span class="n">mmc</span> <span class="mi">0</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x70000000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x70000000</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">Image</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x00200000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x00200000</span> <span class="n">Image</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x04000000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x04000000</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span> <span class="mh">0x20000000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x20000000</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>フラッシュ メモリに書き込んだあと、ボードの電源スイッチをオフにし、SW1 ブート モード ピンの設定を eMMC ブート モード ON-OFF-OFF-ON (MODE[0:3]= 0110) に変更します。</p></li>
<li><p>ボードの電源を切って入れ直します。これで、eMMC フラッシュ メモリ内のイメージを使用してボードが起動します。</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2-cips-noc-ip-config.html" class="btn btn-neutral float-left" title="Versal ACAP CIPS and NoC (DDR) IP Core Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 前の手順</a>
        <a href="3-debugging.html" class="btn btn-neutral float-right" title="Debugging Using the Vitis Software Platform" accesskey="n" rel="next">次の手順 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>© Copyright 2019-2023, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">最終更新日: 2023 年 2 月 3 日
<br>このページは最終更新日の英語版を翻訳したものです。最新版は、<a href="https://github.com/Xilinx/Embedded-Design-Tutorials">Github 英語版</a>を参照してください。      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>