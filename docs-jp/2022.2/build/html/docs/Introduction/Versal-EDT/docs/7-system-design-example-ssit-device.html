<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!-- OneTrust Cookies Consent Notice start for xilinx.github.io --> <!-- OneTrust Cookies Consent Notice end for xilinx.github.io --><title>Versal スタックド シリコン インターコネクト デバイスのシステム デザイン例 - エンベデッド デザイン チュートリアル 2022.2 の資料</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" /><!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]--><link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Appendix: Creating the PLM" href="A-creating-plm.html" />
    <link rel="prev" title="System Design Example for High-Speed Debug Port with SmartLynq+ Module" href="6-system-design-example-HSDP.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> エンベデッド デザイン チュートリアル
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">入門</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Versal-EDT.html">Versal ACAP エンベデッド デザイン チュートリアル</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-getting-started.html">入門</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-cips-noc-ip-config.html">Versal ACAP CIPS および NoC (DDR) IP コアの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-boot-and-config.html">ブートおよびコンフィギュレーション</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-debugging.html">Vitis ソフトウェア プラットフォームを使用したデバッグ</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-system-design-example.html">スカラー型エンジンと適応型エンジンを使用したシステム デザイン例</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-system-design-example-HSDP.html">SmartLynq+ モジュールを使用した高速デバッグ ポート (HSDP) のシステム デザイン例</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SSI デバイスのシステム デザイン例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#design-example-using-axi-gpio">デザイン例: AXI GPIO の使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#versal-acap-cips-ip-core-configuration">Versal ACAP CIPS IP コアの設定</a></li>
<li class="toctree-l4"><a class="reference internal" href="#noc-and-ddr-ip-core-configuration">NoC (および DDR) IP コアの設定</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-pl-axi-gpio-and-axi-uart">PL AXI GPIO および AXI UART の設定</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#example-project-freertos-axi-uartlite-application-project-with-rpu">サンプル プロジェクト: RPU を使用した FreeRTOS AXI UARTLite アプリケーション プロジェクト</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-project-creating-linux-images-using-petalinux">サンプル プロジェクト: PetaLinux を使用した Linux イメージの作成</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="A-creating-plm.html">付録: PLM の作成</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ZynqMPSoC-EDT/ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC エンベデッド デザイン チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 エンベデッド デザイン チュートリアル</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">機能チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">FSBL (First Stage Boot Loader)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/microblaze-system/README.html">エンベデッド MicroBlaze プロセッサのプログラム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/sw-profiling/sw-profiling.html">システム デバッガーを使用したアプリケーションのプロファイル</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">設計チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Design_Tutorials/MPSoC_Graphic_Subsystem/README.html">グラフィックスおよび DisplayPort ベースのサブシステムのセットアップ例</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">デバッグ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis エンベデッド ソフトウェア デバッグ ガイド (UG1515) 2021.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ユーザー ガイド</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/SPA-UG/SPA-UG.html">システム パフォーマンス解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone ベンチマーク</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">すべてのリリース</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2022.1/build/html/index.html">2022.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2020.2/build/html/index.html">2020.2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">エンベデッド デザイン チュートリアル</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Versal-EDT.html">Versal ACAP エンベデッド デザイン チュートリアル</a> &raquo;</li>
      <li>Versal スタックド シリコン インターコネクト デバイスのシステム デザイン例</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Introduction/Versal-EDT/docs/7-system-design-example-ssit-device.rst.txt" rel="nofollow"> このページのソースを表示</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="system-design-example-for-versal-stacked-silicon-interconnect-devices">
<h1>Versal スタックド シリコン インターコネクト デバイスのシステム デザイン例<a class="headerlink" href="#system-design-example-for-versal-stacked-silicon-interconnect-devices" title="Permalink to this heading">¶</a></h1>
<p>この章では、スタックド シリコン インターコネクト (SSI) デバイスに使用可能なツールとサポートされているソフトウェア ブロックを使用して、Versal® デバイスをベースにしたシステムを構築する方法を説明します。Versal プレミアム VP1802 SSI デバイス ベースの VPK180 ボード用に、Vivado® ツールを使用して PL AXI GPIO および PL AXI UART を利用したエンベデッド デザインを作成する方法について説明します。SSI デバイスを使用したデザインについては、設計手法ガイド (<a class="reference external" href="https://docs.xilinx.com/r/en-US/ug949-vivado-design-methodology/Designing-with-SSI-Devices">UG949</a>) を参照してください。また、ターゲットの Versal ACAP デバイス用の Arm® Cortex™-A72 コア ベースの Linux オペレーティング システムをコンフィギュレーションしてビルドする手順についても説明します。</p>
<section id="design-example-using-axi-gpio">
<span id="using-axi-gpio"></span><h2>デザイン例: AXI GPIO の使用<a class="headerlink" href="#design-example-using-axi-gpio" title="Permalink to this heading">¶</a></h2>
<p>このデザイン例では、PL ベースの AXI GPIO インターフェイスを使用して、Linux アプリケーション (<code class="docutils literal notranslate"><span class="pre">gpiotest</span></code>) でボード上の LED を制御します。VP1802 SSI テクノロジ デバイスで使用可能な 4 つの SLR (Super Logic Regions) を利用するため、LED0、LED1、LED2、および LED3 用の PL AXI GPIO インターフェイス パスは、それぞれ SLR-0、SLR-1、SLR-2、および SLR-3 を経由して配線されています。</p>
<p>RPU ベアメタル アプリケーションは、PL ベースの AXI UART Lite を使用して、PS UART コンソールを使用する代わりに AXI UART コンソールにデバッグ メッセージを出力します。</p>
<p>このデザイン例では、次のように設定する手順を説明します。</p>
<ul class="simple">
<li><p>SSI テクノロジ デバイス用 Versal® ACAP CIPS IP コアの設定。</p></li>
<li><p>SSI テクノロジ デバイスに必要な NoC (DDR) IP コアのコンフィギュレーションと関連する接続。</p></li>
<li><p>AXI GPIO および AXI UART PL IP と、PS および PL インターフェイスを介した CIPS への関連接続を設定します。</p></li>
</ul>
<section id="versal-acap-cips-ip-core-configuration">
<h3>Versal ACAP CIPS IP コアの設定<a class="headerlink" href="#versal-acap-cips-ip-core-configuration" title="Permalink to this heading">¶</a></h3>
<p>Versal® ACAP CIPS IP コアを使用すると、ブート モード、ペリフェラル、クロック、インターフェイス、割り込み、などのプロセッシング システムおよび PMC ブロックを設定できます。</p>
<section id="managing-the-versal-acap-cips-ip-core-in-the-vivado-design-suite">
<h4>Vivado Design Suite での Versal ACAP CIPS IP コアの管理<a class="headerlink" href="#managing-the-versal-acap-cips-ip-core-in-the-vivado-design-suite" title="Permalink to this heading">¶</a></h4>
<ol class="arabic">
<li><p>新しいプロジェクトとブロック デザインを作成するには、<a class="reference internal" href="2-cips-noc-ip-config.html"><span class="doc">「Versal ACAP CIPS および NoC (DDR) IP コアの設定」</span></a>の手順に従ってください。</p></li>
<li><p>まずは、<strong>[Add IP]</strong> ボタンをクリックして IP カタログから IP を追加します。</p></li>
<li><p>検索ボックスに「CIPS」と入力して、[Control, Interfaces and Processing System] を探します。</p></li>
<li><p><strong>[Control, Interface &amp; Processing System IP]</strong> をダブルクリックして、ブロック デザインに追加します。次の図に示すように、[Diagram] ウィンドウに CIPS IP コアが表示されます。</p>
<a class="reference internal image-reference" href="../../../../_images/image7.png"><img alt="../../../../_images/image7.png" src="../../../../_images/image7.png" style="width: 600px;" /></a>
</li>
<li><p><strong>[Run Block Automation]</strong> をクリックします。</p></li>
<li><p>ブロック設定を次の図に示すように設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/run-automation-1.png"><img alt="../../../../_images/run-automation-1.png" src="../../../../_images/run-automation-1.png" style="width: 600px;" /></a>
</li>
<li><p>[Diagram] ウィンドウで <strong>versal_cips_0</strong> をダブルクリックします。</p></li>
<li><p><strong>[Design Flow]</strong> および <strong>[Presets]</strong> のすべての設定が次の図のようになっていることを確認します。</p>
<a class="reference internal image-reference" href="../../../../_images/4_1-full-system.png"><img alt="../../../../_images/4_1-full-system.png" src="../../../../_images/4_1-full-system.png" style="width: 600px;" /></a>
</li>
<li><p><strong>[Next]</strong> をクリックしてから <strong>[PS PMC]</strong> をクリックします。</p>
<a class="reference internal image-reference" href="../../../../_images/ps-pmc.png"><img alt="../../../../_images/ps-pmc.png" src="../../../../_images/ps-pmc.png" style="width: 600px;" /></a>
</li>
<li><p>次の図に示すように、TTC ペリフェラルをイネーブルにします。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_peripherals.png"><img alt="../../../../_images/vpk_peripherals.png" src="../../../../_images/vpk_peripherals.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p><strong>IO</strong> コンフィギュレーション設定が次のようになっていることを確認してください。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_io.png"><img alt="../../../../_images/vpk_io.png" src="../../../../_images/vpk_io.png" style="width: 600px;" /></a>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>VPK180 プリセット値は、QSPI と SD をデフォルトのブート モードとして設定します。変更は必要ありません。</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p><strong>[Interrupts]</strong> をクリックし、次の図のように設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/interrupts.png"><img alt="../../../../_images/interrupts.png" src="../../../../_images/interrupts.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p><strong>[Finish]</strong> をクリックして CIPS の GUI を閉じます。<strong></strong></p></li>
</ol>
</section>
</section>
<section id="noc-and-ddr-ip-core-configuration">
<h3>NoC (および DDR) IP コアの設定<a class="headerlink" href="#noc-and-ddr-ip-core-configuration" title="Permalink to this heading">¶</a></h3>
<p>このセクションでは、前のセクションの前半で設定した CIPS と一緒に使用のに必要な NoC (および DDR) 設定と関連する接続について説明します。NoC IP コアを使用すると、NoC を設定し、DDR メモリ コントローラーをイネーブルにできます。</p>
<section id="configuring-noc-and-cips">
<h4>NoC および CIPS の設定<a class="headerlink" href="#configuring-noc-and-cips" title="Permalink to this heading">¶</a></h4>
<ol class="arabic">
<li><p><strong>[CIPS] → [PS-PMC]</strong> を開きます。</p></li>
<li><p><strong>[NoC]</strong> をクリックし、次の図のようにマスター SLR (SLR-0) の NoC コヒーレント、非コヒーレント インタフェースおよび NoC to PMC インターフェイスをイネーブルにします。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr0.png"><img alt="../../../../_images/vpk_noc-interface-slr0.png" src="../../../../_images/vpk_noc-interface-slr0.png" style="width: 600px;" /></a>
</li>
<li><p>スレーブ SLR (SLR-1、SLR-2、SLR-3) に対して、次の図のように PMC to NoC および NoC to PMC の接続をイネーブルにします。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr-1.png"><img alt="../../../../_images/vpk_noc-interface-slr-1.png" src="../../../../_images/vpk_noc-interface-slr-1.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr-2.png"><img alt="../../../../_images/vpk_noc-interface-slr-2.png" src="../../../../_images/vpk_noc-interface-slr-2.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr-3.png"><img alt="../../../../_images/vpk_noc-interface-slr-3.png" src="../../../../_images/vpk_noc-interface-slr-3.png" style="width: 600px;" /></a>
</li>
<li><p><strong>[Finish]</strong> をクリックして CIPS の GUI を閉じます。<strong></strong></p></li>
<li><p><strong>[AXI NoC IP]</strong> を 2 つ IP カタログから追加します。</p></li>
<li><p><strong>axi_noc-0</strong> をダブルクリックします。[Board] タブで、次のように LPDDR トリプレットおよび関連するクロックをイネーブルにします。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc_board.png"><img alt="../../../../_images/vpk_noc_board.png" src="../../../../_images/vpk_noc_board.png" style="width: 600px;" /></a>
</li>
<li><p>[General] タブをクリックし、次のように <strong>[Number of AXI Slave interfaces]</strong>、<strong>[AXI Clocks]</strong> を 8 に、<strong>[Number of Inter-NoC Master Interfaces]</strong> を 5 に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-settings.png"><img alt="../../../../_images/vpk_noc-settings.png" src="../../../../_images/vpk_noc-settings.png" style="width: 600px;" /></a>
</li>
<li><p>[Inputs] タブで、8 つの <strong>AXI スレーブ インターフェイス</strong>を次のように設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/noc-axi.png"><img alt="../../../../_images/noc-axi.png" src="../../../../_images/noc-axi.png" style="width: 600px;" /></a>
</li>
<li><p>[Connectivity] タブを次のように設定します。</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-connectivity.png"><img alt="../../../../_images/vpk_noc-connectivity.png" src="../../../../_images/vpk_noc-connectivity.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p><strong>[OK]</strong> をクリックします。</p></li>
<li><p><strong>axi_noc-1</strong> をダブルクリックします。[General] タブで、次のように <strong>[Number of AXI Slave interfaces]</strong> を 3 に、<strong>[Number of AXI Master interfaces] </strong> を 4 に、<strong>[AXI Clocks]</strong> を 7 に、<strong>[Number of Inter-NoC Slave Interfaces]</strong> を 5 に設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc_board1.png"><img alt="../../../../_images/vpk_noc_board1.png" src="../../../../_images/vpk_noc_board1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>[Inputs] タブで PS PMC への 3 つの <strong>AXI スレーブ インターフェイス</strong>を次のように設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-axi1.png"><img alt="../../../../_images/vpk_noc-axi1.png" src="../../../../_images/vpk_noc-axi1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>[Outputs] タブで PS PMC への 4 つの <strong>AXI マスター インターフェイス</strong>を次のように設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-axi2.png"><img alt="../../../../_images/vpk_noc-axi2.png" src="../../../../_images/vpk_noc-axi2.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>[Connectivity] タブを次のように設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-connectivity1.png"><img alt="../../../../_images/vpk_noc-connectivity1.png" src="../../../../_images/vpk_noc-connectivity1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p><strong>[OK]</strong> をクリックします。</p></li>
<li><p>次に示すように、[CIPS] と [NOC] との間を接続します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-ip.png"><img alt="../../../../_images/vpk_noc-ip.png" src="../../../../_images/vpk_noc-ip.png" style="width: 600px;" /></a>
</div></blockquote>
</section>
</section>
<section id="configuring-pl-axi-gpio-and-axi-uart">
<h3>PL AXI GPIO および AXI UART の設定<a class="headerlink" href="#configuring-pl-axi-gpio-and-axi-uart" title="Permalink to this heading">¶</a></h3>
<p>このセクションでは、AXI GPIO および AXI UART を備えた完全なシステムを構築するための PS および PL 設定と関連する接続について説明します。これには、Vivado IP カタログから必要な IP を追加し、PS サブシステムのブロックにコンポーネントを接続します。ハードウェアを設定する方法は、次のとおりです。</p>
<section id="configuring-cips-ps-pl-interface">
<h4>CIPS PS-PL インターフェイスの設定<a class="headerlink" href="#configuring-cips-ps-pl-interface" title="Permalink to this heading">¶</a></h4>
<p>PL IP に CIPS を接続するには、次の手順に従います。</p>
<ol class="arabic">
<li><p>Versal ACAP CIPS IP コアをダブルクリックします。</p></li>
<li><p><strong>[PS-PMC] → [PS-PL Interfaces]</strong> をクリックします。</p></li>
<li><p>M_AXI_FPD インターフェイスをイネーブルにし、<strong>[Number of PL Resets]</strong> を 1 に設定します (図を参照)。</p>
<img alt="../../../../_images/PS_PL_Interfaces.png" src="../../../../_images/PS_PL_Interfaces.png" />
</li>
<li><p><strong>[Clocking]</strong> をクリックし、[Output Clocks] タブをクリックします。</p></li>
<li><p>[PMC Domain Clocks] を展開します。次に、[PL Fabric Clocks] を展開します。次の図のように、PL0_REF_CLK (PL CLK 0) を 300 MHz に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/clocking_ps_PMC.png"><img alt="../../../../_images/clocking_ps_PMC.png" src="../../../../_images/clocking_ps_PMC.png" style="width: 600px;" /></a>
</li>
<li><p><strong>[Finish]</strong> をクリックしてから、<strong>[OK]</strong> をクリックし、設定を完了し、ブロック図に戻ります。</p></li>
</ol>
</section>
<section id="configuring-pl-hardware">
<h4>PL ハードウェアの設定<a class="headerlink" href="#configuring-pl-hardware" title="Permalink to this heading">¶</a></h4>
<p>このデザイン例で使用されている PL IP を設定する手順は、次のとおりです。</p>
<ol class="arabic">
<li><p>ブロック図を右クリックし、<strong>[Add IP]</strong> をクリックして IP カタログから IP を追加します。</p></li>
<li><p>AXI GPIO を検索し、<strong>[AXI GPIO IP]</strong> をダブルクリックして、4 つの IP インスタンスをデザインに追加します。</p></li>
<li><p>IP カタログで <strong>AXI Uartlite</strong> を検索し、デザインに追加します。</p></li>
<li><p>[Block Design] ビューで <strong>[Run Connection Automation]</strong> をクリックします。</p>
<a class="reference internal image-reference" href="../../../../_images/image62.png"><img alt="../../../../_images/image62.png" src="../../../../_images/image62.png" style="width: 600px;" /></a>
<p>[Run Connection Automation] ダイアログ ボックスが開きます。</p>
</li>
<li><p>[Run Connection Automation] ダイアログ ボックスで、[All Automation] をオンにします。</p>
<img alt="../../../../_images/vpk_image63.png" src="../../../../_images/vpk_image63.png" />
<p>これにより、AXI GPIO IP のすべてのポートの自動化がチェックされます。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> の <strong>GPIO</strong> をクリックし、次に示すように [Select Board Part Interface] を <strong>[Custom]</strong> に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_image64.png"><img alt="../../../../_images/vpk_image64.png" src="../../../../_images/vpk_image64.png" style="width: 600px;" /></a>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> の <strong>S_AXI</strong> をクリックします。次の図に示すように設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_gpio_config0.png"><img alt="../../../../_images/vpk_gpio_config0.png" src="../../../../_images/vpk_gpio_config0.png" style="width: 600px;" /></a>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_1</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_gpio_2</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_gpio_3</span></code> に対しても手順 6 と 7 を繰り返します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_uartlite_0</span></code> の <strong>S_AXI</strong> をクリックします。次の図に示すように設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_s-axi-uartlite1.png"><img alt="../../../../_images/vpk_s-axi-uartlite1.png" src="../../../../_images/vpk_s-axi-uartlite1.png" style="width: 600px;" /></a>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_uartlite_0</span></code> の <strong>[UART]</strong> をクリックします。次の図に示すように設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_s-axi-uartlite.png"><img alt="../../../../_images/vpk_s-axi-uartlite.png" src="../../../../_images/vpk_s-axi-uartlite.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p><strong>[OK]</strong> をクリックします。</p></li>
<li><p>これにより、次の接続が設定されます。</p>
<ul class="simple">
<li><p>SmartConnect を CIPS と AXI GPIO IP 間のブリッジ IP として使用し、<code class="docutils literal notranslate"><span class="pre">S_AXI</span> <span class="pre">of</span> <span class="pre">AXI_GPIO</span></code> と UART Lite を CIPS の <code class="docutils literal notranslate"><span class="pre">M_AXI_FPD</span></code> に接続します。</p></li>
<li><p>プロセッサ システム リセット IP をイネーブルにします。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> をプロセッサ システム リセット、AXI GPIO、および SmartConnect IP クロックに接続します。</p></li>
<li><p>SmartConnect および AXI GPIO のリセットをプロセッサ システム リセット IP の <code class="docutils literal notranslate"><span class="pre">peripheral_aresetn</span></code> に接続します。</p></li>
</ul>
</li>
<li><p>[Block Design] ビューで <strong>[Run Connection Automation]</strong> をクリックし、[All Automation] チェック ボックスをオンにします。</p></li>
<li><p><strong>ext_reset_in</strong> をクリックして、次のように設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/image66.jpeg"><img alt="../../../../_images/image66.jpeg" src="../../../../_images/image66.jpeg" style="width: 600px;" /></a>
</div></blockquote>
<p>これにより、プロセッサ システム リセット IP の <cite>ext_reset_in</cite> が CIPS の <code class="docutils literal notranslate"><span class="pre">pl_resetn</span></code> に接続されます。</p>
<ol class="arabic simple" start="15">
<li><p><strong>[OK]</strong> をクリックします。</p></li>
<li><p>プロセッサ システム リセット IP の <code class="docutils literal notranslate"><span class="pre">peripheral_aresetn</span></code> から SmartConnect IP の <cite>aresetn</cite> への接続を解除します。</p></li>
<li><p>SmartConnect IP の <cite>aresetn</cite> をプロセッサ システム リセット IP の <code class="docutils literal notranslate"><span class="pre">interconnect_aresetn</span></code> に接続します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/image67.jpeg"><img alt="../../../../_images/image67.jpeg" src="../../../../_images/image67.jpeg" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p><strong>axi_gpio_0</strong> IP をダブルクリックして開きます。</p></li>
<li><p>次の図のように [IP Configuration] タブを設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_image68.png"><img alt="../../../../_images/vpk_image68.png" src="../../../../_images/vpk_image68.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_1</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_gpio_2</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_gpio_3</span></code> も同じ設定にします。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> IP の外部ピンを削除し、インターフェイスを展開します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> IP の出力を外部接続 (Make External) にします。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> IP の外部ポートを右クリックし、[External Port Properties] を選択し、Dout_0 に名前を変更します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_gpio_port.png"><img alt="../../../../_images/vpk_gpio_port.png" src="../../../../_images/vpk_gpio_port.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p><code class="docutils literal notranslate"><span class="pre">axi_gpio_1</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_gpio_2</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_gpio_3</span></code> に対して手順 21 ～ 23 を繰り返し、それぞれ Dout_1、Dout_2、Dout_3 に名前を変更します。</p></li>
<li><p>SLR-1、SLR-2、SLR-3 に配置する <strong>AXI Register Slice</strong> IP のインスタンスを 3 つ追加します。</p></li>
<li><p>Register Slice IP を右クリックし、<strong>[Block Properties]</strong> を選択して、次のように axi_register_slice_1_s2 という名前に変更します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_register_light_2.png"><img alt="../../../../_images/vpk_register_light_2.png" src="../../../../_images/vpk_register_light_2.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>AXI Register Slice IP をダブルクリックし、<strong>[Register Slice Option]</strong> を次のように [Light] に設定します。</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_register_light_1.png"><img alt="../../../../_images/vpk_register_light_1.png" src="../../../../_images/vpk_register_light_1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="28">
<li><p>AXI Register Slice IP の 2 番目と 3 番目のインスタンスに対して手順 26 と 27 を繰り返し、それぞれ <code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s2</span></code> と <code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s2</span></code> に名前を変更します。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p><code class="docutils literal notranslate"><span class="pre">axi_register_slice_1_s2</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s2</span></code>、<code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s2</span></code> が、<a href="#id1"><span class="problematic" id="id2">``</span></a>pl_gpio_uart/constrs` フォルダーにパッケージの一部として提供される制約ファイルを使用して、SLR-1、SLR-2、SLR-3 にそれぞれ配置されます。</p>
</div>
<p><strong>SLR-0 から SLR-1 への SLR クロッシング</strong></p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>SLR クロッシング レジスタが追加され、タイミングクロージャが改善され、長いリソースの配線密集が緩和されています。</p>
</div>
<ol class="arabic" start="29">
<li><p><strong>AXI Register Slice</strong> IP を 2 つ追加して、SLR-0 から SLR-1 への SLR クロッシングを処理します。</p></li>
<li><p>Register Slice IP を右クリックし、<strong>[Block Properties]</strong> を選択し、<code class="docutils literal notranslate"><span class="pre">axi_register_slice_1_s1</span></code> に名前を変更します。</p></li>
<li><p>Register Slice IP をダブルクリックし、[Register Slice Option] を <strong>[SLR Crossing]</strong> に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_slr_crossing_1.png"><img alt="../../../../_images/vpk_slr_crossing_1.png" src="../../../../_images/vpk_slr_crossing_1.png" style="width: 600px;" /></a>
</li>
<li><p>AXI Register Slice IP の 2 番目のインスタンスに対して、手順 30 と 31 を繰り返し、名前を <code class="docutils literal notranslate"><span class="pre">axi_register_slice_1_s3</span></code> に変更します。</p></li>
</ol>
<p><strong>SLR-0 から SLR-2 への SLR クロッシング</strong></p>
<ol class="arabic" start="33">
<li><p>同様に、<strong>AXI Register Slice</strong> IP のインスタンスを 2 つ追加して、SLR-0 から SLR-2 へのマルチ SLR クロッシングを処理します。</p></li>
<li><p>Register Slice IP を右クリックし、<strong>[Block Properties]</strong> を選択し、<code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s1</span></code> に名前を変更します。</p></li>
<li><p>Register Slice IP をダブルクリックし、[Register Slice Option] を <strong>[Multi SLR Crossing]</strong> に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_2_1.png"><img alt="../../../../_images/vpk_multi_slr_crossing_2_1.png" src="../../../../_images/vpk_multi_slr_crossing_2_1.png" style="width: 600px;" /></a>
</li>
<li><p>[SLR Crossing] タブを開き、次のように [Number of SLR Crossing] を 2 に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_2_2.png"><img alt="../../../../_images/vpk_multi_slr_crossing_2_2.png" src="../../../../_images/vpk_multi_slr_crossing_2_2.png" style="width: 600px;" /></a>
</li>
<li><p>AXI Register Slice IP の 2 番目のインスタンスに対して、手順 34 ～ 36 を繰り返し、名前を <code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s3</span></code> に変更します。</p></li>
</ol>
<p><strong>SLR-0 から SLR-3 への SLR クロッシング</strong></p>
<ol class="arabic" start="38">
<li><p>同様に、SLR-0 から SLR-3 への SLR クロッシングを処理するために <strong>AXI Register Slice</strong> IP を 2 つ追加します。</p></li>
<li><p>Register Slice IP を右クリックし、<strong>[Block Properties]</strong> を選択し、<code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s1</span></code> に名前を変更します。</p></li>
<li><p>Register Slice IP をダブルクリックし、[Register Slice Option] を <strong>[Multi SLR Crossing]</strong> に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_3.png"><img alt="../../../../_images/vpk_multi_slr_crossing_3.png" src="../../../../_images/vpk_multi_slr_crossing_3.png" style="width: 600px;" /></a>
</li>
<li><p>[SLR Crossing] タブを開き、次のように [Number of SLR Crossing] を 3 に設定します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_4.png"><img alt="../../../../_images/vpk_multi_slr_crossing_4.png" src="../../../../_images/vpk_multi_slr_crossing_4.png" style="width: 600px;" /></a>
</li>
<li><p>AXI Register Slice IP の 2 番目のインスタンスに対して、手順 39 ～ 41 を繰り返し、名前を <code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s3</span></code> に変更します。</p></li>
<li><p>AXI SmartConnect から <cite>axi_gpio_0</cite>、<cite>axi_gpio_1</cite>、<cite>axi_gpio_2</cite>、<cite>axi_gpio_3</cite> の接続を解除し、次の図のようにレジスタ スライスを接続します。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_register_slice_con.PNG"><img alt="../../../../_images/vpk_register_slice_con.PNG" src="../../../../_images/vpk_register_slice_con.PNG" style="width: 600px;" /></a>
</li>
<li><p>[Block Design] ビューで <strong>[Run Connection Automation]</strong> をクリックします。すべてのレジスタ スライスの <code class="docutils literal notranslate"><span class="pre">aclk</span></code> を選択し、<strong>[OK]</strong> をクリックします。</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_register_slice_con_clk.png"><img alt="../../../../_images/vpk_register_slice_con_clk.png" src="../../../../_images/vpk_register_slice_con_clk.png" style="width: 600px;" /></a>
</li>
<li><p><strong>axi_uartlite_0</strong> をダブルクリックして、IP を開きます。次の図のように [IP Configuration] タブを設定します。</p>
<img alt="../../../../_images/vpk_configure-ip-settings.png" src="../../../../_images/vpk_configure-ip-settings.png" />
</li>
<li><p><strong>Clock Wizard IP</strong> を追加します。これをダブルクリックして、IP を開きます。</p></li>
<li><p>[Clocking Features] タブに移動し、次のように設定します。</p>
<img alt="../../../../_images/clocking-features.png" src="../../../../_images/clocking-features.png" />
</li>
<li><p><strong>[Input Clock Information]</strong> の [Source] オプションが <strong>[Global buffer]</strong> に設定されていることを確認します。</p></li>
<li><p>[Output Clocks] タブに移動し、出力クロックを <strong>250 MHz</strong> に設定します。</p>
<img alt="../../../../_images/vpk_output-clocks-tab.png" src="../../../../_images/vpk_output-clocks-tab.png" />
</li>
<li><p>CIPS の <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> を右クリックし、<strong>[Disconnect Pin]</strong> をクリックします。</p></li>
<li><p>CIPS からの <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> をクロッキング ウィザードの入力 <code class="docutils literal notranslate"><span class="pre">clk_in1</span></code> に接続します。</p></li>
<li><p>クロッキング ウィザードの出力を Processor System Reset IP の <code class="docutils literal notranslate"><span class="pre">slowest_sync_clock</span></code> に接続します。</p>
<p>これはタイミング エラーを避けるのに役立ちます。</p>
</li>
</ol>
<p>ブロック デザイン全体が次のようになります。</p>
<img alt="../../../../_images/vpk_image73.png" src="../../../../_images/vpk_image73.png" />
</section>
<section id="validating-the-design-and-generating-the-output">
<h4>デザインの検証および出力の生成<a class="headerlink" href="#validating-the-design-and-generating-the-output" title="Permalink to this heading">¶</a></h4>
<p>デザインを検証し、出力ファイルを生成するには、次の手順を実行します。</p>
<ol class="arabic">
<li><p>[Block Design] ビューに戻り、ブロック デザインを保存します (<strong>Ctrl + S</strong> キーを押す)。</p></li>
<li><p>[Diagram] ウィンドウの空白部分を右クリックして、<strong>[Validate Design]</strong> をクリックします。または、F6 キーを押します。次の図のようなメッセージが表示されます。</p>
<p>Vivado ツールから、デザイン内の IP をアドレスにマッピングするように指示するプロンプトが表示されます。<strong>[Yes]</strong> をクリックします。</p>
<img alt="../../../../_images/vpk_assign-address.png" src="../../../../_images/vpk_assign-address.png" />
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>アドレス セグメントの数は、デザイン内のメモリ マップド IP の数によって異なる場合があります。</p>
</div>
<p>検証が完了すると、次のようなメッセージ ダイアログ ボックスが開きます。</p>
<img alt="../../../../_images/validation_message.PNG" src="../../../../_images/validation_message.PNG" />
</li>
<li><p><strong>[OK]</strong> をクリックしてメッセージを閉じます。</p></li>
<li><p><strong>[Sources]</strong> ウィンドウをクリックします。</p>
<ol class="arabic">
<li><p>制約を展開します。</p></li>
<li><p><strong>[constrs_1]</strong> を右クリックし、[Add Sources] をクリックします。</p>
<p>[Add Sources] ウィンドウが表示されます。</p>
</li>
<li><p><strong>[Add or Create Constraints]</strong> オプションを選択し、<strong>[Next]</strong> をクリックします。</p></li>
<li><p>追加する XDC ファイルを選択します。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>制約ファイルは <code class="docutils literal notranslate"><span class="pre">pl_gpio_uart/constrs</span></code> フォルダーにパッケージの一部として含まれます。</p>
</div>
</li>
<li><p><strong>[Finish]</strong> をクリックします。</p></li>
</ol>
</li>
<li><p><strong>[Hierarchy]</strong> タブをクリックします。</p></li>
<li><p>[Sources] ウィンドウの [Design Sources] の下の <strong>[edt_versal_wrapper]</strong> を展開します。</p></li>
<li><p>edt_versal_i : edt_versal (<code class="docutils literal notranslate"><span class="pre">edt_versal.bd</span></code>) という最上位ブロックを右クリックし、<strong>[Generate Output Products]</strong> をクリックします。</p>
<img alt="../../../../_images/GOP.png" src="../../../../_images/GOP.png" />
</li>
<li><p><strong>[Generate]</strong> をクリックします。</p></li>
<li><p>[Generate Output Products] の処理が完了したら、<strong>[OK]</strong> をクリックします。</p></li>
<li><p>[Sources] ウィンドウで <strong>[IP Sources]</strong> ビューをクリックします。次の図に示すように、生成した出力ファイルが表示されます。</p>
<img alt="../../../../_images/vpk_180_ip-sources-ch5-final.png" src="../../../../_images/vpk_180_ip-sources-ch5-final.png" />
</li>
</ol>
</section>
<section id="synthesizing-implementing-and-generating-the-device-image">
<h4>デバイス イメージの合成、インプリメント、生成<a class="headerlink" href="#synthesizing-implementing-and-generating-the-device-image" title="Permalink to this heading">¶</a></h4>
<p>デザインのデバイス イメージを生成するには、次の手順を実行します。</p>
<ol class="arabic">
<li><p>Flow Navigator の <strong>[Program and Debug]</strong> をクリックし、<strong>[Generate Device Image]</strong> をクリックし、<strong>[OK]</strong> をクリックします。</p></li>
<li><p>[No Implementation Results Available] メニューが表示されます。<strong>[Yes]</strong> をクリックします。</p></li>
<li><p>[Launch Run] メニューが表示されます。<strong>[OK]</strong> をクリックします。</p>
<p>デバイス イメージの生成が完了すると、[Device Image Generation Completed] ダイアログ ボックスが開きます。</p>
</li>
<li><p><strong>[Cancel]</strong> をクリックしてウィンドウを閉じます。</p></li>
<li><p>デバイス イメージを生成したら、ハードウェアをエクスポートします。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>次の手順はオプションなので、省略して<a class="reference internal" href="#exporting-hardware-7"><span class="std std-ref">「ハードウェアのエクスポート」</span></a> セクションに進むこともできます。これらの手順を実行すると、デバイス イメージを生成する前に合成およびインプリメンテーションを実行するので、デバイス イメージ生成の詳細なフローがわかるようになります。デバイス イメージの生成フローを理解する必要がある場合は、次の手順を実行します。</p>
<ol class="arabic">
<li><p>Flow Navigator で <strong>[Synthesis]</strong> をクリックし、<strong>[Run Synthesis]</strong> をクリックします。</p>
<img alt="../../../../_images/image17.png" src="../../../../_images/image17.png" />
</li>
<li><p>合成の開始前にプロジェクトを保存するようメッセージが表示された場合は、<strong>[Save]</strong> をクリックします。</p>
<p>合成の実行中、ウィンドウの右上にステータス バーが表示されます。このステータス バーは、デザイン プロセスをとおして、さまざまな理由により表示されます。ステータス バーは、プロセスがバックグランドで実行されていることを示します。合成が完了すると、[Synthesis Completed] ダイアログ ボックスが開きます。</p>
</li>
<li><p><strong>[Run Implementation]</strong> をクリックして <strong>[OK]</strong> をクリックします。</p>
<p>インプリメンテーションが完了すると、[Implementation Completed] ダイアログ ボックスが開きます。</p>
</li>
<li><p><strong>[Generate Device Image]</strong> をクリックして <strong>[OK]</strong> をクリックします。</p>
<p>デバイス イメージの生成が完了すると、[Device Image Generation Completed] ダイアログ ボックスが開きます。</p>
</li>
<li><p><strong>[Cancel]</strong> をクリックしてウィンドウを閉じます。</p>
<p>デバイス イメージを生成したら、ハードウェアをエクスポートします。</p>
</li>
</ol>
</div>
</section>
<section id="exporting-hardware">
<span id="exporting-hardware-7"></span><h4>ハードウェアのエクスポート<a class="headerlink" href="#exporting-hardware" title="Permalink to this heading">¶</a></h4>
<ol class="arabic">
<li><p>Vivado のメイン メニューから <strong>[File] → [Export] → [Export Hardware]</strong> をクリックします。[Export Hardware] ダイアログ ボックスが開きます。</p></li>
<li><p><strong>[Include bitstream]</strong> を選択し、<strong>[Next]</strong> をクリックします。</p></li>
<li><p>エクスポートしたファイルの名前を入力し (またはデフォルトを使用し)、ディレクトリを選択します。<strong>[Next]</strong> をクリックします。</p>
<p>ハードウェア モジュールが既にエクスポートされている場合は、警告メッセージが表示されます。上書きメッセージが表示された場合、このデザインに別の名前を選択するか、または <strong>[Yes]</strong> をクリックして既存の XSA ファイルを上書きします。</p>
</li>
<li><p><strong>[Finish]</strong> をクリックします。</p></li>
</ol>
</section>
</section>
</section>
<section id="example-project-freertos-axi-uartlite-application-project-with-rpu">
<h2>サンプル プロジェクト: RPU を使用した FreeRTOS AXI UARTLiteアプリケーション プロジェクト<a class="headerlink" href="#example-project-freertos-axi-uartlite-application-project-with-rpu" title="Permalink to this heading">¶</a></h2>
<p>このセクションでは、Versal デバイス上で Arm Cortex-R5F コア ベースの RPU 用の FreeRTOS アプリケーションをコンフィギュレーションしてビルドする手順について説明します。</p>
<p>次の手順は、Arm Cortex-R5F から FreeRTOS アプリケーションを作成する手順を示しています:</p>
<ol class="arabic">
<li><p>Vitis™ IDE を起動し、<code class="docutils literal notranslate"><span class="pre">c:/edt/freertos</span></code> などの新しいワークスペースを作成します。</p></li>
<li><p><strong>[File] → [New] → [Application Project]</strong> をクリックします。<strong>[Create a New Application Project]</strong> ページが開きます。Vitis IDE を初めて起動した場合は、次の図に示す Welcome 画面で <strong>[Create Application Project]</strong> を選択できます。</p>
<img alt="../../../../_images/image75.jpeg" src="../../../../_images/image75.jpeg" />
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>オプションで、<strong>[Skip welcome page next time]</strong> チェック ボックスをオンにすると、毎回 Welcome ページが表示されないようにすることもできます。</p>
</div>
</li>
<li><p>Vitis IDE には、ターゲット プラットフォーム、システム プロジェクト、ドメイン、テンプレートの 4 つのコンポーネントがあります。Vitis IDE で新しいアプリケーション プラットフォーム作成するには、次の手順に従います。</p>
<ol class="arabic">
<li><p>ターゲット プラットフォームには、ベース ハードウェア デザインと、宣言されたインターフェイスにアクセラレータを接続するのに使用されたメタデータが含まれます。プラットフォームを選択するか、Vivado Design Suite からエクスポートした XSA からプラットフォーム プロジェクトを作成します。</p></li>
<li><p>アプリケーション プロジェクトをシステム プロジェクトに配置し、プロセッサに関連付けます。</p></li>
<li><p>ドメインでは、ターゲット プラットフォームでホスト プログラムを実行するのに使用されるプロセッサおよびオペレーティング システムを定義します。</p></li>
<li><p>アプリケーションのテンプレートを選択して、開発を迅速に開始します。ウィザードの各ページで次の表の情報に基づいて設定を選択します。</p>
<p><em></em><strong>表: ウィザード情報</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ウィザード画面</p></th>
<th class="head"><p>システム プロパティ</p></th>
<th class="head"><p>設定または使用するコマンド</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>プラットフォーム</p></td>
<td><p>Create a new platform
from hardware (XSA)</p></td>
<td><p>[Browse] をクリックして XSA ファイルを追加</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>プラットフォーム名</p></td>
<td><p>vpk180_platform</p></td>
</tr>
<tr class="row-even"><td><p>Application
Project
Detail</p></td>
<td><p>Application project
name</p></td>
<td><p>freertos_gpio_test</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Select a system project</p></td>
<td><p>+Create New</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>System project name</p></td>
<td><p>freertos_gpio_test_system</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>プロセッサ</p></td>
<td><p>versal_cips
_0_pspmc_0_psv_cortexr5_0</p></td>
</tr>
<tr class="row-even"><td><p>Dom</p></td>
<td><p>Select a domain</p></td>
<td><p>+Create New</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>名前</p></td>
<td><p>デフォルト名入力済み</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Display Name</p></td>
<td><p>デフォルト名入力済み</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>オペレーティング システム</p></td>
<td><p>freertos10_xilinx</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>プロセッサ</p></td>
<td><p>versal_cips
_0_pspmc_0_psv_cortexr5_0</p></td>
</tr>
<tr class="row-odd"><td><p>Templates</p></td>
<td><p>Available</p></td>
<td><p>Empty</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Templates</p></td>
<td><p>Application (C)</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Vitis ソフトウェア プラットフォームは、上記の手順を実行した後、Explorer ビューの下に、プラットフォーム プロジェクト (<strong>vpk180_platform</strong>) と <strong>freertos_gpio_test</strong> というアプリケーション プロジェクトを含むシステム プロジェクト (<strong>freertos_gpio_test_system</strong>) のボード サポート パッケージを作成します。</p>
</li>
<li><p><cite>src/</cite> ディレクトリの下のソース ファイルを削除し、freertos ソース コード ファイルを FreeRTOS プロジェクト パス <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/ch5_system_design_example_source__files/rpu/</span></code> から <code class="docutils literal notranslate"><span class="pre">src/</span></code> ディレクトリへコピーします。</p></li>
<li><p>Vitis IDE を設定して、FreeRTOS ボード サポート パッケージの下にある RPU アプリケーション デバッグ コンソールの AXI UARTLITE をイネーブルにします。</p>
<p>vpk180_platform プロジェクトの <cite>platform.spr</cite> に移動し、次にボード サポート パッケージの下の <strong>[Modify BSP]</strong> を選択し、図に示すように &lt;Y&gt; キーを押して stdin と stdout を <strong>axi_uarlite_0</strong> に変更します。</p>
<img alt="../../../../_images/vitis_uartlite_enable.JPG" src="../../../../_images/vitis_uartlite_enable.JPG" />
</li>
<li><p><strong>[OK]</strong> をクリックして上記の設定を保存し、コンフィギュレーション ウィザードを終了します。</p></li>
<li><p><strong>freertos_gpio_test_system</strong> を右クリックし、<strong>[Build Project]</strong> をクリックします。または、<img alt="build" src="../../../../_images/image291.png" /> をクリックします。</p>
<p>Linux イメージをビルドし、FreeRTOS ELF をイメージに組み込む方法については、<a class="reference internal" href="#creating-linux-images-using-petalinux"><span class="std std-ref">「サンプル プロジェクト: PetaLinux を使用した Linux イメージの作成」</span></a>を参照してください。</p>
</li>
<li><p>PL AXI UART シリアル コンソールでは、RPU デバッグ ログは次のように出力されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Gpio</span> <span class="n">Initialization</span> <span class="n">started</span>
<span class="n">Counter</span> <span class="mi">0</span>
<span class="n">Counter</span> <span class="mi">1</span>
<span class="n">Counter</span> <span class="mi">2</span>
<span class="n">Counter</span> <span class="mi">3</span>
<span class="n">Counter</span> <span class="mi">4</span>
<span class="n">Counter</span> <span class="mi">5</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="example-project-creating-linux-images-using-petalinux">
<span id="creating-linux-images-using-petalinux"></span><h2>サンプル プロジェクト: PetaLinux を使用した Linux イメージの作成<a class="headerlink" href="#example-project-creating-linux-images-using-petalinux" title="Permalink to this heading">¶</a></h2>
<p>このセクションでは、Versal デバイス上で Arm Cortex-A72 コア ベースの APU 用の Linux オペレーティング システムをコンフィギュレーションしてビルドする手順について説明します。PetaLinux ツールをボード固有の BSP と使用すると、Linux イメージをコンフィギュレーションおよびビルドできます。</p>
<p>このサンプル プロジェクトには、Linux ホスト マシンが必要です。PetaLinux ツールの依存関係とインストール手順については、『PetaLinux ツールの資料: リファレンス ガイド <a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/rdoc?v=latest;d=ug1144-petalinux-tools-reference-guide.pdf">UG1144</a> を参照してください。</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>この例では、VPK180 PetaLinux BSP を使用して PetaLinux プロジェクトを作成します。PetaLinux (VPK180) に該当する BSP がダウンロードされていることを確認します。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ボード</p></th>
<th class="head"><p>QSPI/SD</p></th>
<th class="head"><p>OSPI</p></th>
<th class="head"><p>eMMC</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VPK180 量産ボード</p></td>
<td><p><a class="reference external" href="https://www.xilinx.com/member/forms/download/xef.html?filename=xilinx-vpk120-v2022.2-10141622.bsp">xilinx-vpk180-v2022.2-11160035.bsp</a></p></td>
<td><p>該当なし</p></td>
<td><p>該当なし</p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic">
<li><p>各ボードの PetaLinux BSP を現在のディレクトリにコピーします。</p></li>
<li><p>PetaLinux 環境を設定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ source &lt;petalinux-tools-path&gt;/settings.csh
</pre></div>
</div>
</li>
<li><p>次のコマンドを使用して PetaLinux プロジェクトを作成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ petalinux-create -t project -s xilinx-vpk180-vxxyy.z-final.bsp -n led_example
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注記</p>
<ul class="simple">
<li><p>VPK180 ボードの場合、コマンドの <cite>-s</cite> オプションの後に <cite>xilinx-vpk180-vxxyy.z-final.bsp</cite> を使用します。</p></li>
</ul>
</div>
</li>
<li><p>次のコマンドを使用して、PetaLinux プロジェクト ディレクトリに移動します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd led_example
</pre></div>
</div>
</li>
<li><p>ハードウェア プラットフォーム プロジェクトの XSA を Linux ホスト マシンにコピーします。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>VPK180 ボードの場合は、<a class="reference internal" href="#using-axi-gpio"><span class="std std-ref">「デザイン例: AXI GPIO の使用」</span></a>で生成した XSA ファイルを使用します。</p>
</div>
</li>
<li><p>次のコマンドを実行して BSP を再設定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ petalinux-config --get-hw-description=&lt;path till the directory containing the respective xsa file&gt;
</pre></div>
</div>
<p>[PetaLinux Configuration] ウィンドウが開きます。この例では、このウィンドウで何も変更する必要はありません。</p>
</li>
<li><p><strong>&lt;Save&gt;</strong> をクリックして上記の設定を保存し、<strong>&lt;Exit&gt;</strong> をクリックして、コンフィギュレーション ウィザードを終了します。</p></li>
<li><p>次のコマンドを使用して、PetaLinux プロジェクト内に gpiotest という名前の Linux アプリケーションを作成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-create -t apps --template install --name gpiotest --enable
</pre></div>
</div>
</li>
<li><p>次のコマンドを使用して、<code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;vpk180&gt;/linux/bootimages</span></code> からプロジェクトにアプリケーション ファイルをコピーします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cp &lt;design-package&gt;/ch7_system_design_example_source__files/apu/gpiotest_app/gpiotest/files/* &lt;plnxproj-root&gt;/project-spec/meta-user/recipes-apps/gpiotest/files/
$cp &lt;design-package&gt;/ch7_system_design_example_source__files/apu/gpiotest_app/gpiotest/gpiotest.bb &lt;plnx-proj-root&gt;/project-spec/meta-user/recipes-apps/gpiotest/gpiotest.bb
$cp &lt;design-package&gt;/ch7_system_design_example_source__files/apu/device_tree/system-user.dtsi &lt;plnx-proj-root&gt;/project-spec/meta-user/recipes-bsp/device-tree/files/system-user.dtsi
</pre></div>
</div>
</li>
<li><p>カーネル コンフィギュレーション内で GPIO サポートをイネーブルにします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-config -c kernel
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>このコマンドは、PetaLinux プロジェクトのカーネル コンフィギュレーション ウィザードを開きます。</p>
</div>
</li>
<li><p><strong>[Device drivers] → [GPIO Support]</strong> をクリックし、<strong>&lt;Y&gt;</strong> キーを押してイネーブルにします。<strong>Enter</strong> キーを押たあとに、<strong>&lt;Y&gt;</strong> キーを押して、Debug GPIO コールと <code class="docutils literal notranslate"><span class="pre">/sys/class/gpio/...(sysfs</span> <span class="pre">interface)</span></code> のエントリをイネーブルにします。</p>
<img alt="../../../../_images/versal_2021_gpio_debug.png" src="../../../../_images/versal_2021_gpio_debug.png" />
</li>
<li><p><strong>[Memory mapped GPIO drivers]</strong> まで移動し、<strong>&lt;Y&gt;</strong> キーを押して、Xilinx GPIO のサポートおよび Xilinx Zynq GPIO のサポートをイネーブルにします。</p>
<img alt="../../../../_images/versal_2021_gpio_xilinx.png" src="../../../../_images/versal_2021_gpio_xilinx.png" />
</li>
<li><p><strong>&lt;Save&gt;</strong> をクリックして上記の設定を保存し、<strong>&lt;Exit&gt;</strong> をクリックして、コンフィギュレーション ウィザードを終了します。</p></li>
<li><p>AIE、STDC++、および Tcl オプションをディスエーブルにし、ROOTFS のサイズを SD および OSPI/QSPI フラッシュ メモリのパーティションの両方に収まるように、ROOTFS を構成します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">petalinux</span><span class="o">-</span><span class="n">config</span> <span class="o">-</span><span class="n">c</span> <span class="n">rootfs</span>
</pre></div>
</div>
</li>
<li><p>次の図のように、ユーザー パッケージに移動し、&lt;Y&gt; キーを押して aie-notebooks、openamp-demo-notebooks、packagegroup-petalinux-jupyter、pm-notebooks、python3-ipywidgets のサポートをディスエーブルにします。</p>
<img alt="../../../../_images/rootfs_config_aie.JPG" src="../../../../_images/rootfs_config_aie.JPG" />
</li>
<li><p>次の図のように、<strong>[Filesystem Packages] → [misc] → [gcc-runtime]</strong> に移動し、&lt;Y&gt; キーを押して <strong>[libstdc++ support]</strong> をディスエーブルにします。</p>
<img alt="../../../../_images/rootfs_config_stdc++.JPG" src="../../../../_images/rootfs_config_stdc++.JPG" />
</li>
<li><p>次の図のように、<strong>[Filesystem Packages] → [devel] → [tcltk] → [Tcl]</strong> に移動し、&lt;Y&gt; キーを押して <strong>[tcl support]</strong> をディスエーブルにします。</p>
<img alt="../../../../_images/rootfs_config_tcl.JPG" src="../../../../_images/rootfs_config_tcl.JPG" />
</li>
<li><p><strong>&lt;Save&gt;</strong> をクリックして上記の設定を保存し、<strong>&lt;Exit&gt;</strong> をクリックして、コンフィギュレーション ウィザードを終了します。</p>
<div class="admonition note">
<p class="admonition-title">注記</p>
<p>VPK180 プロダクション ボードで動作するには、SD および QSPI ブート モードのみです。</p>
</div>
</li>
<li><p>次のコマンドを使用して、Linux イメージをビルドします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ petalinux-build
</pre></div>
</div>
</li>
</ol>
<p>ビルドした画像をフラッシュ メモリに書き込むと、VPK180 ボード上のスレーブ SLR に接続された 4 つの LED がすべてオンになります。</p>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="6-system-design-example-HSDP.html" class="btn btn-neutral float-left" title="System Design Example for High-Speed Debug Port with SmartLynq+ Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 前の手順</a>
        <a href="A-creating-plm.html" class="btn btn-neutral float-right" title="Appendix: Creating the PLM" accesskey="n" rel="next">次の手順 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>© Copyright 2019-2023, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">最終更新日: 2023 年 2 月 3 日
<br>このページは最終更新日の英語版を翻訳したものです。最新版は、<a href="https://github.com/Xilinx/Embedded-Design-Tutorials">Github 英語版</a>を参照してください。      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>