<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>System Design Example for Versal Stacked Silicon Interconnect Devices &mdash; Embedded Design Tutorials 2022.2 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Appendix: Creating the PLM" href="A-creating-plm.html" />
    <link rel="prev" title="System Design Example for High-Speed Debug Port with SmartLynq+ Module" href="6-system-design-example-HSDP.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Embedded Design Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Versal-EDT.html">Versal ACAP Embedded Design Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-getting-started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-cips-noc-ip-config.html">Versal ACAP CIPS and NoC (DDR) IP Core Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-boot-and-config.html">Boot and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-debugging.html">Debugging Using the Vitis Software Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-system-design-example.html">System Design Example using Scalar Engine and Adaptable Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-system-design-example-HSDP.html">System Design Example for High-Speed Debug Port (HSDP) with SmartLynq+ Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">System Design Example for SSI Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#design-example-using-axi-gpio">Design Example: Using AXI GPIO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#versal-acap-cips-ip-core-configuration">Versal ACAP CIPS IP Core Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#noc-and-ddr-ip-core-configuration">NoC (and DDR) IP Core Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-pl-axi-gpio-and-axi-uart">Configuring PL AXI GPIO and AXI UART</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#example-project-freertos-axi-uartlite-application-project-with-rpu">Example Project: FreeRTOS AXI UARTLITE Application Project with RPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-project-creating-linux-images-using-petalinux">Example Project: Creating Linux Images Using PetaLinux</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="A-creating-plm.html">Appendix: Creating the PLM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ZynqMPSoC-EDT/ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC Embedded Design Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 Embedded Design Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Feature Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">First Stage Boot Loader (FSBL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/microblaze-system/README.html">Programming an Embedded MicroBlaze Processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/sw-profiling/sw-profiling.html">Profiling Applications with System Debugger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Design_Tutorials/MPSoC_Graphic_Subsystem/README.html">Example Setup for a Graphics and DisplayPort Based Sub-System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debugging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis Embedded Software Debugging Guide (UG1515) 2021.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/SPA-UG/SPA-UG.html">System Performance Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone Benchmark</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Releases</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2022.1/build/html/index.html">2022.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2020.2/build/html/index.html">2020.2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Embedded Design Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Versal-EDT.html">Versal ACAP Embedded Design Tutorial</a> &raquo;</li>
      <li>System Design Example for Versal Stacked Silicon Interconnect Devices</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Introduction/Versal-EDT/docs/7-system-design-example-ssit-device.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="system-design-example-for-versal-stacked-silicon-interconnect-devices">
<h1>System Design Example for Versal Stacked Silicon Interconnect Devices<a class="headerlink" href="#system-design-example-for-versal-stacked-silicon-interconnect-devices" title="Permalink to this heading">¶</a></h1>
<p>This chapter guides you through building a system based on Versal® devices using available tools and supported software blocks for Stacked Silicon Interconnect (SSI) devices. It explains how to create an embedded design utilizing PL AXI GPIO and PL AXI UART using the Vivado® tool for the Versal Premium VP1802 SSI device based VPK180 board. Refer to the Documentation Reference Guide <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug949-vivado-design-methodology/Designing-with-SSI-Devices">(UG949)</a> for information on designing with SSI devices. It also describes configuring and building the Linux operating system for an Arm® Cortex™-A72 core-based APU for a targeted Versal ACAP device.</p>
<section id="design-example-using-axi-gpio">
<span id="using-axi-gpio"></span><h2>Design Example: Using AXI GPIO<a class="headerlink" href="#design-example-using-axi-gpio" title="Permalink to this heading">¶</a></h2>
<p>The design example uses PL-based AXI GPIO interfaces to control the LEDs on the board using a Linux application (<code class="docutils literal notranslate"><span class="pre">gpiotest</span></code>). To utilize the four Super Logic Regions (SLR) available in the VP1802 SSI technology device, the PL AXI GPIO interface paths for LED0, LED1, LED2, and LED3 are routed via SLR-0, SLR-1, SLR-2, and SLR-3, respectively.</p>
<p>The RPU bare-metal example application uses the PL-based AXI UART lite to print the debug messages on the AXI UART console instead of using the PS UART console.</p>
<p>The steps to configure the following are described in this design example:</p>
<ul class="simple">
<li><p>Versal® ACAP CIPS IP core configuration for SSI technology devices.</p></li>
<li><p>NoC (DDR) IP Core configuration and related connections required for SSI technology devices.</p></li>
<li><p>Configure AXI GPIO and AXI UART PL IPs and related connections to the CIPS via PS and PL interfaces.</p></li>
</ul>
<section id="versal-acap-cips-ip-core-configuration">
<h3>Versal ACAP CIPS IP Core Configuration<a class="headerlink" href="#versal-acap-cips-ip-core-configuration" title="Permalink to this heading">¶</a></h3>
<p>The Versal® ACAP CIPS IP core allows you to configure the processing system and the PMC block, including boot mode, peripherals, clocks, interfaces, and interrupts, among other things.</p>
<section id="managing-the-versal-acap-cips-ip-core-in-the-vivado-design-suite">
<h4>Managing the Versal ACAP CIPS IP Core in the Vivado Design Suite<a class="headerlink" href="#managing-the-versal-acap-cips-ip-core-in-the-vivado-design-suite" title="Permalink to this heading">¶</a></h4>
<ol class="arabic">
<li><p>To create a new project and block design, follow the steps as given in <a class="reference internal" href="2-cips-noc-ip-config.html"><span class="doc">Versal ACAP CIPS and NoC (DDR) IP Core Configuration</span></a>.</p></li>
<li><p>To get started, add an IP from the IP catalog by clicking the <strong>Add IP</strong> button.</p></li>
<li><p>In the search box, type CIPS to find the Control, Interfaces, and Processing System.</p></li>
<li><p>Double-click the <strong>Control, Interface &amp; Processing System IP</strong> to add it to the block design. The CIPS IP core appears in the diagram view, as shown in the following figure:</p>
<a class="reference internal image-reference" href="../../../../_images/image7.png"><img alt="../../../../_images/image7.png" src="../../../../_images/image7.png" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>Run Block Automation</strong>.</p></li>
<li><p>Configure the run block settings as shown in the following figure:</p>
<a class="reference internal image-reference" href="../../../../_images/run-automation-1.png"><img alt="../../../../_images/run-automation-1.png" src="../../../../_images/run-automation-1.png" style="width: 600px;" /></a>
</li>
<li><p>Double-click <strong>versal_cips_0</strong> in the Block Diagram window.</p></li>
<li><p>Ensure that all the settings for <strong>Design Flow</strong> and <strong>Presets</strong> are as shown in the following figure.</p>
<a class="reference internal image-reference" href="../../../../_images/4_1-full-system.png"><img alt="../../../../_images/4_1-full-system.png" src="../../../../_images/4_1-full-system.png" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>Next</strong>, then click <strong>PS PMC</strong>.</p>
<a class="reference internal image-reference" href="../../../../_images/ps-pmc.png"><img alt="../../../../_images/ps-pmc.png" src="../../../../_images/ps-pmc.png" style="width: 600px;" /></a>
</li>
<li><p>Go to Peripherals and enable the TTC peripherals as shown in figure below:</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_peripherals.png"><img alt="../../../../_images/vpk_peripherals.png" src="../../../../_images/vpk_peripherals.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Make sure the <strong>IO</strong> configuration settings are as shown below:</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_io.png"><img alt="../../../../_images/vpk_io.png" src="../../../../_images/vpk_io.png" style="width: 600px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VPK180 preset values will set QSPI and SD as the default boot modes. No changes are required.</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>Click <strong>Interrupts</strong> and configure settings as shown in figure below:</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/interrupts.png"><img alt="../../../../_images/interrupts.png" src="../../../../_images/interrupts.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Click <strong>Finish</strong> and <strong>Finish</strong> to close the CIPS GUI.</p></li>
</ol>
</section>
</section>
<section id="noc-and-ddr-ip-core-configuration">
<h3>NoC (and DDR) IP Core Configuration<a class="headerlink" href="#noc-and-ddr-ip-core-configuration" title="Permalink to this heading">¶</a></h3>
<p>This section describes the NoC (and DDR) configuration and related connections required for use with the CIPS configured earlier in previous section. The NoC IP core allows configuring the NoC and enabling the DDR memory controllers.</p>
<section id="configuring-noc-and-cips">
<h4>Configuring NoC and CIPS<a class="headerlink" href="#configuring-noc-and-cips" title="Permalink to this heading">¶</a></h4>
<ol class="arabic">
<li><p>Open <strong>CIPS → PS-PMC</strong>.</p></li>
<li><p>Click <strong>NoC</strong> and enable the NoC coherent, non-coherent interfaces and the NoC to PMC interfaces for Master SLR (SLR-0) as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr0.png"><img alt="../../../../_images/vpk_noc-interface-slr0.png" src="../../../../_images/vpk_noc-interface-slr0.png" style="width: 600px;" /></a>
</li>
<li><p>Enable PMC to NoC and NoC to PMC connectivity for slave SLRs (SLR-1, SLR-2, SLR3) as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr-1.png"><img alt="../../../../_images/vpk_noc-interface-slr-1.png" src="../../../../_images/vpk_noc-interface-slr-1.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr-2.png"><img alt="../../../../_images/vpk_noc-interface-slr-2.png" src="../../../../_images/vpk_noc-interface-slr-2.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-interface-slr-3.png"><img alt="../../../../_images/vpk_noc-interface-slr-3.png" src="../../../../_images/vpk_noc-interface-slr-3.png" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>Finish</strong> and <strong>Finish</strong> to close the CIPS GUI.</p></li>
<li><p>Add two <strong>AXI NoC IP</strong> from the IP catalog.</p></li>
<li><p>Double-click the <strong>axi_noc-0</strong>. From Board tab, enable the LPDDR triplet and associated clocks as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc_board.png"><img alt="../../../../_images/vpk_noc_board.png" src="../../../../_images/vpk_noc_board.png" style="width: 600px;" /></a>
</li>
<li><p>Select the General tab, set <strong>Number of AXI Slave interfaces</strong>, <strong>AXI Clocks</strong> to 8, and the <strong>Number of Inter-NoC Master Interfaces</strong> to 5 as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_noc-settings.png"><img alt="../../../../_images/vpk_noc-settings.png" src="../../../../_images/vpk_noc-settings.png" style="width: 600px;" /></a>
</li>
<li><p>From the Inputs tab, configure the following settings for the 8 <strong>AXI Slave interfaces</strong> as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/noc-axi.png"><img alt="../../../../_images/noc-axi.png" src="../../../../_images/noc-axi.png" style="width: 600px;" /></a>
</li>
<li><p>Configure the following settings from the Connectivity tab.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-connectivity.png"><img alt="../../../../_images/vpk_noc-connectivity.png" src="../../../../_images/vpk_noc-connectivity.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>Double-click the <strong>axi_noc-1</strong>. From General tab, set <strong>Number of AXI Slave interfaces</strong> to 3, <strong>Number of AXI Master interfaces</strong> to 4, <strong>AXI Clocks</strong> to 7, and the <strong>Number of Inter-NoC Slave Interfaces</strong> to 5 as shown below.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc_board1.png"><img alt="../../../../_images/vpk_noc_board1.png" src="../../../../_images/vpk_noc_board1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>From the Inputs tab, configure the 3 <strong>AXI Slave interfaces</strong> to PS PMC as shown below:</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-axi1.png"><img alt="../../../../_images/vpk_noc-axi1.png" src="../../../../_images/vpk_noc-axi1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>From the Outputs tab, configure the 4 <strong>AXI Master interfaces</strong> to PS PMC as shown below:</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-axi2.png"><img alt="../../../../_images/vpk_noc-axi2.png" src="../../../../_images/vpk_noc-axi2.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>Configure the following settings from the Connectivity tab.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-connectivity1.png"><img alt="../../../../_images/vpk_noc-connectivity1.png" src="../../../../_images/vpk_noc-connectivity1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>Make connections between CIPS and NoC as shown below.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_noc-ip.png"><img alt="../../../../_images/vpk_noc-ip.png" src="../../../../_images/vpk_noc-ip.png" style="width: 600px;" /></a>
</div></blockquote>
</section>
</section>
<section id="configuring-pl-axi-gpio-and-axi-uart">
<h3>Configuring PL AXI GPIO and AXI UART<a class="headerlink" href="#configuring-pl-axi-gpio-and-axi-uart" title="Permalink to this heading">¶</a></h3>
<p>This section describes the PS and PL configurations and the related connections to create a complete system with AXI GPIO and AXI UART. You can do this by adding the required IPs from the Vivado IP catalog and then connect the components to blocks in the PS subsystem. To configure the hardware, follow these steps:</p>
<section id="configuring-cips-ps-pl-interface">
<h4>Configuring CIPS PS-PL interface<a class="headerlink" href="#configuring-cips-ps-pl-interface" title="Permalink to this heading">¶</a></h4>
<p>To connect the PL IPs to CIPS, follow these steps.</p>
<ol class="arabic">
<li><p>Double-click the Versal ACAP CIPS IP core.</p></li>
<li><p>Click <strong>PS-PMC→ PS-PL Interfaces</strong>.</p></li>
<li><p>Enable the <strong>M_AXI_FPD interface</strong> and set the <strong>Number of PL Resets</strong> to 1, as shown in the Image.</p>
<img alt="../../../../_images/PS_PL_Interfaces.png" src="../../../../_images/PS_PL_Interfaces.png" />
</li>
<li><p>Click <strong>Clocking</strong>, and then click on the Output Clocks tab.</p></li>
<li><p>Expand PMC Domain Clocks. Then expand PL Fabric Clocks. Configure the PL0_REF_CLK (PL CLK 0) to 300 MHz as shown in the following figure:</p>
<a class="reference internal image-reference" href="../../../../_images/clocking_ps_PMC.png"><img alt="../../../../_images/clocking_ps_PMC.png" src="../../../../_images/clocking_ps_PMC.png" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>Finish</strong> and <strong>OK</strong> to complete the configuration and return to the block diagram.</p></li>
</ol>
</section>
<section id="configuring-pl-hardware">
<h4>Configuring PL Hardware<a class="headerlink" href="#configuring-pl-hardware" title="Permalink to this heading">¶</a></h4>
<p>To configure the PL IPs used in this design example, follow these steps.</p>
<ol class="arabic">
<li><p>Right-click the block diagram and select <strong>Add IP</strong> from the IP catalog.</p></li>
<li><p>Search for AXI GPIO and double-click the <strong>AXI GPIO IP</strong> to add four instance of IP into the design.</p></li>
<li><p>Search for <strong>AXI Uartlite</strong> in the IP catalog and add it into the design.</p></li>
<li><p>Click <strong>Run Connection Automation</strong> in the Block Design view.</p>
<a class="reference internal image-reference" href="../../../../_images/image62.png"><img alt="../../../../_images/image62.png" src="../../../../_images/image62.png" style="width: 600px;" /></a>
<p>The Run Connection Automation dialog box opens.</p>
</li>
<li><p>In the Run Connection Automation dialog box, select the All Automation check box.</p>
<img alt="../../../../_images/vpk_image63.png" src="../../../../_images/vpk_image63.png" />
<p>This checks the automation for all the ports of the AXI GPIO IP.</p>
</li>
<li><p>Click <strong>GPIO</strong> of <code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> and set the Select Board Part Interface to <strong>Custom</strong> as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_image64.png"><img alt="../../../../_images/vpk_image64.png" src="../../../../_images/vpk_image64.png" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>S_AXI</strong> of <code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code>. Set the configurations as shown in the following figure.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_gpio_config0.png"><img alt="../../../../_images/vpk_gpio_config0.png" src="../../../../_images/vpk_gpio_config0.png" style="width: 600px;" /></a>
</li>
<li><p>Repeat steps 6 and 7 for <code class="docutils literal notranslate"><span class="pre">axi_gpio_1</span></code>, <code class="docutils literal notranslate"><span class="pre">axi_gpio_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">axi_gpio_3</span></code>.</p></li>
<li><p>Click <strong>S_AXI</strong> of <code class="docutils literal notranslate"><span class="pre">axi_uartlite_0</span></code>. Set the configurations as shown in the following figure.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_s-axi-uartlite1.png"><img alt="../../../../_images/vpk_s-axi-uartlite1.png" src="../../../../_images/vpk_s-axi-uartlite1.png" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>UART</strong> of <code class="docutils literal notranslate"><span class="pre">axi_uartlite_0</span></code>. Set the configurations as shown in the following figure.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_s-axi-uartlite.png"><img alt="../../../../_images/vpk_s-axi-uartlite.png" src="../../../../_images/vpk_s-axi-uartlite.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>This configuration sets the following connections:</p>
<ul class="simple">
<li><p>Connects the <code class="docutils literal notranslate"><span class="pre">S_AXI</span> of <span class="pre">AXI_GPIO</span></code> and AXI UART lite to <code class="docutils literal notranslate"><span class="pre">M_AXI_FPD</span></code> of CIPS with SmartConnect as a bridge IP between CIPS and AXI GPIO IPs.</p></li>
<li><p>Enables the processor system reset IP.</p></li>
<li><p>Connects the <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> to the processor system reset, AXI GPIO, and the SmartConnect IP clocks.</p></li>
<li><p>Connects the reset of the SmartConnect and AXI GPIO to the <code class="docutils literal notranslate"><span class="pre">peripheral_aresetn</span></code> of the processor system reset IP.</p></li>
</ul>
</li>
<li><p>Click <strong>Run Connection Automation</strong> in the block design window and select the All Automation check box.</p></li>
<li><p>Click <strong>ext_reset_in</strong> and configure the setting as shown below.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/image66.jpeg"><img alt="../../../../_images/image66.jpeg" src="../../../../_images/image66.jpeg" style="width: 600px;" /></a>
</div></blockquote>
<p>This connects the <cite>ext_reset_in</cite> of the processor system reset IP to the <code class="docutils literal notranslate"><span class="pre">pl_resetn</span></code> of the CIPS.</p>
<ol class="arabic simple" start="15">
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>Disconnect the <cite>aresetn</cite> of SmartConnect IP from <code class="docutils literal notranslate"><span class="pre">peripheral_aresetn</span></code> of processor system reset IP.</p></li>
<li><p>Connect the <cite>aresetn</cite> of SmartConnect IP to <code class="docutils literal notranslate"><span class="pre">interconnect_aresetn</span></code> of processor system reset IP.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/image67.jpeg"><img alt="../../../../_images/image67.jpeg" src="../../../../_images/image67.jpeg" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>Double-click the <strong>axi_gpio_0</strong> IP to open it.</p></li>
<li><p>Go to the IP Configuration tab, and configure the settings as shown in the following figure.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_image68.png"><img alt="../../../../_images/vpk_image68.png" src="../../../../_images/vpk_image68.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>Make the same setting for <code class="docutils literal notranslate"><span class="pre">axi_gpio_1</span></code>, <code class="docutils literal notranslate"><span class="pre">axi_gpio_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">axi_gpio_3</span></code>.</p></li>
<li><p>Delete the external pins of the <code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> IP and expand the interface.</p></li>
<li><p>Make the output of <code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> IP as External.</p></li>
<li><p>Right-click the external port of <code class="docutils literal notranslate"><span class="pre">axi_gpio_0</span></code> IP and select External Port Properties and rename as Dout_0.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_gpio_port.png"><img alt="../../../../_images/vpk_gpio_port.png" src="../../../../_images/vpk_gpio_port.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>Repeat step 21 to step 23 for <code class="docutils literal notranslate"><span class="pre">axi_gpio_1</span></code>, <code class="docutils literal notranslate"><span class="pre">axi_gpio_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">axi_gpio_3</span></code> and rename as Dout_1, Dout_2, and Dout_3, respectively.</p></li>
<li><p>Add three instances of <strong>AXI Register Slice</strong> IP to be placed on SLR-1, SLR-2, and SLR-3.</p></li>
<li><p>Right-click a Register Slice IP and select <strong>Block Properties</strong> and rename as axi_register_slice_1_s2 as shown below.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_register_light_2.png"><img alt="../../../../_images/vpk_register_light_2.png" src="../../../../_images/vpk_register_light_2.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>Double-click the AXI Register Slice IP and set the <strong>Register Slice Option</strong> as Light as shown below.</p></li>
</ol>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/vpk_register_light_1.png"><img alt="../../../../_images/vpk_register_light_1.png" src="../../../../_images/vpk_register_light_1.png" style="width: 600px;" /></a>
</div></blockquote>
<ol class="arabic simple" start="28">
<li><p>Repeat step 26 and 27 for the second and third instances of AXI Register Slice IP and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s2</span></code> and <code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s2</span></code>, respectively.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">axi_register_slice_1_s2</span></code>, <code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s2</span></code>, and <code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s2</span></code> are placed to SLR-1, SLR-2, and SLR-3, respectively using the constraints file provided as part of the package in the <a href="#id1"><span class="problematic" id="id2">``</span></a>pl_gpio_uart/constrs` folder.</p>
</div>
<p><strong>SLR Crossing from SLR-0 to SLR-1</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SLR crossing registers are added to improve timing closure and alleviate routing congestion of long resources.</p>
</div>
<ol class="arabic" start="29">
<li><p>Add two instances of <strong>AXI Register Slice</strong> IP to handle the SLR crossing from SLR-0 to SLR-1.</p></li>
<li><p>Right-click the Register Slice IP and select <strong>Block Properties</strong> and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_1_s1</span></code>.</p></li>
<li><p>Double-click the Register Slice IP and set the Register Slice Option as <strong>SLR Crossing</strong> as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_slr_crossing_1.png"><img alt="../../../../_images/vpk_slr_crossing_1.png" src="../../../../_images/vpk_slr_crossing_1.png" style="width: 600px;" /></a>
</li>
<li><p>Repeat step 30 and step 31 for the second instance of AXI Register Slice IP and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_1_s3</span></code>.</p></li>
</ol>
<p><strong>SLR Crossing from SLR-0 to SLR-2</strong></p>
<ol class="arabic" start="33">
<li><p>Similarly add two instances of <strong>AXI Register Slice</strong> IP to handle the multi SLR crossing from SLR-0 to SLR-2.</p></li>
<li><p>Right-click a Register Slice IP and select <strong>Block Properties</strong> and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s1</span></code>.</p></li>
<li><p>Double-click a Register Slice IP and set the Register Slice Option as <strong>Multi SLR Crossing</strong> as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_2_1.png"><img alt="../../../../_images/vpk_multi_slr_crossing_2_1.png" src="../../../../_images/vpk_multi_slr_crossing_2_1.png" style="width: 600px;" /></a>
</li>
<li><p>Open SLR Crossing tab, and set Number of SLR Crossing as 2 as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_2_2.png"><img alt="../../../../_images/vpk_multi_slr_crossing_2_2.png" src="../../../../_images/vpk_multi_slr_crossing_2_2.png" style="width: 600px;" /></a>
</li>
<li><p>Repeat step 34, step 35, and step 36 for the second instance of AXI Register Slice IP and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_2_s3</span></code>.</p></li>
</ol>
<p><strong>SLR Crossing from SLR-0 to SLR-3</strong></p>
<ol class="arabic" start="38">
<li><p>Similarly add two instances of <strong>AXI Register Slice</strong> IP to handle the SLR crossing from SLR-0 to SLR-3.</p></li>
<li><p>Right-click a Register Slice IP and select <strong>Block Properties</strong> and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s1</span></code>.</p></li>
<li><p>Double-click a Register Slice IP and set the Register Slice Option as <strong>Multi SLR Crossing</strong> as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_3.png"><img alt="../../../../_images/vpk_multi_slr_crossing_3.png" src="../../../../_images/vpk_multi_slr_crossing_3.png" style="width: 600px;" /></a>
</li>
<li><p>Open SLR Crossing tab, and set Number of SLR Crossing as 3 as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_multi_slr_crossing_4.png"><img alt="../../../../_images/vpk_multi_slr_crossing_4.png" src="../../../../_images/vpk_multi_slr_crossing_4.png" style="width: 600px;" /></a>
</li>
<li><p>Repeat step 39, step 40, and step 41 for the second instance of the AXI Register Slice IP and rename as <code class="docutils literal notranslate"><span class="pre">axi_register_slice_3_s3</span></code>.</p></li>
<li><p>Disconnect <cite>axi_gpio_0</cite> , <cite>axi_gpio_1</cite> , <cite>axi_gpio_2</cite> and <cite>axi_gpio_3</cite> from axi smart connect and connect the register slices as shown below.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_register_slice_con.PNG"><img alt="../../../../_images/vpk_register_slice_con.PNG" src="../../../../_images/vpk_register_slice_con.PNG" style="width: 600px;" /></a>
</li>
<li><p>Click <strong>Run Connection Automation</strong> in the Block Design view. Select <code class="docutils literal notranslate"><span class="pre">aclk</span></code> of all register slices and click <strong>OK</strong>.</p>
<a class="reference internal image-reference" href="../../../../_images/vpk_register_slice_con_clk.png"><img alt="../../../../_images/vpk_register_slice_con_clk.png" src="../../../../_images/vpk_register_slice_con_clk.png" style="width: 600px;" /></a>
</li>
<li><p>Double-click <strong>axi_uartlite_0</strong> to open the IP. Go to the IP Configuration tab and configure the settings as shown in the following figure.</p>
<img alt="../../../../_images/vpk_configure-ip-settings.png" src="../../../../_images/vpk_configure-ip-settings.png" />
</li>
<li><p>Add <strong>Clock Wizard IP</strong>. Double-click to open the IP.</p></li>
<li><p>Go to Clocking Features tab and set the configuration as shown below:</p>
<img alt="../../../../_images/clocking-features.png" src="../../../../_images/clocking-features.png" />
</li>
<li><p>Make sure the Source option in <strong>Input Clock Information</strong> is set to <strong>Global buffer</strong>.</p></li>
<li><p>Go to Output clocks tab and configure the output clock as <strong>250 MHz</strong> as follows:</p>
<img alt="../../../../_images/vpk_output-clocks-tab.png" src="../../../../_images/vpk_output-clocks-tab.png" />
</li>
<li><p>Right-click <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> of CIPS and click <strong>Disconnect Pin</strong>.</p></li>
<li><p>Connect the <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> from CIPS to input <code class="docutils literal notranslate"><span class="pre">clk_in1</span></code> of the Clocking wizard.</p></li>
<li><p>Connect the output of clocking wizard to <code class="docutils literal notranslate"><span class="pre">slowest_sync_clock</span></code> of Processor System Reset IP.</p>
<p>This will help in avoiding timing failure.</p>
</li>
</ol>
<p>The overall block design is shown in the following figure:</p>
<img alt="../../../../_images/vpk_image73.png" src="../../../../_images/vpk_image73.png" />
</section>
<section id="validating-the-design-and-generating-the-output">
<h4>Validating the Design and Generating the Output<a class="headerlink" href="#validating-the-design-and-generating-the-output" title="Permalink to this heading">¶</a></h4>
<p>To validate the design and to generate the output product, follow these steps:</p>
<ol class="arabic">
<li><p>Return to the block design view and save your block design (press <strong>Ctrl+S</strong>).</p></li>
<li><p>Right-click in the white space of the Block Diagram view and select <strong>Validate Design</strong>. Alternatively, you can press the F6 key. A message dialog box opens as shown below.</p>
<p>The Vivado tool will prompt you to map the IPs in the design to an address. Click <strong>Yes</strong>.</p>
<img alt="../../../../_images/vpk_assign-address.png" src="../../../../_images/vpk_assign-address.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of address segments may vary depending on the number of memory mapped IPs in the design.</p>
</div>
<p>Once the validation is complete, A message dialog box opens as shown below:</p>
<img alt="../../../../_images/validation_message.PNG" src="../../../../_images/validation_message.PNG" />
</li>
<li><p>Click <strong>OK</strong> to close the message.</p></li>
<li><p>Click the <strong>Sources</strong> window.</p>
<ol class="arabic">
<li><p>Expand Constraints.</p></li>
<li><p>Right-click on <strong>constrs_1-&gt; ADD Sources</strong>.</p>
<p>The Add Sources window opens.</p>
</li>
<li><p>Choose <strong>Add or Create Constraints</strong> option and click <strong>Next</strong>.</p></li>
<li><p>Choose the .xdc file to be added.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The constraints file is provided as part of the package in the <code class="docutils literal notranslate"><span class="pre">pl_gpio_uart/constrs</span></code> folder.</p>
</div>
</li>
<li><p>Click <strong>Finish</strong>.</p></li>
</ol>
</li>
<li><p>Click <strong>Hierarchy</strong>.</p></li>
<li><p>In the Sources window, under Design Sources, expand <strong>edt_versal_wrapper</strong>.</p></li>
<li><p>Right-click the top-level block design, edt_versal_i : edt_versal (<code class="docutils literal notranslate"><span class="pre">edt_versal.bd</span></code>), and select <strong>Generate Output Products</strong>.</p>
<img alt="../../../../_images/GOP.png" src="../../../../_images/GOP.png" />
</li>
<li><p>Click <strong>Generate</strong>.</p></li>
<li><p>When the Generate Output Products process completes, click <strong>OK</strong>.</p></li>
<li><p>In the Sources window, click the <strong>IP Sources</strong> view. Here, you can see the output products that you just generated, as shown in the following figure.</p>
<img alt="../../../../_images/vpk_180_ip-sources-ch5-final.png" src="../../../../_images/vpk_180_ip-sources-ch5-final.png" />
</li>
</ol>
</section>
<section id="synthesizing-implementing-and-generating-the-device-image">
<h4>Synthesizing, Implementing, and Generating the Device Image<a class="headerlink" href="#synthesizing-implementing-and-generating-the-device-image" title="Permalink to this heading">¶</a></h4>
<p>Follow these steps to generate a device image for the design.</p>
<ol class="arabic">
<li><p>Go to <strong>Flow Navigator→ Program and Debug</strong>, click <strong>Generate Device Image</strong> and click <strong>OK</strong>.</p></li>
<li><p>A No Implementation Results Available menu appears. Click <strong>Yes</strong>.</p></li>
<li><p>A Launch Run menu appears. Click <strong>OK</strong>.</p>
<p>When the Device Image Generation completes, the Device Image Generation Completed dialog box opens.</p>
</li>
<li><p>Click <strong>Cancel</strong> to close the window.</p></li>
<li><p>Export hardware after you generate the Device Image.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following steps are optional and you can skip these and go to the <a class="reference internal" href="#exporting-hardware-7"><span class="std std-ref">Exporting Hardware</span></a> section. These steps provide the detailed flow for generating the device image by running synthesis and implementation before generating device image. If you need to understand the flow for generating the device image, follow the steps provided below.</p>
<ol class="arabic">
<li><p>Go to <strong>Flow Navigator→ Synthesis</strong> and click <strong>Run Synthesis</strong>.</p>
<img alt="../../../../_images/image17.png" src="../../../../_images/image17.png" />
</li>
<li><p>If Vivado prompts you to save your project before launching synthesis, click <strong>Save</strong>.</p>
<p>While synthesis is running, a status bar is displayed in the upper right-hand window. This status bar spools for various reasons throughout the design process. The status bar signifies that a process is working in the background. When synthesis is complete, the Synthesis Completed dialog box opens.</p>
</li>
<li><p>Select <strong>Run Implementation</strong> and click <strong>OK</strong>.</p>
<p>When implementation completes, the Implementation Completed dialog box opens.</p>
</li>
<li><p>Select <strong>Generate Device Image</strong> and click <strong>OK</strong>.</p>
<p>When Device Image Generation completes, the Device Image Generation Completed dialog box opens.</p>
</li>
<li><p>Click <strong>Cancel</strong> to close the window.</p>
<p>Export hardware, after you generate Device Image.</p>
</li>
</ol>
</div>
</section>
<section id="exporting-hardware">
<span id="exporting-hardware-7"></span><h4>Exporting Hardware<a class="headerlink" href="#exporting-hardware" title="Permalink to this heading">¶</a></h4>
<ol class="arabic">
<li><p>From the Vivado main menu, select <strong>File→ Export → Export Hardware</strong>. The Export Hardware dialog box opens.</p></li>
<li><p>Choose <strong>Include bitstream</strong> and click <strong>Next</strong>.</p></li>
<li><p>Provide a name for your exported file (or use the default provided) and choose the location. Click <strong>Next</strong>.</p>
<p>A warning message appears if a hardware module has already been exported. You may choose to pick a different name for this design or click <strong>Yes</strong> to overwrite the existing XSA file, if the overwrite message is displayed.</p>
</li>
<li><p>Click <strong>Finish</strong>.</p></li>
</ol>
</section>
</section>
</section>
<section id="example-project-freertos-axi-uartlite-application-project-with-rpu">
<h2>Example Project: FreeRTOS AXI UARTLITE Application Project with RPU<a class="headerlink" href="#example-project-freertos-axi-uartlite-application-project-with-rpu" title="Permalink to this heading">¶</a></h2>
<p>This section explains how to configure and build the FreeRTOS application for an Arm Cortex-R5F core based RPU on a Versal device.</p>
<p>The following steps demonstrate the procedure to create a FreeRTOS Application from Arm Cortex-R5F:</p>
<ol class="arabic">
<li><p>Start the Vitis™ IDE and create a new workspace, for example, <code class="docutils literal notranslate"><span class="pre">c:/edt/freertos</span></code>.</p></li>
<li><p>Select <strong>File→ New → Application Project</strong>. The <strong>Creating a New Application Project</strong> wizard opens. If this is the first time that you have launched the Vitis IDE, you can select <strong>Create Application Project</strong> on the Welcome screen as shown in the following figure.</p>
<img alt="../../../../_images/image75.jpeg" src="../../../../_images/image75.jpeg" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Optionally, you can check the box next to <strong>Skip welcome page next time</strong> to skip seeing the welcome page every time.</p>
</div>
</li>
<li><p>There are four components of an application project in the Vitis IDE: a target platform, a system project, a domain and a template. To create a new application project in the Vitis IDE, follow these steps:</p>
<ol class="arabic">
<li><p>A target platform is composed of a base hardware design and the meta-data used in attaching accelerators to declared interfaces. Choose a platform or create a platform project from the XSA that you exported from the Vivado Design Suite.</p></li>
<li><p>Put the application project in a system project, and associate it with a processor.</p></li>
<li><p>The domain defines the processor and operating system used for running the host program on the target platform.</p></li>
<li><p>Choose a template for the application, to quick start development. Use the following information to make your selections in the wizard screens.</p>
<p><em>Table:</em> <strong>Wizard Information</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Wizard Screen</p></th>
<th class="head"><p>System Properties</p></th>
<th class="head"><p>Setting or Command to Use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Platform</p></td>
<td><p>Create a new platform
from hardware (XSA)</p></td>
<td><p>Click Browse to add your
XSA file</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Platform Name</p></td>
<td><p>vpk180_platform</p></td>
</tr>
<tr class="row-even"><td><p>Application
Project
Detail</p></td>
<td><p>Application project
name</p></td>
<td><p>freertos_gpio_test</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Select a system project</p></td>
<td><p>+Create New</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>System project name</p></td>
<td><p>freertos_gpio_test_system</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Processor</p></td>
<td><p>versal_cips
_0_pspmc_0_psv_cortexr5_0</p></td>
</tr>
<tr class="row-even"><td><p>Dom</p></td>
<td><p>Select a domain</p></td>
<td><p>+Create New</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Name</p></td>
<td><p>The default name assigned</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Display Name</p></td>
<td><p>The default name assigned</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Operating System</p></td>
<td><p>freertos10_xilinx</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Processor</p></td>
<td><p>versal_cips
_0_pspmc_0_psv_cortexr5_0</p></td>
</tr>
<tr class="row-odd"><td><p>Templates</p></td>
<td><p>Available</p></td>
<td><p>Empty</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Templates</p></td>
<td><p>Application (C)</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>The Vitis software platform creates the board support package for the Platform project (<strong>vpk180_platform</strong>) and the system project (<strong>freertos_gpio_test_system</strong>) containing an application project named <strong>freertos_gpio_test</strong> under the Explorer view after performing the preceding steps.</p>
</li>
<li><p>Delete the source files under <cite>src/</cite> directory and Copy the freertos source code files from the FreeRTOS project path, <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/ch5_system_design_example_source__files/rpu/</span></code> to the <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory.</p></li>
<li><p>Configure the Vitis IDE to enable AXI UARTLITE for RPU application debug console under the FreeRTOS Board Support Package.</p>
<p>Navigate to <cite>platform.spr</cite> under vpk180_platform project, and then select <strong>Modify BSP</strong> settings under Board support package, and modify stdin and stdout to <strong>axi_uarlite_0</strong> by pressing &lt;Y&gt; option as shown in the figure.</p>
<img alt="../../../../_images/vitis_uartlite_enable.JPG" src="../../../../_images/vitis_uartlite_enable.JPG" />
</li>
<li><p>Click <strong>&lt;OK&gt;</strong> to save the above configuration and exit the configuration wizard.</p></li>
<li><p>Right-click <strong>freertos_gpio_test_system</strong> and select <strong>Build Project</strong>. Alternatively, you can click <img alt="build" src="../../../../_images/image291.png" />.</p>
<p>For building the Linux images and incorporating the FreeRTOS elf into the image, see <a class="reference internal" href="#creating-linux-images-using-petalinux"><span class="std std-ref">Example Project: Creating Linux Images Using PetaLinux</span></a>.</p>
</li>
<li><p>On PL AXI UART Serial Console, RPU debug logs will be printed as below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Gpio</span> <span class="n">Initialization</span> <span class="n">started</span>
<span class="n">Counter</span> <span class="mi">0</span>
<span class="n">Counter</span> <span class="mi">1</span>
<span class="n">Counter</span> <span class="mi">2</span>
<span class="n">Counter</span> <span class="mi">3</span>
<span class="n">Counter</span> <span class="mi">4</span>
<span class="n">Counter</span> <span class="mi">5</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="example-project-creating-linux-images-using-petalinux">
<span id="creating-linux-images-using-petalinux"></span><h2>Example Project: Creating Linux Images Using PetaLinux<a class="headerlink" href="#example-project-creating-linux-images-using-petalinux" title="Permalink to this heading">¶</a></h2>
<p>This section explains how to configure and build the Linux operating system for an Arm Cortex-A72 core-based APU on a Versal device. You can use the PetaLinux tool with the board-specific BSP to configure and build Linux images.</p>
<p>This example needs a Linux host machine. Refer to the PetaLinux Tools Documentation Reference Guide <a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/rdoc?v=latest;d=ug1144-petalinux-tools-reference-guide.pdf">UG1144</a> for information on dependencies and installation procedure for the PetaLinux tool.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This example uses the VPK180 PetaLinux BSP to create a PetaLinux project. Ensure that you have downloaded the respective BSP for PetaLinux (VPK180).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Board</p></th>
<th class="head"><p>QSPI/SD</p></th>
<th class="head"><p>OSPI</p></th>
<th class="head"><p>eMMC</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VPK180 Production Board</p></td>
<td><p><a class="reference external" href="https://www.xilinx.com/member/forms/download/xef.html?filename=xilinx-vpk120-v2022.2-10141622.bsp">xilinx-vpk180-v2022.2-11160035.bsp</a></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic">
<li><p>Copy the respective board’s PetaLinux BSP to the current directory.</p></li>
<li><p>Set up the PetaLinux environment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ source &lt;petalinux-tools-path&gt;/settings.csh
</pre></div>
</div>
</li>
<li><p>Create a PetaLinux project using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ petalinux-create -t project -s xilinx-vpk180-vxxyy.z-final.bsp -n led_example
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For VPK180 board, use <cite>xilinx-vpk180-vxxyy.z-final.bsp</cite> after the <cite>-s</cite> option in the command.</p></li>
</ul>
</div>
</li>
<li><p>Change to the PetaLinux project directory using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cd led_example
</pre></div>
</div>
</li>
<li><p>Copy the hardware platform project XSA to the Linux host machine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the VPK180 board, use the XSA file that you generated in the <a class="reference internal" href="#using-axi-gpio"><span class="std std-ref">Design Example: Using AXI GPIO</span></a>.</p>
</div>
</li>
<li><p>Reconfigure the BSP using the following commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ petalinux-config --get-hw-description=&lt;path till the directory containing the respective xsa file&gt;
</pre></div>
</div>
<p>This command opens the PetaLinux Configuration window. For this example, no need to change anything in this window.</p>
</li>
<li><p>Click <strong>&lt;Save&gt;</strong> to save the above configuration and then <strong>&lt;Exit&gt;</strong> to exit the configuration wizard.</p></li>
<li><p>Create a Linux application named gpiotest within the PetaLinux project using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-create -t apps --template install --name gpiotest --enable
</pre></div>
</div>
</li>
<li><p>Copy application files from <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;vpk180&gt;/linux/bootimages</span></code> to the project using the following commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$cp &lt;design-package&gt;/ch7_system_design_example_source__files/apu/gpiotest_app/gpiotest/files/* &lt;plnxproj-root&gt;/project-spec/meta-user/recipes-apps/gpiotest/files/
$cp &lt;design-package&gt;/ch7_system_design_example_source__files/apu/gpiotest_app/gpiotest/gpiotest.bb &lt;plnx-proj-root&gt;/project-spec/meta-user/recipes-apps/gpiotest/gpiotest.bb
$cp &lt;design-package&gt;/ch7_system_design_example_source__files/apu/device_tree/system-user.dtsi &lt;plnx-proj-root&gt;/project-spec/meta-user/recipes-bsp/device-tree/files/system-user.dtsi
</pre></div>
</div>
</li>
<li><p>Enable GPIO support within kernel configuration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-config -c kernel
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This command opens the kernel configuration wizard for the PetaLinux project.</p>
</div>
</li>
<li><p>Navigate to <strong>Device drivers→ GPIO Support</strong> and enable it by pressing the <strong>&lt;Y&gt;</strong> key. Press <strong>Enter</strong> and enable the Debug GPIO calls and <code class="docutils literal notranslate"><span class="pre">/sys/class/gpio/...(sysfs</span> <span class="pre">interface)</span></code> entries by pressing the <strong>&lt;Y&gt;</strong> key as shown in the following figure.</p>
<img alt="../../../../_images/versal_2021_gpio_debug.png" src="../../../../_images/versal_2021_gpio_debug.png" />
</li>
<li><p>Navigate to <strong>Memory mapped GPIO drivers</strong> and enable Xilinx GPIO support and Xilinx Zynq GPIO support by pressing <strong>&lt;Y&gt;</strong> key as shown in the following figure.</p>
<img alt="../../../../_images/versal_2021_gpio_xilinx.png" src="../../../../_images/versal_2021_gpio_xilinx.png" />
</li>
<li><p>Click <strong>&lt;Save&gt;</strong> to save the above configuration and then <strong>&lt;Exit&gt;</strong> option to exit the configuration wizard.</p></li>
<li><p>Configure ROOTFS to disable the AIE, STDC++, and Tcl options to reduce the rootfs size to fit into both SD and OSPI/QSPI Flash partitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">petalinux</span><span class="o">-</span><span class="n">config</span> <span class="o">-</span><span class="n">c</span> <span class="n">rootfs</span>
</pre></div>
</div>
</li>
<li><p>Navigate to User Packages and disable aie-notebooks, openamp-demo-notebooks, packagegroup-petalinux-jupyter, pm-notebooks, python3-ipywidgets support by pressing &lt;Y&gt; key as shown in the following figure.</p>
<img alt="../../../../_images/rootfs_config_aie.JPG" src="../../../../_images/rootfs_config_aie.JPG" />
</li>
<li><p>Navigate to <strong>Filesystem Packages → misc → gcc-runtime</strong> and disable <strong>libstdc++ support</strong> by pressing &lt;Y&gt; key as shown in the following figure.</p>
<img alt="../../../../_images/rootfs_config_stdc++.JPG" src="../../../../_images/rootfs_config_stdc++.JPG" />
</li>
<li><p>Navigate to <strong>Filesystem Packages → devel → tcltk → tcl</strong> and disable <strong>tcl support</strong> by pressing &lt;Y&gt; key as shown in the following figure.</p>
<img alt="../../../../_images/rootfs_config_tcl.JPG" src="../../../../_images/rootfs_config_tcl.JPG" />
</li>
<li><p>Click <strong>&lt;Save&gt;</strong> to save the above configuration and then click <strong>&lt;Exit&gt;</strong> to exit the configuration wizard.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only SD and QSPI boot modes will work on VPK180 Production boards.</p>
</div>
</li>
<li><p>Build the Linux images using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ petalinux-build
</pre></div>
</div>
</li>
</ol>
<p>After flashing the built images, all four LEDs which are connected to slave SLR will be turned on on the VPK180 board.</p>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="6-system-design-example-HSDP.html" class="btn btn-neutral float-left" title="System Design Example for High-Speed Debug Port with SmartLynq+ Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="A-creating-plm.html" class="btn btn-neutral float-right" title="Appendix: Creating the PLM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2023, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on February 03, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>