


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
	    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="End-To-End Performance Analysis" href="10-end-to-end-performance-analysis.html" />
    <link rel="prev" title="Evaluating Memory Hierarchy and the ACP" href="8-evaluating-memory-hierarchy-ACP.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Embedded Design Tutorials
          

          
          </a>

          
            
            
              <div class="version">
                2021.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction/Versal-EDT/Versal-EDT.html">Versal ACAP Embedded Design Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction/ZynqMPSoC-EDT/ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC Embedded Design Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction/Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 Embedded Design Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Feature Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">First Stage Boot Loader (FSBL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/sw-profiling/sw-profiling.html">Profiling Applications with System Debugger</a></li>
</ul>
<p class="caption"><span class="caption-text">Design Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Design_Tutorials/MPSoC_Graphic_Subsystem/README.html">Example Setup for a Graphics and DisplayPort Based Sub-System</a></li>
</ul>
<p class="caption"><span class="caption-text">Debugging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis Embedded Software Debugging Guide (UG1515) 2021.1</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../SPA-UG.html">System Performance Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-system-performance-modeling-project.html">System Performance Modeling Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-monitor-framework.html">Monitor Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-getting-started-with-SPM.html">Getting Started with SPM</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-evaluating-software-performance.html">Evaluating Software Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-evaluating-high-performance-ports.html">Evaluating High-Performance Ports</a></li>
<li class="toctree-l2"><a class="reference internal" href="7-evaluating-DDR-controller-settings.html">Evaluating DDR Controller Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="8-evaluating-memory-hierarchy-ACP.html">Evaluating Memory Hierarchy and the ACP</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using SPA with a Custom Target</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instrumenting-hardware">Instrumenting Hardware</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#instantiate-apm-ip">Instantiate APM IP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#instantiate-axi-traffic-generator-ip">Instantiate AXI Traffic Generator IP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#export-to-vitis-ide">Export to Vitis IDE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#instrumenting-software">Instrumenting Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="#monitoring-a-custom-target">Monitoring a Custom Target</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="10-end-to-end-performance-analysis.html">End-To-End Performance Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="A-performance-checklist.html">Appendix: Performance Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SPA-UG.html#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone Benchmark</a></li>
</ul>
<p class="caption"><span class="caption-text">Previous Releases</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.1/docs/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="http://xilinx.github.io/Embedded-Design-Tutorials/docs/2020.2/docs/index.html">2020.2</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/docs/User_Guides/SPA-UG/docs/9-using-spa-with-custom-target.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Embedded Design Tutorials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../SPA-UG.html">System Performance Analysis</a> &raquo;</li>
        
      <li>Using SPA with a Custom Target</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/User_Guides/SPA-UG/docs/9-using-spa-with-custom-target.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-spa-with-a-custom-target">
<h1>Using SPA with a Custom Target<a class="headerlink" href="#using-spa-with-a-custom-target" title="Permalink to this headline">¶</a></h1>
<p>To use the Vitis™ IDE system performance analysis toolbox with your design, there are three important items to be aware of:</p>
<ul class="simple">
<li><p>Instrumenting your hardware</p></li>
<li><p>Instrumenting your software</p></li>
<li><p>Monitoring a live, custom target within the Vitis IDE.</p></li>
</ul>
<div class="section" id="instrumenting-hardware">
<h2>Instrumenting Hardware<a class="headerlink" href="#instrumenting-hardware" title="Permalink to this headline">¶</a></h2>
<p>As long as your design include the AXI Performance Monitor (APM) IP, you can make use of the Vitis IDE performance analysis features to visualize the AXI performance. The Vitis IDE performance analysis can also make use of AXI Traffic Generator IP in your system, if it is configured and connected properly. So, you can create hardware designs similar to the pre-built SPM projects.</p>
<div class="section" id="instantiate-apm-ip">
<h3>Instantiate APM IP<a class="headerlink" href="#instantiate-apm-ip" title="Permalink to this headline">¶</a></h3>
<p>The Zynq UltraScale+ MPSoC has some hardened APM IP blocks in the PS. They can be used to monitor the AXI performance for DDR, CCI, OCM and LPD. Check the yellow blocks in the following diagram.</p>
<p><img alt="../../../../_images/X21026-060818.png" src="../../../../_images/X21026-060818.png" /></p>
<p>The Vitis IDE performance analysis can make use of the PS built-in APM (blocks in yellow in the diagram above) as well as user-instantiated APM IPs in the PL. You can instantiate the APM in PL to monitor the performance of AXI interfaces between PS and PL for Zynq-7000 devices and Zynq UltraScale+ MPSoCs.</p>
<p><em>Figure 44:</em> <strong>AXI Performance Monitor</strong></p>
<p><img alt="../../../../_images/vivado_apm.png" src="../../../../_images/vivado_apm.png" /></p>
<p>The previous figure shows how an instance of an APM appears in a Vivado® Design Suite IP integrator block diagram, as well as its configuration panel. The following steps give an example of adding an IP, connecting it, and configuring it. For more information about the Vivado IP Integrator, see the <em>Vivado Design Suite Tutorial: Embedded Processor Hardware Design</em> <a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/rdoc?v=latest%3Bd=ug940-vivado-tutorial-embedded-design.pdf">UG940</a> and <em>Zynq UltraScale+ MPSoC Embedded Design Tutorial</em> <a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs/Introduction/ZynqMPSoC-EDT/README.html">UG1209</a>.</p>
<ol class="simple">
<li><p>Add the APM IP to your Vivado design:</p>
<ul class="simple">
<li><p>In the IP integrator block diagram, click the <strong>Add IP</strong> button.</p></li>
<li><p>Search for <strong>AXI Performance Monitor</strong> and double-click it.</p></li>
</ul>
</li>
<li><p>Customize the APM IP.</p>
<ul class="simple">
<li><p>Double-click the APM to open the Re-customize IP dialog box. In this dialog box, set the following:</p>
<ul>
<li><p>Set <strong>APM Mode</strong> to <strong>Profile</strong>.</p></li>
<li><p>Set the <strong>Number of Monitor interfaces</strong> to the number of interfaces you want to monitor. For this example, choose <strong>5</strong>.</p></li>
<li><p>Click <strong>OK</strong> to close the window.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Connect the APM to your design:</p>
<ul class="simple">
<li><p>Connect <strong>S_AXI</strong> to the General Purpose AXI Interface on the Processing System (via AXI interconnect). You can use this interface to read and write APM registers from PS.</p></li>
<li><p>Connect <strong>s_axi_aclk</strong> and <strong>s_axi_aresetn</strong> to the clock and reset associated with <strong>S_AXI</strong> above.</p></li>
<li><p>Connect the <strong>SLOT_x_AXI</strong> ports (where x=0…4) to any AXI interfaces you want to monitor, such as S_AXI_HPx, and ACP on Zynq-7000 devices, and S_AXI_HPx, S_AXI_HPCx, or S_AXI_ACE on Zynq UltraScale+ MPSoCs.</p></li>
<li><p>Connect all inputs <strong>slot_x_axi_aclk</strong> and <strong>slot_x_axi_aresetn</strong> to the appropriate clocks and resets. They are used for the monitor AXI interfaces.</p></li>
<li><p>Connect <strong>core_aclk</strong> and <strong>core_aresetn</strong> to the clock/reset with the highest clock frequency.</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="instantiate-axi-traffic-generator-ip">
<h3>Instantiate AXI Traffic Generator IP<a class="headerlink" href="#instantiate-axi-traffic-generator-ip" title="Permalink to this headline">¶</a></h3>
<p>If you have not implemented your traffic IP during the system performance evaluation, you can use the AXI Traffic Generator to mimic its throughput to test the system performance. The AXI Traffic Generator is optional to SPA.</p>
<p>Follow these steps to add, configure, and connect the ATG IP to your Vivado design.</p>
<ol>
<li><p>Add ATG IP to your Vivado design:</p>
<ul class="simple">
<li><p>In the IP integrator block diagram, click the <strong>Add IP</strong> button.</p></li>
<li><p>Search for <strong>AXI Traffic Generator</strong> and double-click it.</p></li>
</ul>
</li>
<li><p>Customize the ATG IP</p>
<blockquote>
<div><p><strong><em>Note</em>:</strong> You can use most of the default ATG settings. Note that the master interface of the ATG should match the width of the AXI interface test.</p>
</div></blockquote>
<ul class="simple">
<li><p>Double-click the ATG to open the Re-customize IP dialog box. In this dialog box, set the following:</p>
<ul>
<li><p>Set <strong>Data Width</strong> of <strong>Master Interface</strong> section to the AXI interface width you want to test. For this example, set it to <strong>128</strong>. Change the settings accordingly if the AXI interface you want to monitor has some special settings.</p></li>
<li><p>Click <strong>OK</strong> to close the window.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Connect the ATG IP to your design by doing the following:</p>
<ul class="simple">
<li><p>Connect <strong>S_AXI</strong> to the General Purpose AXI Interface on the PS (via AXI interconnect). You can use this interface to read and write APM registers from PS.</p></li>
<li><p>Connect <strong>s_axi_aclk</strong> and <strong>s_axi_aresetn</strong> to the clock and reset associated with <strong>S_AXI</strong> above.</p></li>
<li><p>Connect the <strong>M_AXI</strong> ports to any AXI interfaces you want to test, such as S_AXI_HPx, and ACP on Zynq-7000 devices and S_AXI_HPx_FPD, S_AXI_HPCx, or S_AXI_ACE on Zynq UltraScale+ MPSoCs (through AXI Interconnect or AXI SmartConnect).</p></li>
<li><p>Connect <strong>irq_out</strong> to the PL-PS IRQ input of PS. You can connect it through a Concat IP, if there are multiple interrupt inputs to the PS.</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="export-to-vitis-ide">
<h3>Export to Vitis IDE<a class="headerlink" href="#export-to-vitis-ide" title="Permalink to this headline">¶</a></h3>
<p>To configure the Vitis IDE to read the hardware design, generate a platform, and read the APM and ATG related information, follow these steps:</p>
<ul class="simple">
<li><p>In the Flow Navigator pane, click <strong>Generate Bitstream</strong>.</p></li>
<li><p>After the bitstream is generated, export the design using the <strong>File → Export→ Export Hardware → Include bitstream</strong>.</p></li>
<li><p>Select the name and path to save this XSA.</p></li>
<li><p>After exporting the design, launch the Vitis IDE by selecting <strong>Tools → Launch Vitis IDE</strong>.</p></li>
</ul>
<p>The following up steps in Vitis IDE are described in <a class="reference external" href="#monitoring-a-custom-target">Monitoring a Custom Target</a> Chapter.</p>
</div>
</div>
<div class="section" id="instrumenting-software">
<h2>Instrumenting Software<a class="headerlink" href="#instrumenting-software" title="Permalink to this headline">¶</a></h2>
<p>The processing system of Zynq-7000 devices and Zynq UltraScale+ MPSoCs have built-in modules to monitor the characteristics like processor utilization, CPU instructions per cycle, L1 cache miss rate, L1 data cache access per ms, CPU write stall cycle per instruction, and CPU read stall cycle per instructions. They are reported during live monitoring with any PS applications.</p>
<p>Monitoring function runtime, throughput, and latency are metrics to measure the software performance. They can be calculated using straightforward instrumentation available in the standalone BSP defined in the <strong>xtime_l.h</strong> header.</p>
<p>Insert a call to <code class="docutils literal notranslate"><span class="pre">XTime_GetTime()</span></code> before and after every benchmark. The difference between these two XTime values can be converted to seconds (or ms) using the <strong>COUNTS_PER_SECOND</strong> value provided in <code class="docutils literal notranslate"><span class="pre">xtime_l.h</span></code>. As the amount of data sent during any given benchmark is known, you can also calculate the achieved bandwidth and average latency during that particular benchmark.</p>
<p>Following is a sample instrumented C/C++ software code:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="c1"> </span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="c1"> </span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;xtime_l.h&quot;</span><span class="c1">	// XTime_GetTime()</span><span class="cp"></span>

<span class="c1">// Macros</span>
<span class="cp">#define TIMEDIFF(t1,t2)	(t2 - t1)</span>
<span class="cp">#define MILLISECONDS(t) (1000.0 * t / COUNTS_PER_SECOND)</span>

<span class="c1">// Globals</span>
<span class="n">XTime</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Start a test </span>
<span class="kt">void</span><span class="w"> </span><span class="nf">startTest</span><span class="p">()</span><span class="w"> </span>
<span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">XTime_GetTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">start</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// End a test </span>
<span class="kt">void</span><span class="w"> </span><span class="nf">endTest</span><span class="p">()</span><span class="w"> </span>
<span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">XTime_GetTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">time_curr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TIMEDIFF</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">msec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MILLISECONDS</span><span class="p">(</span><span class="n">time_curr</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Run-time = %.2f msec...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msec</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Achieved Bandwidth = (total bytes transferred) / (msec)</span>
<span class="w">    </span><span class="c1">// Average Latency = (msec) / (total memory accesses)</span>
<span class="p">}</span><span class="w"></span>
<span class="w"> </span>
<span class="c1">// Dummy test</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">runSomething</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="w"> </span>
<span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="n">time</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span>
<span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">startTest</span><span class="p">();</span><span class="w"> </span><span class="n">runSomething</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="n">endTest</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">startTest</span><span class="p">();</span><span class="w"> </span><span class="n">runSomething</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">endTest</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The software run time calculation is controlled by the application itself. The Vitis IDE would show a PS-related performance matrix from the <strong>Performance Analysis</strong> perspective. Check the steps in <a class="reference external" href="#monitoring-a-custom-target">Monitoring a Custom Target</a> to configure this. Function level software runtime can also be checked by profiling tools. Profiling is beyond the scope of this document. See the <em>Vitis Unified Platform Embedded Software Development Guide</em> <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/profileanalyze.html">UG1400</a> for more details.</p>
</div>
<div class="section" id="monitoring-a-custom-target">
<h2>Monitoring a Custom Target<a class="headerlink" href="#monitoring-a-custom-target" title="Permalink to this headline">¶</a></h2>
<p>The Vitis IDE provides the capability to monitor a running target, as well as controlling the ATG IP in the hardware design.</p>
<p>Prepare a platform project before running the performance analysis because the Vitis IDE must be able to understand your hardware setup. For more details about creating a platform project, see the <em>Vitis Unified Platform Embedded Software Development Guide</em> <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/profileanalyze.html">UG1400</a>.</p>
<ol class="simple">
<li><p>Select <strong>File -&gt; New -&gt; Platform Project</strong></p></li>
<li><p>Click <strong>Next</strong> in the welcome window.</p></li>
<li><p>Select the exported <strong>XSA</strong> from the Vivado IDE. Keep default settings of software specification and click <strong>Finish</strong>.</p></li>
<li><p>Click the hammer button to build the platform.</p></li>
</ol>
<p>If you need to instrument software, you have to create a software application project with the source code you created. If you don’t need to evaluate software performance, you can create a hello world application instead to create a hello_world application as a stub to create the Run Configurations with Performance Analysis functions.</p>
<p>The steps to use performance monitor and ATG in Vitis IDE are as follows:</p>
<ol>
<li><p>Right-click the software application project and select <strong>Run As → Run Configurations</strong>.</p>
<p><em>Figure 45:</em> <strong>Target Setup in Debug Configuration (Using Imported Hardware Platform Specification)</strong></p>
<p><img alt="../../../../_images/vitis_run_configuration.png" src="../../../../_images/vitis_run_configuration.png" /></p>
</li>
<li><p>Create the configuration by double-clicking <strong>Single Application Debug</strong>.</p></li>
<li><p>Enable <strong>Performance Analysis</strong> in the configuration as shown in the following figure.</p></li>
<li><p>Set the <strong>Performance Analysis Configuration</strong> and <strong>ATG Configuration</strong>, if required.</p>
<ul>
<li><p>Enable or disable APM by clicking <strong>Edit</strong> of Performance Analysis Configuration</p></li>
<li><p>Enable or disable your custom APM by clicking <strong>Edit</strong> button of Configure APM.</p>
<p><img alt="../../../../_images/vitis_performance_analysis_configuration.png" src="../../../../_images/vitis_performance_analysis_configuration.png" /></p>
<p>The APM instance name will show in the following list.</p>
<p><img alt="../../../../_images/vitis_apm.png" src="../../../../_images/vitis_apm.png" /></p>
</li>
<li><p>Set up the ATG by clicking <strong>Edit</strong> on the ATG Configuration</p>
<p><img alt="../../../../_images/vitis_atg_configuration.png" src="../../../../_images/vitis_atg_configuration.png" /></p>
</li>
</ul>
</li>
<li><p>Click <strong>Run</strong> to launch the run and see the performance analysis.</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="10-end-to-end-performance-analysis.html" class="btn btn-neutral float-right" title="End-To-End Performance Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="8-evaluating-memory-hierarchy-ACP.html" class="btn btn-neutral float-left" title="Evaluating Memory Hierarchy and the ACP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on October 27, 2021.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2019-2021, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>