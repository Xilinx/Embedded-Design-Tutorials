<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Boot and Configuration &mdash; Embedded Design Tutorials 2022.1 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Debugging Using the Vitis Software Platform" href="3-debugging.html" />
    <link rel="prev" title="Versal ACAP CIPS and NoC (DDR) IP Core Configuration" href="2-cips-noc-ip-config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Embedded Design Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Versal-EDT.html">Versal ACAP Embedded Design Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-getting-started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-cips-noc-ip-config.html">Versal ACAP CIPS and NoC (DDR) IP Core Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Boot and Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#system-software">System Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#platform-loader-and-manager">Platform Loader and Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="#u-boot">U-Boot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trusted-firmware-a">Trusted Firmware-A</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#generating-boot-image-for-standalone-application">Generating Boot Image for Standalone Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-petalinux-images-on-a-versal-board-using-jtag">Loading Petalinux Images on a Versal Board using JTAG</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-sd-boot-mode">Boot Sequence for SD-Boot Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-qspi-boot-mode">Boot Sequence for QSPI Boot Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-ospi-boot-mode">Boot Sequence for OSPI Boot Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-sequence-for-emmc-boot-mode">Boot Sequence for eMMC Boot Mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flashing-linux-images-to-the-emmc-flash">Flashing Linux Images to the eMMC Flash</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3-debugging.html">Debugging Using the Vitis Software Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-system-design-example.html">System Design Example using Scalar Engine and Adaptable Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-system-design-example-HSDP.html">System Design Example for High-Speed Debug Port (HSDP) with SmartLynq+ Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="A-creating-plm.html">Appendix: Creating the PLM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ZynqMPSoC-EDT/ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC Embedded Design Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 Embedded Design Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Feature Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">First Stage Boot Loader (FSBL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/sw-profiling/sw-profiling.html">Profiling Applications with System Debugger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Design_Tutorials/MPSoC_Graphic_Subsystem/README.html">Example Setup for a Graphics and DisplayPort Based Sub-System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debugging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis Embedded Software Debugging Guide (UG1515) 2021.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/SPA-UG/SPA-UG.html">System Performance Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../User_Guides/Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone Benchmark</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Previous Releases</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2020.2/docs/index.html">2020.2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Embedded Design Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Versal-EDT.html">Versal ACAP Embedded Design Tutorial</a> &raquo;</li>
      <li>Boot and Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Introduction/Versal-EDT/docs/4-boot-and-config.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="boot-and-configuration">
<h1>Boot and Configuration<a class="headerlink" href="#boot-and-configuration" title="Permalink to this heading">¶</a></h1>
<p>The purpose of this chapter is to show how to integrate and load boot loaders, bare-metal applications (For APU/RPU), and the Linux Operating System for a Versal® ACAP. This chapter discusses the following topics:</p>
<ul class="simple">
<li><p>System software: PLM, Trusted firmware-A (TF-A), U-Boot</p></li>
<li><p>Steps to generate boot image for standalone application.</p></li>
<li><p>Boot sequences for SD boot, and QSPI and OSPI boot modes.</p></li>
</ul>
<p>You can achieve these configurations using the Vitis™ software platform and the PetaLinux tool flow. While <a class="reference internal" href="2-cips-noc-ip-config.html"><span class="doc">Versal ACAP CIPS and NoC (DDR) IP Core Configuration</span></a> focused only on creating software blocks for each processing unit in the PS, this chapter explains how these blocks can be loaded as a part of a larger system.</p>
<section id="system-software">
<h2>System Software<a class="headerlink" href="#system-software" title="Permalink to this heading">¶</a></h2>
<p>The following system software blocks cover most of the boot and configuration for this chapter.</p>
<section id="platform-loader-and-manager">
<h3>Platform Loader and Manager<a class="headerlink" href="#platform-loader-and-manager" title="Permalink to this heading">¶</a></h3>
<p>The platform loader and manager (PLM) is the software that runs on one of the dedicated processors in the Platform Management Controller (PMC) block of the Versal ACAP. It is responsible for boot and run time management, including platform management, error management, partial reconfiguration, and subsystem restart of the device. The PLM can reload images, and load partial PDIs and service interrupts. The PLM reads the programmable device image from the boot source and configures the components of the system, including the NoC initialization, DDR memory initialization, programmable logic, and processing system, and then completes the device boot.</p>
</section>
<section id="u-boot">
<h3>U-Boot<a class="headerlink" href="#u-boot" title="Permalink to this heading">¶</a></h3>
<p>U-Boot acts as a secondary boot loader. After the PLM handoff, U-Boot loads Linux onto the Arm A72 APU and configures the rest of the peripherals in the processing system based on the board configuration. U-Boot can fetch images from various memory sources like eMMC, SATA, TFTP, SD, and QSPI. U-Boot can be configured and built using the PetaLinux tool flow.</p>
</section>
<section id="trusted-firmware-a">
<h3>Trusted Firmware-A<a class="headerlink" href="#trusted-firmware-a" title="Permalink to this heading">¶</a></h3>
<p>The Trusted Firmware-A (ATF) is a transparent bare-metal application layer executed in Exception Level 3 (EL3) on the APU. The ATF includes a Secure Monitor layer for switching between the secure and the non-secure world. The Secure Monitor calls and implementation of Trusted Board Boot Requirements (TBBR) makes the ATF layer a mandatory requirement to load Linux on the APU on Versal ACAP. The PLM loads the ATF to be executed by the APU, which keeps running in EL3 awaiting a service request. The PLM also loads U-Boot into the DDR memory to be executed by the APU. The DDR memory loads the Linux OS in the SMP mode on the APU. The ATF (<cite>bl31.elf</cite>) is built, by default, in PetaLinux. You can find it in the PetaLinux project images directory.</p>
</section>
</section>
<section id="generating-boot-image-for-standalone-application">
<span id="id1"></span><h2>Generating Boot Image for Standalone Application<a class="headerlink" href="#generating-boot-image-for-standalone-application" title="Permalink to this heading">¶</a></h2>
<p>The Vitis software platform supports boot image creation wizard for Versal ACAP. To generate a boot image PDI or <code class="docutils literal notranslate"><span class="pre">Boot.bin</span></code>, you can either use Bootgen command line options or use the wizard in Vitis. This tutorial shows how to create Boot image using Bootgen, which is released as a part of the Vitis software platform package. The primary function of Bootgen is to integrate the various partitions of the bootable image. Bootgen uses a BIF file (Bootgen Image Format) as an input and generates a single file image in binary BIN or PDI format. It outputs a single file image which can be loaded into non-volatile memory (QSPI or SD card). Use the following steps to generate a PDI/BIN file:</p>
<ol class="arabic">
<li><p>Open the XSCT Console view in the Vitis IDE, if not already open, by clicking on <strong>Window → Show View</strong>. Type <cite>xsct console</cite> within the search bar of the Show View wizard. Click <strong>Open</strong> to open the console.</p>
<img alt="../../../../_images/image49.png" src="../../../../_images/image49.png" />
</li>
<li><p>Create a folder where you want to generate the boot image by typing the following command in the XSCT Console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">bootimages</span>
<span class="n">cd</span> <span class="n">bootimages</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>Copy the sd_boot.bif file present within the <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;board-name&gt;/ready_to_test/qspi_images/standalone/&lt;cips</span> <span class="pre">or</span> <span class="pre">cips_noc&gt;/&lt;apu</span> <span class="pre">or</span> <span class="pre">rpu&gt;/</span></code> directory, the PDI file present within <code class="docutils literal notranslate"><span class="pre">&lt;Vitis</span> <span class="pre">platform</span> <span class="pre">project&gt;/hw/&lt;.pdi-file&gt;</span></code>, and the application elf files present within the <code class="docutils literal notranslate"><span class="pre">&lt;Vitis</span> <span class="pre">application-project&gt;/Debug</span></code> folder to the folder created in step 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If needed, open the <cite>sd_boot.bif</cite> file in a text editor of your choice and modify the name of the PDI or elfs as per your Vitis projects.</p>
</div>
</li>
<li><p>Run the following command in the XSCT Console view.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bootgen</span> <span class="o">-</span><span class="n">image</span> <span class="o">&lt;</span><span class="n">bif</span> <span class="n">filename</span><span class="o">&gt;.</span><span class="n">bif</span> <span class="o">-</span><span class="n">arch</span> <span class="n">versal</span> <span class="o">-</span><span class="n">o</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span>
</pre></div>
</div>
<p>The following log is displayed in the XSCT Console view.</p>
<img alt="../../../../_images/image51.jpeg" src="../../../../_images/image51.jpeg" />
</li>
</ol>
</section>
<section id="loading-petalinux-images-on-a-versal-board-using-jtag">
<h2>Loading Petalinux Images on a Versal Board using JTAG<a class="headerlink" href="#loading-petalinux-images-on-a-versal-board-using-jtag" title="Permalink to this heading">¶</a></h2>
<p>This section describes how to load Versal Petalinux images using JTAG mode on the Versal board.</p>
<ol class="arabic">
<li><p>Build the Linux images using the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-build
</pre></div>
</div>
</li>
<li><p>Build the BOOT.BIN using the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-package --boot --uboot
</pre></div>
</div>
</li>
<li><p>Create the Tcl script using <cite>petalinux</cite> command from the Versal project directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$petalinux-boot --jtag --kernel --tcl versal.tcl
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">versal.tcl</span></code> file includes commands to select appropriate targets and download application files to required locations in the DDR memory.</p>
<img alt="../../../../_images/versal_tcl.JPG" src="../../../../_images/versal_tcl.JPG" />
</div>
</li>
<li><p>Modify the generated <cite>versal.tcl</cite> file as follows:</p>
<ol class="loweralpha">
<li><p>Rename <cite>ramdisk.cpio.gz</cite> to <cite>rootfs.cpio.gz.u-boot</cite> as this tutorial uses the <cite>rootfs</cite> image.</p></li>
<li><p>Add the following lines to load <cite>BOOT.BIN</cite> to the DDR memory before the <cite>con</cite> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">puts</span> <span class="n">stderr</span> <span class="s2">&quot;INFO: Loading image: BOOT.BIN at 0x70000000&quot;</span>
<span class="n">dow</span> <span class="o">-</span><span class="n">data</span> <span class="o">-</span><span class="n">force</span> <span class="s2">&quot;BOOT.BIN&quot;</span> <span class="mh">0x70000000</span>
<span class="n">after</span> <span class="mi">2000</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Set the boot mode switch SW1 to ON-ON-ON-ON JTAG boot mode, as shown in the following figure.</p>
<a class="reference internal image-reference" href="../../../../_images/jtag-boot-mode.png"><img alt="../../../../_images/jtag-boot-mode.png" src="../../../../_images/jtag-boot-mode.png" style="width: 500px;" /></a>
</li>
<li><p>Configure the Tera Term serial application with default serial settings <strong>115200,N8</strong> and open the Tera Term console.</p></li>
<li><p>In the XSCT console, connect to the target over JTAG using the <cite>connect</cite> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">connect</span>
</pre></div>
</div>
<p>The connect command returns the channel ID of the connection.</p>
</li>
<li><p>Run the following target command to list the available targets and select a target using its ID.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span>
</pre></div>
</div>
<p>The IDs can change from session to session as the targets are assigned IDs as they are discovered on the JTAG chain.</p>
</li>
<li><p>Download the <cite>versal.tcl</cite> file which will load the <cite>BOOT.BIN</cite>, <cite>rootfs.cpio.gz.uboot</cite>, and <cite>boot.scr</cite> images on the DDR memory of the VCK190 board using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span> <span class="mi">1</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">rst</span>
<span class="n">xsct</span> <span class="o">&gt;</span> <span class="n">source</span> <span class="n">versal</span><span class="o">.</span><span class="n">tcl</span>
</pre></div>
</div>
</li>
<li><p>After running the preceding commands, you can see the PLM and U-Boot boot logs on the serial console. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">U</span><span class="o">-</span><span class="n">Boot</span> <span class="mf">2022.01</span> <span class="p">(</span><span class="n">Feb</span> <span class="mi">16</span> <span class="mi">2022</span> <span class="o">-</span> <span class="mi">14</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">10</span> <span class="o">+</span><span class="mi">0000</span><span class="p">)</span>

<span class="n">CPU</span><span class="p">:</span>   <span class="n">Versal</span>
<span class="n">Silicon</span><span class="p">:</span> <span class="n">v2</span>
<span class="n">Model</span><span class="p">:</span> <span class="n">Xilinx</span> <span class="n">Versal</span> <span class="n">vck190</span> <span class="n">Eval</span> <span class="n">board</span> <span class="n">revA</span>
<span class="n">DRAM</span><span class="p">:</span>  <span class="mi">8</span> <span class="n">GiB</span>
<span class="n">EL</span> <span class="n">Level</span><span class="p">:</span>       <span class="n">EL2</span>
<span class="n">MMC</span><span class="p">:</span>   <span class="n">mmc</span><span class="nd">@f1050000</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Loading</span> <span class="n">Environment</span> <span class="kn">from</span> <span class="nn">nowhere...</span> <span class="n">OK</span>
<span class="n">In</span><span class="p">:</span>    <span class="n">serial</span><span class="nd">@ff000000</span>
<span class="n">Out</span><span class="p">:</span>   <span class="n">serial</span><span class="nd">@ff000000</span>
<span class="n">Err</span><span class="p">:</span>   <span class="n">serial</span><span class="nd">@ff000000</span>
<span class="n">Bootmode</span><span class="p">:</span> <span class="n">JTAG_MODE</span>
<span class="n">Net</span><span class="p">:</span>
<span class="n">ZYNQ</span> <span class="n">GEM</span><span class="p">:</span> <span class="n">ff0c0000</span><span class="p">,</span> <span class="n">mdio</span> <span class="n">bus</span> <span class="n">ff0c0000</span><span class="p">,</span> <span class="n">phyaddr</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interface</span> <span class="n">rgmii</span><span class="o">-</span><span class="nb">id</span>
<span class="n">zynq_gem</span> <span class="n">ethernet</span><span class="nd">@ff0c0000</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">eth</span> <span class="n">PHY</span> <span class="nb">id</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span>

<span class="ne">Warning</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0c0000</span> <span class="p">(</span><span class="n">eth0</span><span class="p">)</span> <span class="n">using</span> <span class="n">random</span> <span class="n">MAC</span> <span class="n">address</span> <span class="o">-</span> <span class="n">fe</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="n">f4</span><span class="p">:</span><span class="mi">77</span><span class="p">:</span><span class="mi">5</span><span class="n">c</span><span class="p">:</span><span class="n">c7</span>
<span class="n">eth0</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0c0000</span>
<span class="n">ZYNQ</span> <span class="n">GEM</span><span class="p">:</span> <span class="n">ff0d0000</span><span class="p">,</span> <span class="n">mdio</span> <span class="n">bus</span> <span class="n">ff0c0000</span><span class="p">,</span> <span class="n">phyaddr</span> <span class="mi">2</span><span class="p">,</span> <span class="n">interface</span> <span class="n">rgmii</span><span class="o">-</span><span class="nb">id</span>
<span class="n">zynq_gem</span> <span class="n">ethernet</span><span class="nd">@ff0d0000</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">read</span> <span class="n">eth</span> <span class="n">PHY</span> <span class="nb">id</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span>

<span class="ne">Warning</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0d0000</span> <span class="p">(</span><span class="n">eth1</span><span class="p">)</span> <span class="n">using</span> <span class="n">random</span> <span class="n">MAC</span> <span class="n">address</span> <span class="o">-</span> <span class="n">c6</span><span class="p">:</span><span class="n">e7</span><span class="p">:</span><span class="n">dd</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b1</span><span class="p">:</span><span class="mi">05</span>
<span class="p">,</span> <span class="n">eth1</span><span class="p">:</span> <span class="n">ethernet</span><span class="nd">@ff0d0000</span>
 <span class="n">Hit</span> <span class="nb">any</span> <span class="n">key</span> <span class="n">to</span> <span class="n">stop</span> <span class="n">autoboot</span><span class="p">:</span>  <span class="mi">5</span>  <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">0</span>
 <span class="n">Versal</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="boot-sequence-for-sd-boot-mode">
<span id="boot-sequence-sd-boot-mode"></span><h2>Boot Sequence for SD-Boot Mode<a class="headerlink" href="#boot-sequence-for-sd-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>The following steps demonstrate the boot sequence for the SD-boot mode.</p>
<ol class="arabic">
<li><p>To verify the image, copy the required images to the SD card:</p>
<ul class="simple">
<li><p>For standalone, copy the <cite>BOOT.BIN</cite> to the SD card.</p></li>
<li><p>For Linux images, navigate to the <cite>&lt;plnx-proj-root&gt;/images/linux</cite> and copy <cite>BOOT.BIN</cite>, Image, <cite>rootfs.cpio.gz.uboot</cite>, <cite>boot.scr</cite> to the SD card.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can either boot the VCK190/VMK180 board using the ready-to-test images as part of the released package path, <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;vck190</span> <span class="pre">or</span> <span class="pre">vmk180&gt;/ready_to_test/qspi_images/linux/</span></code>, or refer to <a class="reference internal" href="5-system-design-example.html#creating-linux-images-using-petalinux"><span class="std std-ref">Example Project: Creating Linux Images Using PetaLinux</span></a> to build your own set of Linux images using the PetaLinux tool.</p>
</div>
</li>
<li><p>Load the SD card into the VMK180/VCK190 board in the J302 connector.</p></li>
<li><p>Connect the Micro USB cable into the VMK180/VCK190 Board Micro USB port (J207), and the other end into an open USB port on the host machine.</p></li>
<li><p>Configure the board to boot in SD-Boot mode (1-ON, 2-OFF, 3-OFF, 4-OFF) by setting the SW1 switch as shown in the following figure.</p>
<img alt="../../../../_images/sd_boot_mode.JPG" src="../../../../_images/sd_boot_mode.JPG" />
</li>
<li><p>Connect 12V power to the VMK180/VCK190 6-Pin Molex connector.</p></li>
<li><p>Start a terminal session using Tera Term or Minicom depending on the host machine being used. Set the COM port and baud rate for your system, as shown in the following figure.</p>
<img alt="../../../../_images/image46.png" src="../../../../_images/image46.png" />
</li>
<li><p>For port settings, verify COM Port in the device manager and select the com port with interface-0.</p></li>
<li><p>Turn on the VMK180/VCK190 board using the power switch (SW13).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Logs for standalone images are displayed on the terminal. For Linux images, you can log in using <cite>user: root</cite> and <cite>pw: root</cite> after the boot-up sequence on the terminal. After that, run <cite>gpiotest</cite> on the terminal. You will see logs as shown in the following figure.</p>
</div>
<img alt="../../../../_images/led_example_console_prints.PNG" src="../../../../_images/led_example_console_prints.PNG" />
</li>
</ol>
</section>
<section id="boot-sequence-for-qspi-boot-mode">
<h2>Boot Sequence for QSPI Boot Mode<a class="headerlink" href="#boot-sequence-for-qspi-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>This section demonstrates the boot sequence for the QSPI boot mode. For this, you need to connect a QSPI daughter card (part number: X_EBM-01, REV_A01) as shown in the following figure:</p>
<p><em>Figure 2:</em> <strong>Daughter Card on VCK190</strong></p>
<a class="reference internal image-reference" href="../../../../_images/vck190_production_board_QSPI_daughter_card.jpg"><img alt="../../../../_images/vck190_production_board_QSPI_daughter_card.jpg" src="../../../../_images/vck190_production_board_QSPI_daughter_card.jpg" style="width: 600px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For standalone, copy the BOOT.BIN to the SD card. For Linux images, you can either boot the VCK190/VMK180 board using the ready-to-test images as part of the released package path, <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;vck190</span> <span class="pre">or</span> <span class="pre">vmk180&gt;/ready_to_test/qspi_images/linux/</span></code>, or refer to <a class="reference internal" href="5-system-design-example.html#creating-linux-images-using-petalinux"><span class="std std-ref">Example Project: Creating Linux Images Using PetaLinux</span></a> to build your own set of Linux images using the PetaLinux tool.</p>
</div>
<p>You need to flash the images to the daughter card using the following steps:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following steps use the SD boot mode to load an image to indirectly program the QSPI Flash.</p>
</div>
<ol class="arabic">
<li><p>With the card powered off, install the QSPI daughter card.</p></li>
<li><p>Power on the board. Refer to section Loading Petalinux images on Veral Board using JTAG on how to load images on the DDR memory over JTAG.</p></li>
<li><p>At the U-Boot stage, when the message <strong>Hit any key to stop autoboot:</strong> appears, hit any key, then run the following commands to flash the images on the QSPI daughter card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">check</span> <span class="n">QSPI</span> <span class="ow">is</span> <span class="n">available</span> <span class="ow">or</span> <span class="ow">not</span>
<span class="n">sf</span> <span class="n">probe</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">//</span> <span class="n">Erase</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">256</span> <span class="n">MB</span>
<span class="n">sf</span> <span class="n">erase</span> <span class="mh">0x0</span> <span class="mh">0x10000000</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x70000000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x0</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x70000000</span> <span class="mh">0x0</span> <span class="o">&lt;</span><span class="n">BOOT</span><span class="o">.</span><span class="n">BIN_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">Image</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x00200000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0xF00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x00200000</span> <span class="mh">0xF00000</span> <span class="o">&lt;</span><span class="n">Image_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x04000000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x2E00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x04000000</span> <span class="mh">0x2E00000</span> <span class="o">&lt;</span><span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x20000000</span>  <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x7F80000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x20000000</span> <span class="mh">0x7F80000</span> <span class="o">&lt;</span><span class="n">boot</span><span class="o">.</span><span class="n">scr_filesize_in_hex</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>After flashing the images, turn off the power switch on the board, and change the SW1 boot mode pin settings to QSPI boot mode (ON-OFF-ON-ON, M[0:3] = 0100) as shown in the following figure:</p>
<a class="reference internal image-reference" href="../../../../_images/image52.png"><img alt="../../../../_images/image52.png" src="../../../../_images/image52.png" style="width: 600px;" /></a>
</li>
<li><p>Power cycle the board. The board now boots up using the images in the QSPI flash.</p></li>
</ol>
</section>
<section id="boot-sequence-for-ospi-boot-mode">
<h2>Boot Sequence for OSPI Boot Mode<a class="headerlink" href="#boot-sequence-for-ospi-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>To configure the design for the OSPI boot mode, see OSPI Boot Mode Configuration. This section demonstrates the boot sequence for the OSPI boot mode. For this, you need to connect an OSPI daughter card (part number X-EBM-03 REV_A02) as shown in the following figure:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OSPI daughter card is not provided with the VCK190 Kit.</p>
</div>
<a class="reference internal image-reference" href="../../../../_images/X-EBM-03_OSPI_Daughter_card.jpg"><img alt="../../../../_images/X-EBM-03_OSPI_Daughter_card.jpg" src="../../../../_images/X-EBM-03_OSPI_Daughter_card.jpg" style="width: 600px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For standalone, copy the <cite>BOOT.BIN</cite> to the SD card. For Linux images, you can either boot the VCK190 or VMK180 board using the ready-to-test images as part of the released package path, <code class="docutils literal notranslate"><span class="pre">&lt;design-package&gt;/&lt;vck190</span> <span class="pre">or</span> <span class="pre">vmk180&gt;/ready_to_test/ospi_images/linux</span></code>, or refer to <a class="reference internal" href="5-system-design-example.html#creating-linux-images-using-petalinux"><span class="std std-ref">Example Project: Creating Linux Images Using PetaLinux</span></a> to build your own set of Linux images using the PetaLinux tool.</p>
</div>
<p>To flash the images to the daughter card, use the following steps:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following steps use the SD boot mode to load an image to indirectly program the OSPI Flash.</p>
</div>
<ol class="arabic">
<li><p>With the card powered off, install the OSPI daughter card.</p></li>
<li><p>Power on the board. Refer to section Loading Petalinux images on Veral Board using JTAG on how to load images on the DDR memory over JTAG.</p></li>
<li><p>At the U-Boot stage, when the message <strong>Hit any key to stop autoboot:</strong> appears, hit any key, then run the following commands to flash the images on the OSPI daughter card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Check</span> <span class="k">if</span> <span class="n">OSPI</span> <span class="n">flash</span> <span class="ow">is</span> <span class="n">available</span> <span class="ow">or</span> <span class="ow">not</span>
<span class="n">sf</span> <span class="n">probe</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">//</span> <span class="n">Erase</span> <span class="n">the</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">256</span> <span class="n">MB</span>
<span class="n">sf</span> <span class="n">erase</span> <span class="mh">0x0</span> <span class="mh">0x10000000</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x70000000</span> <span class="n">to</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x0</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x70000000</span> <span class="mh">0x0</span> <span class="o">&lt;</span><span class="n">BOOT</span><span class="o">.</span><span class="n">BIN_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">Image</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x00200000</span> <span class="n">to</span> <span class="n">QSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0xF00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x00200000</span> <span class="mh">0xF00000</span> <span class="o">&lt;</span><span class="n">Image_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x04000000</span> <span class="n">to</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x2E00000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x04000000</span> <span class="mh">0x2E00000</span> <span class="o">&lt;</span><span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot_filesize_in_hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">Copy</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x20000000</span> <span class="n">to</span> <span class="n">OSPI</span> <span class="n">Flash</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x7F80000</span>
<span class="n">sf</span> <span class="n">write</span> <span class="mh">0x20000000</span> <span class="mh">0x7F80000</span> <span class="o">&lt;</span><span class="n">boot</span><span class="o">.</span><span class="n">scr_filesize_in_hex</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>After flashing the images, turn off the power switch on the board.</p></li>
<li><p>Change the SW1 boot mode pin settings to OSPI boot mode, that is, MODE[0:3] pins = 0001, ON-ON-ON-OFF.</p></li>
<li><p>Power cycle the board. The board now boots up using the images in the OSPI flash.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the VMK180 production board, OSPI images are not provided as part of the design package. Only VCK190 OSPI images are shared as part of the design package.</p>
</div>
</section>
<section id="boot-sequence-for-emmc-boot-mode">
<h2>Boot Sequence for eMMC Boot Mode<a class="headerlink" href="#boot-sequence-for-emmc-boot-mode" title="Permalink to this heading">¶</a></h2>
<p>To configure the design for the eMMC boot mode, see eMMC Boot Mode Configuration. This section demonstrates the boot sequence for the eMMC boot mode. For this, you need to connect an eMMC daughter card (part number X-EBM-02, REV_A02) as shown in the following figure:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The eMMC daughter card is not provided with the VCK190 Kit.</p>
</div>
<a class="reference internal image-reference" href="../../../../_images/X-EBM-02_emmc_Daughter_card.jpg"><img alt="../../../../_images/X-EBM-02_emmc_Daughter_card.jpg" src="../../../../_images/X-EBM-02_emmc_Daughter_card.jpg" style="width: 600px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For standalone, copy the BOOT.BIN to the SD card. For Linux images, you can either boot the VCK190 or vmk180 board using the ready-to-test images as part of the released package path, <code class="docutils literal notranslate"><span class="pre">&lt;designpackage&gt;/&lt;vck190</span> <span class="pre">or</span> <span class="pre">YAML_DT_BOARD_FLAGS_vmk180&gt;/ready_to_test/emmc_images/linux</span></code>, or refer to <a class="reference internal" href="5-system-design-example.html#creating-linux-images-using-petalinux"><span class="std std-ref">Example Project: Creating Linux Images Using PetaLinux</span></a> to build your own set of Linux images using the PetaLinux tool.</p>
</div>
<p>To format the eMMC flash on the Versal ACAP board for the first time, use the following steps:</p>
<ol class="arabic">
<li><p>With the card powered off, install the eMMC daughter card.</p></li>
<li><p>Set the boot mode switch SW1 to ON-ON-ON-ON JTAG Boot mode, as shown in the following figure.</p>
<a class="reference internal image-reference" href="../../../../_images/vck190_jtag_boot_mode_sw1_settings.png"><img alt="../../../../_images/vck190_jtag_boot_mode_sw1_settings.png" src="../../../../_images/vck190_jtag_boot_mode_sw1_settings.png" style="width: 500px;" /></a>
<p>This example uses the XSCT console to download a BOOT image file (BOOT.BIN). It uses the U-Boot console to load Linux images to format the eMMC flash.</p>
</li>
<li><p>Ensure that the Ethernet cable is connected from the host to the board. Set up dhcp and tftpb server on the host.</p></li>
<li><p>Copy the Linux images <cite>BOOT.BIN</cite>, Image, <cite>rootfs.cpio.gz.u-boot</cite>, and <cite>boot.scr</cite> to host tftp home directory.</p></li>
<li><p>In the XSCT console, connect to the target over JTAG using the <cite>connect</cite> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">connect</span>
</pre></div>
</div>
<p>The connect command returns the channel ID of the connection.</p>
</li>
<li><p>Run the <cite>target</cite> command to list the available targets and to select a target using its ID. The targets are assigned IDs as they are discovered on the JTAG chain, so the IDs can change from session to session.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span>
</pre></div>
</div>
</li>
<li><p>Download the BOOT.BIN on the VCK190 board using the following commands to get the U-Boot console.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span> <span class="mi">1</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">rst</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">device</span> <span class="n">program</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span>
</pre></div>
</div>
<p>After executing this command, you can see the PLM and U-Boot boot logs on the serial console.</p>
</li>
<li><p>At the U-Boot stage, when the message <strong>“Hit any key to stop autoboot:”</strong> appears, hit any key, then run the following commands to flash the images on the eMMC daughter card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dhcp</span>
<span class="n">tftpboot</span> <span class="mh">0x80000</span> <span class="n">Image</span>
<span class="n">tftpboot</span> <span class="mh">0x2000000</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span>
<span class="n">booti</span> <span class="mh">0x80000</span> <span class="mh">0x2000000</span> <span class="mh">0x1000</span>
</pre></div>
</div>
<p>After executing the previous U-Boot commands, Linux starts booting and stops at Linux console prompt waiting for user input commands.</p>
</li>
<li><p>Run the following commands from the Linux console prompt to create the eMMC Linux bootable partition and format the eMMC with FAT32 file system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>xilinx-vck190-20221:~$ fdisk /dev/mmcblk0
The number of cylinders for this disk is set to 233472.
There is nothing wrong with that, but this is larger than 1024,
and could in certain setups cause problems with:
1) software that runs at boot time (e.g., old versions of LILO)
2) booting and partitioning software from other OSs
(e.g., DOS FDISK, OS/2 FDISK)

Command (m for help): m
Command Action
a       toggle a bootable flag
b       edit bsd disklabel
c       toggle the dos compatibility flag
d       delete a partition
l       list known partition types
n       add a new partition
o       create a new empty DOS partition table
p       print the partition table
q       quit without saving changes
s       create a new empty Sun disklabel
t       change a partition&#39;s system id
u       change display/entry units
v       verify the partition table
w       write table to disk and exit

Command (m for help): n
Partition type
p   primary partition (1-4)
e   extended
p
Partition number (1-4): 1
First sector (16-14942207, default 16):
Using default value 16
Last sector or +size{,K,M,G,T} (16-14942207, default 14942207):
Using default value 14942207

Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table
fdisk: WARNING: rereading partition table failed, kernel still uses old table: Device or resource busy

xilinx-vck190-20221:~$ mkfs.vfat -F 32 -n boot /dev/mmcblk0p1
</pre></div>
</div>
<p>eMMC flash is formatted with the FAT32 filesystem.</p>
</li>
</ol>
<section id="flashing-linux-images-to-the-emmc-flash">
<h3>Flashing Linux Images to the eMMC Flash<a class="headerlink" href="#flashing-linux-images-to-the-emmc-flash" title="Permalink to this heading">¶</a></h3>
<p>To flash the Linux images to the eMMC Flash, use the following steps:</p>
<ol class="arabic">
<li><p>With the card powered off, install the eMMC daughter card.</p></li>
<li><p>Set the boot mode switch SW1 to ON-ON-ON-ON JTAG Boot mode.</p></li>
<li><p>Power on the board. Refer to <a class="reference external" href="#loading-petalinux-images-on-a-versal-board-using-jtag">Loading Petalinux Images on a Versal Board using JTAG</a> on how to load images on the DDR memory over JTAG.</p></li>
<li><p>At the U-Boot stage, when the message <strong>Hit any key to stop autoboot:</strong> appears, hit any key, then run the following commands to flash the images on the eMMC daughter card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Check</span> <span class="n">emmc</span> <span class="ow">is</span>  <span class="n">FAT</span> <span class="n">filesystem</span> <span class="n">formatted</span> <span class="ow">or</span> <span class="ow">not</span><span class="o">.</span>
<span class="n">fatls</span> <span class="n">mmc</span> <span class="mi">0</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x70000000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x70000000</span> <span class="n">BOOT</span><span class="o">.</span><span class="n">BIN</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">Image</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x00200000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x00200000</span> <span class="n">Image</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span><span class="mh">0x04000000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x04000000</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">cpio</span><span class="o">.</span><span class="n">gz</span><span class="o">.</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
<span class="o">//</span> <span class="n">copy</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="n">file</span> <span class="kn">from</span> <span class="nn">DDR</span> <span class="n">address</span><span class="p">,</span> <span class="mh">0x20000000</span> <span class="n">to</span> <span class="n">emmc</span>
<span class="n">fatwrite</span> <span class="n">mmc</span> <span class="mi">0</span> <span class="mh">0x20000000</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="o">&lt;</span><span class="n">size</span> <span class="ow">in</span> <span class="nb">hex</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>After flashing the images, turn off the power switch on the board, and change the SW1 boot mode pin settings to eMMC boot mode, ON-OFF-OFF-ON (MODE[0:3]= 0110).</p></li>
<li><p>Power cycle the board. The board now boots up using the images in the eMMC flash.</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2-cips-noc-ip-config.html" class="btn btn-neutral float-left" title="Versal ACAP CIPS and NoC (DDR) IP Core Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="3-debugging.html" class="btn btn-neutral float-right" title="Debugging Using the Vitis Software Platform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on July 29, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>