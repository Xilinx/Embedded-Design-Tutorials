<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Monitor Framework &mdash; Embedded Design Tutorials 2022.1 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Getting Started with SPM" href="4-getting-started-with-SPM.html" />
    <link rel="prev" title="System Performance Modeling Project" href="2-system-performance-modeling-project.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Embedded Design Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction/Versal-EDT/Versal-EDT.html">Versal ACAP Embedded Design Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction/ZynqMPSoC-EDT/ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC Embedded Design Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction/Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 Embedded Design Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Feature Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">First Stage Boot Loader (FSBL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Feature_Tutorials/sw-profiling/sw-profiling.html">Profiling Applications with System Debugger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Design_Tutorials/MPSoC_Graphic_Subsystem/README.html">Example Setup for a Graphics and DisplayPort Based Sub-System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debugging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis Embedded Software Debugging Guide (UG1515) 2021.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../SPA-UG.html">System Performance Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-system-performance-modeling-project.html">System Performance Modeling Project</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Monitor Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pl-profile-counters">PL Profile Counters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ps-profile-counters">PS Profile Counters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#host-target-communication">Host-Target Communication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="4-getting-started-with-SPM.html">Getting Started with SPM</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-evaluating-software-performance.html">Evaluating Software Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-evaluating-high-performance-ports.html">Evaluating High-Performance Ports</a></li>
<li class="toctree-l2"><a class="reference internal" href="7-evaluating-DDR-controller-settings.html">Evaluating DDR Controller Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="8-evaluating-memory-hierarchy-ACP.html">Evaluating Memory Hierarchy and the ACP</a></li>
<li class="toctree-l2"><a class="reference internal" href="9-using-spa-with-custom-target.html">Using SPA with a Custom Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-end-to-end-performance-analysis.html">End-To-End Performance Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="A-performance-checklist.html">Appendix: Performance Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SPA-UG.html#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone Benchmark</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Previous Releases</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2021.1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/docs/2020.2/build/html/index.html">2020.2</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Embedded Design Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../SPA-UG.html">System Performance Analysis</a> &raquo;</li>
      <li>Monitor Framework</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/User_Guides/SPA-UG/docs/3-monitor-framework.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="monitor-framework">
<h1>Monitor Framework<a class="headerlink" href="#monitor-framework" title="Permalink to this heading">¶</a></h1>
<p>The performance analysis toolbox in the Vitis™ IDE offers a set of system-level performance measurements. For a design that targets SoCs, this includes performance metrics from both the Programmable Logic (PL) and the Processing System (PS).</p>
<p>The PL performance metrics include the following:</p>
<ul class="simple">
<li><p><strong>(Write/Read) Transactions:</strong> Number of AXI transactions</p></li>
<li><p><strong>(Write/Read) Throughput:</strong> Write or read bandwidth in MB/s</p></li>
<li><p><strong>Average (Write/Read) Latency:</strong> Average write or read latency of AXI transactions The PS performance metrics include the following:</p>
<ul>
<li><p><strong>CPU Utilization (%):</strong> Percentage of non-idling CPU clock cycles</p></li>
<li><p><strong>CPU Instructions Per Cycle (IPC) :</strong> Estimated number of executed
instructions per cycle</p></li>
<li><p><strong>L1 Data Cache Access and Miss Rate (%) :</strong> Number of L1 data cache
accesses and the miss rate</p></li>
<li><p><strong>CPU (Write/Read) Stall Cycles Per Instruction :</strong> Estimated number
of stall cycles per instruction due to memory writes (write) and
data cache refills (read)</p></li>
</ul>
</li>
</ul>
<p>This mix of performance metrics is gathered from different parts of the target and combined into a common timeline and display, enabling system-level performance analysis. In order to gather and display these metrics, the Vitis IDE includes a monitor framework that accesses various profile counters across a target system, as well as a host-target communication framework to perform the sampling and offloading of these counters.</p>
<p>The metadata required by the Vitis IDE to perform this monitoring is exported by Vivado® Design Suite and read by the Vitis IDE when a Hardware Platform Specification project is created. While this export/import procedure has already been performed for the System Performance Modeling (SPM) project, it can also be executed on your design (see Instrumenting Hardware). In other words, all of the monitoring and analysis described herein is available and applicable to the SPM design as well as your design. This extension is addressed in <a class="reference internal" href="10-end-to-end-performance-analysis.html"><span class="doc">End-To-End Performance Analysis</span></a>.</p>
<section id="pl-profile-counters">
<h2>PL Profile Counters<a class="headerlink" href="#pl-profile-counters" title="Permalink to this heading">¶</a></h2>
<p>An AXI Performance Monitor (APM) inserted into a design provides the PL profile counters (see <a class="reference external" href="../docs/9-using-spa-with-custom-target.md#instrumenting-hardware">Instrumenting Hardware</a> for information about how to do this insertion for your design). There are six counters per connected AXI interface. The following table lists how these counters are used. Note that these are incrementing up-counters that capture a running total of bytes transferred, total latency, and the number of completed AXI transactions, respectively. As shown in the following table, the difference of these counters between successive samples (signified by Δ) is used in the calculations of average throughput and latency across a given Sample Interval. The Vitis IDE uses a default sample interval of approximately 50 ms.</p>
<div id="table3"><p><em>Table 3:</em> <strong>Profile Counters per AXI Interface in AXI Performance Monitor</strong></p>
<table border="1" class="docutils">
<thead>
<tr>
<th>APM Counter Metric</th>
<th>Performance Metrics Equation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Write Byte Count</td>
<td>Write Throughput =(∆(Write Byte Count))/(Sample Interval)</td>
</tr>
<tr>
<td>Write Latency Count</td>
<td>Average Write Latency = (∆(Write Latency Count))/(∆(Write Transaction Count))</td>
</tr>
<tr>
<td>Write Transaction Count</td>
<td>Use equation above</td>
</tr>
<tr>
<td>Read Byte Count</td>
<td>Read Throughput = (∆(Read Byte Count))/(Sample Interval)</td>
</tr>
<tr>
<td>Read Latency Count</td>
<td>Average Read Latency =(∆(Read Latency Count))/(∆(Read  Transaction Count))</td>
</tr>
<tr>
<td>Read Transaction Count</td>
<td>Use equation above</td>
</tr>
</tbody>
</table></div><p>Because there are many events that constitute an AXI transaction, it is important to understand the events that the Vitis IDE captures and how latency is calculated. The following figure shows a timing diagram of an example AXI read transaction, including address, data, and control signals.</p>
<p><em>Figure 7:</em> <strong>Example AXI Transaction Timeline Showing Read Latency Used in the Vitis IDE</strong></p>
<p><img alt="../../../../_images/image5.jpeg" src="../../../../_images/image5.jpeg" /></p>
<p>The start event used by the Vitis IDE is Address Accept (ARVALID=1 and ARREADY=1), while the end event is Last Data (RLAST=1 and RVALID=1 and RREADY=1). The difference between these two events within a common transaction is deemed the Transaction Latency.</p>
<blockquote>
<div><p><strong><em>Note</em>:</strong> The APM does not support:</p>
<ul class="simple">
<li><p>More than 32 out-standing transactions. Where the transactions can be initialization of more than 32 addresses before the first data block initiation (or) transfer/acceptance of 32 data blocks before first address.</p></li>
<li><p>Interleaved transactions. Where the transactions can be address initialization of new data transaction before finishing the current data transaction (before getting wlast/rlast).</p></li>
</ul>
</div></blockquote>
</section>
<section id="ps-profile-counters">
<h2>PS Profile Counters<a class="headerlink" href="#ps-profile-counters" title="Permalink to this heading">¶</a></h2>
<p>The PS profile counters comprise the Arm Performance Monitor Unit (PMU) included with each Cortex-A9 CPU. The following table shows how the six counters in each PMU are automatically configured by the Vitis IDE, as well as the performance metric equations they provide for each CPU. As shown later in this guide, these are the metrics that are directly graphed in the Vitis IDE.</p>
<div id="table4"><p><em>Table 4:</em> <strong>Profile Counters used in Arm Performance Monitor Unit</strong></p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Event Name</th>
<th>Event</th>
<th>Description</th>
<th>Performance Metrics Equation</th>
</tr>
</thead>
<tbody>
<tr>
<td>CCNT</td>
<td>N/A</td>
<td>Non-idle clock cycle  counter</td>
<td>CPU Utilization(%) =  100x∆CCNT/(2*∆(SPM reference clock))</td>
</tr>
<tr>
<td>INST_RENAME</td>
<td>0x68</td>
<td>Number of instructions that went through register renaming</td>
<td>CPU Instructions Per Cycle(IPC) = (∆(INST_RENAME))/CCNT</td>
</tr>
<tr>
<td>L1D_CACHE_REFILL</td>
<td>0x03</td>
<td>L1 data cache misses</td>
<td>L1 Data Cache Miss Rate (%) = 100*(∆(L1D_CACHE_REFILL))/(∆(L1D_CACH E))</td>
</tr>
<tr>
<td>1D_CACHE</td>
<td>0x04</td>
<td>L1 data cache misses</td>
<td>L1 Data Cache Miss Rate (%) = 100*(∆(L1D_CACHE_REFILL))/(∆(L1D_CACH E))</td>
</tr>
<tr>
<td>D CACHE_DEP_STALL</td>
<td>0x61</td>
<td>Data cache dependent stall cycles with pending linefill</td>
<td>Read Stall Cycles Per Instruction = (∆(DCACHE_DEP_STALL))/(∆(INST_ RENAME))</td>
</tr>
<tr>
<td>MEM_WRITE_STALL</td>
<td>0x81</td>
<td>Processor stall cycles waiting for memory write</td>
<td>Write Stall Cycles Per Instruction = (∆(MEM_WRITE_STALL))/(∆(INST_R ENAME))</td>
</tr>
</tbody>
</table></div></section>
<section id="host-target-communication">
<h2>Host-Target Communication<a class="headerlink" href="#host-target-communication" title="Permalink to this heading">¶</a></h2>
<p>Now that you appreciate the profile counters and how they are processed and displayed in the SPA toolbox, it is also important to understand how those counters are sampled and transferred from the target to the host machine.</p>
<p>The Vitis IDE tool itself runs on a host machine and includes a hardware server using the Target Communication Framework (TCF). TCF can efficiently communicate with the target over the JTAG programming cable. This TCF-based hardware server controls and samples the profile counters listed in <a class="reference external" href="../docs/2-system-performance-modeling-project.md#table1">Table 1: BEEBS Benchmarks Provided in Pre-Compiled Program Table</a> and <a class="reference external" href="../docs/2-system-performance-modeling-project.md#table2">Table 2: Memory Stride Benchmarks Provided in Pre-Compiled Program</a> in the least intrusive manner possible. The APM and PMU counters are read using memory-mapped access via the Zynq-7000 SoC central interconnect. The counter values are then processed as described previously and displayed in the Vitis IDE.</p>
</section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2-system-performance-modeling-project.html" class="btn btn-neutral float-left" title="System Performance Modeling Project" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="4-getting-started-with-SPM.html" class="btn btn-neutral float-right" title="Getting Started with SPM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on July 29, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>