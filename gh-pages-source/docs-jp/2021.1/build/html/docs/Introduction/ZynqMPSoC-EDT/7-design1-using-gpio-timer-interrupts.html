


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/pro.min.css" media="all" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Boot and Configuration" href="8-boot-and-configuration.html" />
    <link rel="prev" title="Building and Debugging Linux Applications" href="6-build-linux-sw-for-ps.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> エンベデッド デザイン チュートリアル
          

          
          </a>

          
            
            
              <div class="version">
                2021.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">日本語</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">入門チュートリアル</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC エンベデッド デザイン チュートリアル</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-getting-started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-system-configuration.html">Zynq UltraScale+ MPSoC System Configuration with Vivado</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-build-sw-for-ps-subsystems.html">Building Software for PS Subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-debugging-with-vitis-debugger.html">Debugging Standalone Applications with the Vitis Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-build-linux-sw-for-ps.html">Building and Debugging Linux Applications</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">System Design Example: Using GPIO, Timer and Interrupts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuring-hardware">Configuring Hardware</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-the-axi-timer-and-axi-gpio-ip">Adding the AXI Timer and AXI GPIO IP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connecting-ip-blocks-to-create-a-complete-system">Connecting IP Blocks to Create a Complete System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-the-post-implementation-hardware-platform">Exporting the Post-Implementation Hardware Platform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-software">Configuring Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuring-and-building-linux-using-petalinux">Configuring and Building Linux Using PetaLinux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-bare-metal-application-project">Creating the Bare-Metal Application Project</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-the-linker-script">Modifying the Linker Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-linux-domain-for-linux-applications">Creating the Linux Domain for Linux Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-linux-application-project">Creating the Linux Application Project</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-the-build-settings">Modifying the Build Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-boot-image">Creating a Boot Image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-image-on-a-zcu102-board">Running the Image on a ZCU102 Board</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#preparing-the-sd-card">Preparing the SD Card</a></li>
<li class="toctree-l4"><a class="reference internal" href="#target-setup">Target Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#power-on-target-and-run-applications">Power On Target and Run Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-linux-applications">Running Linux Applications</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reference-design-automation">Reference Design Automation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="8-boot-and-configuration.html">Boot and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="9-secure-boot.html">Secure Boot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Zynq7000-EDT/Zynq7000-EDT.html">Zynq-7000 エンベデッド デザイン チュートリアル</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">機能チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Feature_Tutorials/debuggable-fsbl/debuggable-fsbl.html">First Stage Boot Loader (FSBL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Feature_Tutorials/sw-profiling/sw-profiling.html">システム デバッガーを使用したアプリケーションのプロファイル</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">デバッグ ガイド</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Vitis-Embedded-Software-Debugging/Debugging.html">Vitis エンベデッド ソフトウェア デバッグ ガイド (UG1515) 2021.1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ユーザー ガイド</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../User_Guides/SPA-UG/SPA-UG.html">システム パフォーマンス解析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../User_Guides/Performance_Benchmark/Dhrystone/README.html">Versal Dhrystone ベンチマーク</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../_sources/docs/Introduction/ZynqMPSoC-EDT/7-design1-using-gpio-timer-interrupts.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">エンベデッド デザイン チュートリアル</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="ZynqMPSoC-EDT.html">Zynq UltraScale+ MPSoC Embedded Design Tutorial</a> &raquo;</li>
        
      <li>Design Example 1: Using GPIOs, Timers, and Interrupts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/docs/Introduction/ZynqMPSoC-EDT/7-design1-using-gpio-timer-interrupts.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design-example-1-using-gpios-timers-and-interrupts">
<h1>Design Example 1: Using GPIOs, Timers, and Interrupts<a class="headerlink" href="#design-example-1-using-gpios-timers-and-interrupts" title="Permalink to this headline">¶</a></h1>
<p>The Zynq® UltraScale+™ MPSoC ZCU102 evaluation board comes with a few configurable switches and LEDs. This design example makes use of bare-metal and Linux applications to toggle these LEDs, with the following details:</p>
<ul class="simple">
<li><p>The Linux APU runs Linux, while the RPU R5-0 hosts another bare-metal application.</p></li>
<li><p>The Linux applications configure a set of PL LEDs to toggle using a PS dip switch, and another set of PL LEDs to toggle using a PL Dip Switch (SW17).</p></li>
<li><p>The R5-Core 0 application uses an AXI Timer IP in the programmable logic to toggle PS LED (DS50). The application is configured to toggle the LED state every time the timer counter expires, and the timer in the PL is set to reset periodically after a configurable time interval.</p></li>
<li><p>The system is configured so that the APU Linux application and RPU bare-metal application run simultaneously.</p></li>
</ul>
<div class="section" id="configuring-hardware">
<h2>Configuring Hardware<a class="headerlink" href="#configuring-hardware" title="Permalink to this headline">¶</a></h2>
<p>The first step in this design is to configure the PS and PL sections. This can be done in Vivado® IP integrator. Start with adding the required IPs from the Vivado IP catalog, and then connect the components to blocks in the PS subsystem.</p>
<ol>
<li><p>If the Vivado Design Suite is already open, start from the block diagram shown in and jump to step 4.</p></li>
<li><p>Open the Vivado project that you created in the introduction tutorial:</p>
<p><code class="docutils literal notranslate"><span class="pre">C:/edt/edt_zcu102/edt_zcu102.xpr</span></code></p>
</li>
<li><p>Save the project as <code class="docutils literal notranslate"><span class="pre">design_example_1</span></code>:</p>
<ul class="simple">
<li><p>Click <strong>File → Project → Save As</strong>.</p></li>
<li><p>Input project name <strong>design_example_1</strong>.</p></li>
<li><p>Deselect <strong>Include run results</strong>.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
</ul>
<p><img alt="../../../_images/vivado_save_project_as.png" src="../../../_images/vivado_save_project_as.png" /></p>
</li>
<li><p>In the Flow Navigator, under IP integrator, click <strong>Open Block Design</strong> and select <code class="docutils literal notranslate"><span class="pre">edt_zcu102.bd</span></code>.</p>
<p><img alt="../../../_images/image961.png" src="../../../_images/image961.png" /></p>
</li>
</ol>
<div class="section" id="adding-the-axi-timer-and-axi-gpio-ip">
<h3>Adding the AXI Timer and AXI GPIO IP<a class="headerlink" href="#adding-the-axi-timer-and-axi-gpio-ip" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>Adding the AXI Timer IP:</p>
<ul class="simple">
<li><p>Right-click in the block diagram and select <strong>Add IP</strong> from the IP catalog.</p></li>
<li><p>In the catalog, select <strong>AXI Timer</strong>. The IP Details information displays, as shown in the following figure.</p></li>
</ul>
<p><img alt="../../../_images/image971.jpeg" src="../../../_images/image971.jpeg" /></p>
<ul class="simple">
<li><p>Double-click the <strong>AXI Timer</strong> IP to add it to the design.</p></li>
</ul>
</li>
<li><p>Review the <strong>AXI Timer</strong> configurations:</p>
<ul class="simple">
<li><p>Double-click the <strong>AXI Timer</strong> IP block to configure the IP, as
shown in following figure.</p></li>
</ul>
<p><img alt="../../../_images/image98.png" src="../../../_images/image98.png" /></p>
<ul class="simple">
<li><p>Click <strong>OK</strong> to close the window.</p></li>
</ul>
</li>
<li><p>Add the <strong>AXI GPIO</strong> IP:</p>
<ul class="simple">
<li><p>Right-click in the block diagram and select <strong>Add IP</strong>.</p></li>
<li><p>Search for “AXI GPIO” and double-click the <strong>AXI GPIO</strong> IP to add it to the design.</p></li>
</ul>
</li>
<li><p>Add the second <strong>AXI GPIO</strong> IP:</p>
<ul class="simple">
<li><p>Copy the <strong>axi_gpio_0</strong> IP by typing <strong>Ctrl+C</strong>.</p></li>
<li><p>Paste it by typing <strong>Ctrl+V</strong>.</p></li>
<li><p>You can see that axi_gpio_1 is created.</p></li>
</ul>
</li>
<li><p>Configure <strong>axi_gpio_0</strong> for push buttons:</p>
<ul class="simple">
<li><p>Double-click <strong>axi_gpio_0</strong> to open its configurations.</p></li>
<li><p>Select <strong>Push button 5bits</strong> from the Board Interface drop-down list on the GPIO row.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
</ul>
<p><img alt="../../../_images/image991.png" src="../../../_images/image991.png" /></p>
</li>
<li><p>Configure <strong>axi_gpio_1</strong> for PL LEDs:</p>
<ul class="simple">
<li><p>Double-click <strong>axi_gpio_1</strong> to open its configurations.</p></li>
<li><p>Select <strong>led_8bits</strong> from the Board Interface drop-down list on the <strong>GPIO</strong> row.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
</ul>
<p><img alt="../../../_images/image100.png" src="../../../_images/image100.png" /></p>
</li>
</ol>
</div>
<div class="section" id="connecting-ip-blocks-to-create-a-complete-system">
<h3>Connecting IP Blocks to Create a Complete System<a class="headerlink" href="#connecting-ip-blocks-to-create-a-complete-system" title="Permalink to this headline">¶</a></h3>
<p>The next step is to connect the IP blocks instantiated above to the PS block.</p>
<ul class="simple">
<li><p>Use PS HPM LPD AXI to control the AXI interface of the GPIO and timer.</p></li>
<li><p>Connect interrupt signals.</p></li>
</ul>
<ol>
<li><p>Enable the PS AXI HPM LPD AXI interface:</p>
<ul class="simple">
<li><p>Double-click the <strong>Zynq UltraScale+ MPSoC</strong> IP block.</p></li>
<li><p>Select the <strong>PS-PL Configuration</strong> tab.</p></li>
<li><p>Enable <strong>AXI HPM0 LPD</strong>, expand it, and set the AXI HPM0 LPD Data Width drop-down to <strong>32</strong> bits.</p></li>
<li><p>Click <strong>OK</strong> to close the window.</p></li>
<li><p>Check that the M_AXI_HPM0_LPD interface shows up on the MPSoC block.</p></li>
</ul>
<p><img alt="AXI HPM LPD" src="../../../_images/image102.png" /></p>
<blockquote>
<div><p><strong>Note:</strong> 32-bit AXI is useful for accessing the control registers of general IPs. 128-bit AXI is useful for data transfer.</p>
</div></blockquote>
</li>
<li><p>Connect the AXI interfaces:</p>
<ul class="simple">
<li><p>Click <strong>Run Connection Automation</strong>.</p></li>
<li><p>Check <strong>All Automation</strong>.</p></li>
<li><p>Go through each tab to review the planning connections.</p></li>
<li><p>Click <strong>OK</strong> to execute the automated connection.</p></li>
<li><p>Check the connection result.</p></li>
</ul>
<p><img alt="Vivado Connection Automation Result" src="../../../_images/vivado_gpio_auto_connection.png" /></p>
</li>
<li><p>Connect the interrupt signals:</p>
<ul class="simple">
<li><p>Connect axi_timer_0.interrupt to zynq_ultra_ps_e_0.pl_ps_irq0[0:0].</p></li>
<li><p>The AXI GPIO interrupt mode will not be used.</p></li>
<li><p>Review the final block diagram.</p></li>
</ul>
<p><img alt="Final Block Diagram" src="../../../_images/design_example_1_block_diagram.png" /></p>
<blockquote>
<div><p><strong>Note:</strong> If you have multiple interrupt signals to connect to the PS, you can concatenate them to a bus with a <code class="docutils literal notranslate"><span class="pre">concat</span></code> block. You can add <code class="docutils literal notranslate"><span class="pre">concat</span></code> from <strong>Add IP</strong>.</p>
</div></blockquote>
</li>
<li><p>Verify the address settings of IP cores:</p>
<ul class="simple">
<li><p>In the Address Editor view, verify that the corresponding IPs are assigned addresses during connection automation. If they are not assigned, click the <strong>Assign All</strong> button to assign addresses for them.</p></li>
</ul>
<p><img alt="../../../_images/image104.png" src="../../../_images/image104.png" /></p>
<blockquote>
<div><p><strong>Note:</strong> Connection automation assigns addresses automatically. If you connect IP manually, you also need to assign its address.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="exporting-the-post-implementation-hardware-platform">
<h3>Exporting the Post-Implementation Hardware Platform<a class="headerlink" href="#exporting-the-post-implementation-hardware-platform" title="Permalink to this headline">¶</a></h3>
<p>We will run implementation of the Vivado design and export the post-implementation design. The Vivado generated bitstream will be included in the XSA file. It can make the software tests and boot image generation steps easier in the Vitis IDE. Note that the Vitis IDE also accepts pre-synthesis XSAs for application development. Bitstream is only required for debugging PL designs.</p>
<ol>
<li><p>Validate the block diagram design:</p>
<ul class="simple">
<li><p>Return to the block diagram view.</p></li>
<li><p>Save the block design (press <strong>Ctrl+S</strong>).</p></li>
<li><p>Click the <strong>Validate Design</strong> button on the block diagram toolbar. Alternatively, press the <strong>F6</strong> key.</p></li>
</ul>
<p>It takes a while to validate the design. A message dialog box pops up and states “Validation successful. There are no errors or critical warnings in this design.” If it reports any errors or critical warnings, review the previous steps and correct the errors.</p>
<ul class="simple">
<li><p>Click <strong>OK</strong> to close the message.</p></li>
</ul>
</li>
<li><p>Generate output products:</p>
<ul class="simple">
<li><p>Click <strong>Generate Block Design</strong> in the Flow Navigator panel.</p></li>
<li><p>Click <strong>Generate</strong>,</p></li>
<li><p>When the Generate Output Products process completes, click <strong>OK</strong>.</p></li>
<li><p>In the Block Diagram Sources window, click the <strong>IP Sources</strong> tab. Here you can see the output products that you just generated, as shown in the following figure.</p></li>
</ul>
<p><img alt="../../../_images/image106.png" src="../../../_images/image106.png" /></p>
</li>
<li><p>Make sure you have an HDL top file. Because this design is saved from the introduction design, we have already done it.</p></li>
<li><p>Run synthesis, implementation, and bitstream generation:</p>
<ul class="simple">
<li><p>Click <strong>Generate Bitstream</strong>.</p></li>
<li><p>Vivado displays a popup message saying “There are no implementation results available. OK to launch synthesis and implementation?”. Click <strong>Yes</strong>.</p></li>
<li><p>Review the <strong>Launch Runs</strong> dialogue, set the proper number of jobs to run simultaneously, and click <strong>OK</strong>.</p></li>
<li><p>Wait for Vivado to complete implementation. After it finishes, a Bitstream Generation Completed message will pop up. Click <strong>Cancel</strong> to close it.</p></li>
</ul>
<p><img alt="Vivado Launch Run Configuration" src="../../../_images/vivado_launch_run.png" /></p>
</li>
<li><p>Export the hardware design:</p>
<ul class="simple">
<li><p>Select <strong>File → Export → Export Hardware</strong>. The Export Hardware Platform window opens.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>Select <strong>Include Bitstream</strong> and click <strong>Next</strong>.</p></li>
<li><p>Specify the XSA file name and path. This is kept at default in this example. Click <strong>Next</strong>.</p></li>
<li><p>Review the summary and click <strong>Finish</strong> to close the window.</p></li>
<li><p>The hardware platform XSA file is generated in the specified path.</p></li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section" id="configuring-software">
<h2>Configuring Software<a class="headerlink" href="#configuring-software" title="Permalink to this headline">¶</a></h2>
<p>This use case has a bare-metal application running on an R5 core and a Linux application running on an APU Linux target. Most of the software blocks will remain the same as mentioned in <a class="reference internal" href="4-build-sw-for-ps-subsystems.html"><span class="doc">Build Software for PS Subsystems</span></a>. The software for this design example requires additional drivers for components added in the PL. For this reason, you will need to generate a new bare-metal BSP in the Vitis IDE using the hardware files generated for this design. Linux also requires the Linux BSP to be reconfigured in sync with the new hardware platform file (XSA).</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Processor</th>
<th>Domain</th>
<th>Application</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cortex-A53</td>
<td>Linux</td>
<td>ps_pl_linux_app</td>
</tr>
<tr>
<td>Cortex-R5_0</td>
<td>Standalone</td>
<td>tmr_psled_r5</td>
</tr>
</tbody>
</table><p>Before you configure the software, first look at the application
design scheme. The system has a bare-metal application on RPU, which
starts with toggling the PS LEDs for a configurable period. The
LEDs are set to toggle in synchronization with a PL AXI Timer running in
the PL block. The application sets the AXI Timer in the generate mode
and generates an interrupt every time the Timer count expires. The
application is designed to toggle the PS LED state after handling the
Timer interrupt. The application runs in an infinite while loop and
sets the RPU in WFI mode after toggling the LEDs for the configured time period. This LED toggling sequence can be repeated again by getting the RPU out of WFI mode using an external
interrupt. For this reason, the UART interrupt is also configured and enabled in the same
application. While this application runs on the RPU, the Linux target
also hosts another Linux application. The Linux application uses user
input from the PS or PL switches to toggle PL LEDs. This Linux application
also runs in an infinite while loop, waiting for user input to toggle the PL LEDs. The next set of steps shows how to configure system software and build user applications for this design.</p>
<div class="section" id="configuring-and-building-linux-using-petalinux">
<h3>Configuring and Building Linux Using PetaLinux<a class="headerlink" href="#configuring-and-building-linux-using-petalinux" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Create the Linux images using PetaLinux. The Linux images must be created in sync with the hardware configuration for this design. You will also need to configure PetaLinux to create images for SD boot.</p></li>
<li><p>Repeat steps 2 to 4 as described in <a class="reference external" href="6-build-linux-sw-for-ps.md#creating-a-petalinux-image">Creating a PetaLinux Image</a> to update the device tree and build Linux images using PetaLinux.</p></li>
<li><p>Follow instructions in <a class="reference external" href="6-build-linux-sw-for-ps.md#verifying-the-image-on-the-zcu102-board">Verifying the Image on the ZCU102 Board</a> to verify the images.</p></li>
</ol>
<p>Make sure you have the following files for creating the Linux domain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">fsbl</span><span class="o">.</span><span class="n">elf</span>
<span class="o">-</span> <span class="n">pmufw</span><span class="o">.</span><span class="n">elf</span>
<span class="o">-</span> <span class="n">bl31</span><span class="o">.</span><span class="n">elf</span>
<span class="o">-</span> <span class="n">rootfs</span><span class="o">.</span><span class="n">ext4</span>
<span class="o">-</span> <span class="n">Image</span>
<span class="o">-</span> <span class="n">system</span><span class="o">.</span><span class="n">dtb</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-the-bare-metal-application-project">
<h3>Creating the Bare-Metal Application Project<a class="headerlink" href="#creating-the-bare-metal-application-project" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Launch Vitis and use a new workspace <strong>C:\edt\design_example_1</strong> for this project.</p></li>
<li><p>In the Vitis IDE, select <strong>File → New → Application Project</strong>. The New Project wizard opens.</p></li>
<li><p>Use the information in the table below to make your selections in the wizard.</p></li>
</ol>
<table border="1" class="docutils">
<thead>
<tr>
<th>Screen</th>
<th>System Properties</th>
<th>Settings</th>
</tr>
</thead>
<tbody>
<tr>
<td>Platform</td>
<td>Create a New Platform from Hardware</td>
<td><strong>edt_zcu102_wrapper.xsa</strong></td>
</tr>
<tr>
<td></td>
<td>Generate Boot Components</td>
<td><strong>uncheck</strong></td>
</tr>
<tr>
<td>Application Project Details</td>
<td>Application project name</td>
<td><strong>tmr_psled_r5</strong></td>
</tr>
<tr>
<td></td>
<td>System project name</td>
<td>tmr_psled_r5_system</td>
</tr>
<tr>
<td></td>
<td>Target processor</td>
<td><strong>psu_cortexr5_0</strong></td>
</tr>
<tr>
<td>Domain</td>
<td>Domain</td>
<td><strong>psu_cortexr5_0</strong></td>
</tr>
<tr>
<td>Templates</td>
<td>Available templates</td>
<td>Empty Application(C)</td>
</tr>
</tbody>
</table><ol>
<li><p>Click <strong>Finish</strong>.</p>
<p>The New Project wizard closes and the Vitis IDE creates the
tmr_psled_r5 application project, which you can view in the Project
Explorer.</p>
</li>
<li><p>In the Project Explorer tab, expand the <strong>tmr_psled_r5</strong> project.</p></li>
<li><p>Right-click the <strong>src</strong> directory, and select <strong>Import</strong> to open the Import dialog box.</p></li>
<li><p>Expand General in the Import dialog box and select <strong>File System</strong>.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>Select <strong>Browse</strong> and navigate to the <code class="docutils literal notranslate"><span class="pre">ref_files/design1</span></code> folder.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>Select and add the <strong>timer_psled_r5.c</strong> file.</p></li>
<li><p>Click <strong>Finish</strong>.</p></li>
</ol>
<p>The Vitis IDE automatically builds the application and displays the status in the console window.</p>
</div>
<div class="section" id="modifying-the-linker-script">
<h3>Modifying the Linker Script<a class="headerlink" href="#modifying-the-linker-script" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>In the Project Explorer, expand the tmr_psled_r5 project.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory, double-click <code class="docutils literal notranslate"><span class="pre">lscript.ld</span></code> to open the linker script for this project.</p></li>
<li><p>In the linker script in Available Memory Regions, modify the following attributes for <strong>psu_r5_ddr_0_MEM_0</strong>:</p>
<p>Base Address: <code class="docutils literal notranslate"><span class="pre">0x70000000</span></code>
Size: <code class="docutils literal notranslate"><span class="pre">0x10000000</span></code></p>
<p>The following figure shows the linker script modification. The following figure is for representation only. Actual memory regions might vary in case of isolation settings.</p>
<p><img alt="../../../_images/image361.png" src="../../../_images/image361.png" /></p>
<p>This modification in the linker script ensures that the RPU bare-metal
application resides above <code class="docutils literal notranslate"><span class="pre">0x70000000</span></code> base address in the DDR, and
occupies no more than 256 MB of size.</p>
</li>
<li><p>Type <strong>Ctrl+S</strong> to save the changes.</p></li>
<li><p>Modify the BSP to configure UART with UART_1. For more information, see <a class="reference external" href="#4-build-sw-for-ps-subsystems.md#modifying-the-board-support-package-for-testapp_r5">Modifying the Board Support Package for testapp-r5</a>.</p></li>
<li><p>Right-click the <strong>tmr_psled_r5</strong> project and select <strong>Build Project</strong>.</p></li>
<li><p>Verify that the application is compiled and linked successfully and that the <code class="docutils literal notranslate"><span class="pre">tmr_psled_r5.elf</span></code> file is generated in the <code class="docutils literal notranslate"><span class="pre">tmr_psled_r5\Debug</span></code> folder.</p></li>
</ol>
</div>
<div class="section" id="creating-the-linux-domain-for-linux-applications">
<h3>Creating the Linux Domain for Linux Applications<a class="headerlink" href="#creating-the-linux-domain-for-linux-applications" title="Permalink to this headline">¶</a></h3>
<p>To create a Linux domain for generating Linux applications, follow these steps:</p>
<ol class="simple">
<li><p>In the Explorer view of the Vitis IDE, expand the edt_zcu102_wrapper platform project.</p></li>
<li><p>Double-click <strong>platform.spr</strong> in the Explorer view to open the platform explorer.</p></li>
<li><p>Click <img alt="../../../_images/image311.png" src="../../../_images/image311.png" /> in the top right hand corner to add the domain.</p></li>
<li><p>When the new domain window opens, enter the following details:</p>
<ul class="simple">
<li><p>Name: Linux_Domain</p></li>
<li><p>Display name: Linux_Domain</p></li>
<li><p>OS: Linux</p></li>
<li><p>Processor: psu_cortexa53</p></li>
<li><p>Supported runtimes: C/C++</p></li>
<li><p>Architecture: 64-bit</p></li>
<li><p>Bif file: Provide a sample bif file.</p></li>
<li><p>Boot Component Directory: Create a boot directory and provide the path.</p></li>
<li><p>Linux Image Directory: Provide the same boot directory path.</p></li>
</ul>
</li>
<li><p>Build the platform to make the domain change take effects.</p></li>
</ol>
</div>
<div class="section" id="creating-the-linux-application-project">
<h3>Creating the Linux Application Project<a class="headerlink" href="#creating-the-linux-application-project" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>In the Vitis IDE, select <strong>File → New → Application Project</strong>. The New Project wizard opens.</p></li>
<li><p>Use the information in the table below to make your selections in the wizard.</p></li>
</ol>
<table border="1" class="docutils">
<thead>
<tr>
<th>Screen</th>
<th>System Properties</th>
<th>Settings</th>
</tr>
</thead>
<tbody>
<tr>
<td>Platform</td>
<td>Select platform from repository</td>
<td>edt_zcu102_wrapper</td>
</tr>
<tr>
<td>Application project details</td>
<td>Application  project name</td>
<td>ps_pl_linux_app</td>
</tr>
<tr>
<td></td>
<td>System project name</td>
<td>ps_pl_linux_app_system</td>
</tr>
<tr>
<td></td>
<td>Target processor</td>
<td>psu_cortexa53 SMP</td>
</tr>
<tr>
<td>Domain</td>
<td>Domain</td>
<td>Linux_Domain</td>
</tr>
<tr>
<td>Templates</td>
<td>Available templates</td>
<td>Linux Empty Application</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Since</span> <span class="n">we</span> <span class="n">have</span> <span class="n">already</span> <span class="n">created</span> <span class="n">the</span> <span class="n">Linux</span> <span class="n">domain</span> <span class="n">on</span> <span class="n">psu_cortexa53</span><span class="p">,</span> <span class="n">it</span> <span class="n">shows</span> <span class="n">up</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">processor</span> <span class="nb">list</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span><span class="s1">&#39;d like to create the domain during application creation process, you need to check &quot;Show all processors in the hardware specification&quot; to let the wizard show all processors. By default, it only shows the processors that have been used by the domains in the platform.</span>
</pre></div>
</div>
<ol>
<li><p>Click <strong>Finish</strong>.</p>
<p>The New Project wizard closes and the Vitis IDE creates the
ps_pl_linux_app application project, which can be found in the Project
Explorer view.</p>
</li>
<li><p>In the Project Explorer view, expand the <strong>ps_pl_linux_app</strong> project.</p></li>
<li><p>Right-click the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory, and select <strong>Import</strong> to open the Import view.</p></li>
<li><p>Expand General in the Import dialog box and select <strong>File System</strong>.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>Select <strong>Browse</strong> and navigate to the <strong>ref_files/design1</strong> folder.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>Select and add the <strong>ps_pl_linux_app.c</strong> file.</p></li>
</ol>
<blockquote>
<div><p><strong>Note:</strong> The application might fail to build because of a missing
reference to the pthread library. The next section shows how to add
the pthread library.</p>
</div></blockquote>
</div>
<div class="section" id="modifying-the-build-settings">
<h3>Modifying the Build Settings<a class="headerlink" href="#modifying-the-build-settings" title="Permalink to this headline">¶</a></h3>
<p>This application makes use of pthreads from the pthread library. Add
the pthread library as follows:</p>
<ol>
<li><p>Right-click <strong>ps_pl_linux_app</strong>, and click <strong>C/C++ Build Settings</strong>.</p></li>
<li><p>Refer to the following figures to add the pthread library.</p>
<p><img alt="../../../_images/image110.jpeg" src="../../../_images/image110.jpeg" /></p>
<p><img alt="../../../_images/image111.png" src="../../../_images/image111.png" /></p>
</li>
<li><p>Click <strong>OK</strong> in both the windows.</p></li>
<li><p>Right-click the application and select <strong>Build</strong> to build the application.</p></li>
</ol>
</div>
<div class="section" id="creating-a-boot-image">
<h3>Creating a Boot Image<a class="headerlink" href="#creating-a-boot-image" title="Permalink to this headline">¶</a></h3>
<p>Now that all the individual images are ready, you will create the boot
image to load all of these components on a Zynq UltraScale+ device. This can be done using the Create Boot Image wizard in the Vitis IDE by performing the following steps. This example creates a boot image <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> in <code class="docutils literal notranslate"><span class="pre">C:\\edt\\design1</span></code>.</p>
<ol>
<li><p>Launch the Vitis IDE, if it is not already running.</p></li>
<li><p>Set the workspace based on the project you created in <a class="reference internal" href="3-system-configuration.html"><span class="doc">Zynq UltraScale+ MPSoC Processing System Configuration</span></a>. For example: <code class="docutils literal notranslate"><span class="pre">C:\edt</span></code>.</p></li>
<li><p>Select <strong>Xilinx → Create Boot Image</strong>.</p></li>
<li><p>In the Create Boot Image wizard, add the settings and partitions as shown in the following figure.</p>
<blockquote>
<div><p><strong>Note:</strong> For detailed steps on how to add partitions, see <a class="reference external" href="8-boot-and-configuration.md#boot-sequence-for-sd-boot">Boot Sequence for SD-Boot</a>.</p>
</div></blockquote>
<p><img alt="../../../_images/image112.png" src="../../../_images/image112.png" /></p>
<blockquote>
<div><p><strong>Note:</strong> This boot image requires PL bitstream <code class="docutils literal notranslate"><span class="pre">edt_zcu102_wrapper.bit</span></code> (Partition Type - Datafile, Destination Device - PL). The bitstream partition needs to be added right after the bootloader while you create the boot image. The R5 application <code class="docutils literal notranslate"><span class="pre">tmr_psled_r5.elf</span></code> is added as partition in this boot image.</p>
</div></blockquote>
</li>
<li><p>After adding all the partitions, click <strong>Create Image</strong>.</p>
<blockquote>
<div><p><strong>IMPORTANT!:</strong> Ensure that you have set the correct exception levels
for ATF (EL-3, TrustZone) and U-Boot (EL-2) partitions. These
settings can be ignored for other partitions.</p>
</div></blockquote>
</li>
</ol>
</div>
</div>
<div class="section" id="running-the-image-on-a-zcu102-board">
<h2>Running the Image on a ZCU102 Board<a class="headerlink" href="#running-the-image-on-a-zcu102-board" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preparing-the-sd-card">
<h3>Preparing the SD Card<a class="headerlink" href="#preparing-the-sd-card" title="Permalink to this headline">¶</a></h3>
<p>Copy the images and executables onto an SD card and load it into the SD card slot in the board.</p>
<ol>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> and <code class="docutils literal notranslate"><span class="pre">image.ub</span></code> files to an SD card.</p>
<blockquote>
<div><p><strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> is located in <code class="docutils literal notranslate"><span class="pre">C:\edt\design1</span></code>.</p>
</div></blockquote>
</li>
<li><p>Copy the Linux application, <code class="docutils literal notranslate"><span class="pre">ps_pl_linux_app.elf</span></code>, to the same SD card. The application can be found in <code class="docutils literal notranslate"><span class="pre">C:\edt\ps_pl_linux_app\Debug</span></code>.</p></li>
</ol>
</div>
<div class="section" id="target-setup">
<h3>Target Setup<a class="headerlink" href="#target-setup" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>Load the SD card into the ZCU102 board, in the J100 connector.</p></li>
<li><p>Connect the USB-UART on the board to the host machine.</p></li>
<li><p>Connect the Micro USB cable into the ZCU102 Board Micro USB port J83, and the other end into an open USB port on the host machine.</p></li>
<li><p>Configure the board to boot in SD boot mode by setting switch SW6 as shown in the following figure.</p>
<p><img alt="../../../_images/image431.jpeg" src="../../../_images/image431.jpeg" /></p>
</li>
<li><p>Connect 12V power to the ZCU102 6-Pin Molex connector.</p></li>
<li><p>Start a terminal session, using Tera Term or Minicom depending on the host machine being used, as well as the COM port and baud rate for your system.</p></li>
<li><p>For port settings, verify the COM port in the device manager. There are four USB-UART interfaces exposed by the ZCU102 board.</p></li>
<li><p>Select the COM port associated with the interface with the lowest number. In this case, for UART-0, select the COM port with interface-0.</p></li>
<li><p>Similarly, for UART-1, select the COM port with interface-1. Remember that the R5 BSP has been configured to use UART-1, so R5 application messages will appear on the COM port with the UART-1 terminal.</p></li>
</ol>
</div>
<div class="section" id="power-on-target-and-run-applications">
<h3>Power On Target and Run Applications<a class="headerlink" href="#power-on-target-and-run-applications" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>Turn on the ZCU102 board using SW1, and wait until Linux loads on the board.</p>
<p>You can see the initial boot sequence messages on your terminal screen
representing UART-0. The terminal screen configured for UART-1
also prints a message. This is the print message from the R5
bare-metal application running on the RPU, configured to use the UART-1
interface. This application is loaded by the FSBL onto the RPU.</p>
</li>
<li><p>Now that this application is running, notice the PS LED is being toggled by the application, and follow the instructions in the application terminal.</p>
<p><img alt="../../../_images/image113.png" src="../../../_images/image113.png" /></p>
</li>
</ol>
</div>
<div class="section" id="running-linux-applications">
<h3>Running Linux Applications<a class="headerlink" href="#running-linux-applications" title="Permalink to this headline">¶</a></h3>
<p>After Linux is up on the ZCU102 system, log into the Linux target with login: root and password: root. The Linux target is now ready to run applications. Run the Linux application by performing the following steps.</p>
<ol>
<li><p>Copy the application from the SD card mount point to <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">cp</span> <span class="pre">/run/media/mmcblk0p1/ps_pl_linux_app.elf</span> <span class="pre">/tmp</span></code></p>
<blockquote>
<div><p><strong>Note:</strong> Mount the SD card manually if you fail to find SD card contents in this location:<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">mount</span> <span class="pre">/dev/mmcblk0p1</span> <span class="pre">/media/</span></code>. Copy the application to <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>. <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">cp</span> <span class="pre">/media/ps_pl_linux_app.elf</span> <span class="pre">/tmp</span></code>.</p>
</div></blockquote>
</li>
<li><p>Run the application.</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">/tmp/ps_pl_linux_app.elf</span></code></p>
<p><img alt="../../../_images/image114.png" src="../../../_images/image114.png" /></p>
</li>
</ol>
</div>
</div>
<div class="section" id="reference-design-automation">
<h2>Reference Design Automation<a class="headerlink" href="#reference-design-automation" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="./ref_design/design1">ref_design</a> for this example provides not only the source code for applications, but also a Makefile to run through the design generation process. To generate the binaries, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ref_files/design1
make all
</pre></div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In this design example, you created the hardware design in Vivado with processing system and GPIO modules. The hardware was exported to an XSA file. You imported the hardware to PetaLinux to update the device tree. The regenerated PetaLinux image can boot the board. You also imported the XSA to the Vitis software platform to create the platform project and developed software for Arm Cortex-R5F. You finally created the boot image to include software binaries to run on both the APU and RPU to make the system perform as planned.</p>
<p>The <a class="reference internal" href="8-boot-and-configuration.html"><span class="doc">next chapter</span></a> introduces more boot and configuration techniques.</p>
<p>© Copyright 2017-2021 Xilinx, Inc.</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p>http://www.apache.org/licenses/LICENSE-2.0</p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="8-boot-and-configuration.html" class="btn btn-neutral float-right" title="Boot and Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="6-build-linux-sw-for-ps.html" class="btn btn-neutral float-left" title="Building and Debugging Linux Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on August 9, 2021.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2021, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>