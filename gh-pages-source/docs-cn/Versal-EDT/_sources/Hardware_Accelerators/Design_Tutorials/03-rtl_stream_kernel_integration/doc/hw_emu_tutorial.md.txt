<p align="right"><a href="https://xilinx.github.io/Vitis-Tutorials/master/docs/index.html">English</a> | <a>日本語</a></p>

# ハードウェア エミュレーション

Vitis でのビルドおよび実行には、ソフトウェア エミュレーション、ハードウェア エミュレーション、およびシステム ハードウェアの 3 つがあります。RTL カーネルは当然ソフトウェア エミュレーションをサポートしないので、このチュートリアルではハードウェア エミュレーション フローのみを説明します。

ハードウェア エミュレーションは、機能の正確性に加えて、サイクル精度の高いパフォーマンスと詳細なリソース見積もりを提供しますが、コンパイル時間と実行時間はソフトウェア エミュレーションよりも長くなります。ハードウェア エミュレーション中の検証には小さなデータ セットを使用して、実行時間を管理しやすくすることをお勧めします。

混合カーネル デザインの場合、ハードウェア エミュレーションはシステムレベルの統合をテストし、複数のカーネル間の相互作用を表示するためによく使用されます。

## 波形レポート

Vitis は、ハードウェア エミュレーションの実行時に波形ビューを生成でき、カーネルとグローバル メモリ間のデータ転送やカーネル間パイプを介したデータフローなどの詳細を表示します。

波形データ収集を有効にするには、コンパイル時に `-g` オプションが使用され、関連するオプションが xrt.ini ファイルでオンになっていることを確認します。このファイルは、ホスト実行ファイルと同じディレクトリに配置する必要があります。このチュートリアルでは、提供されている既に処理済みの xrt.ini を使用します。./sw/duild/ ディレクトリを確認してください。詳細は、Vitis オンライン資料の [xrt.ini ファイル](https://japan.xilinx.com/html_docs/xilinx2020_1/vitis_doc/obl1532064985142.html)を参照してください。

```
[Emulation]
debug_mode=batch
```

ここでは、U200 カードでの rtc\_gen\_test のハードウェア エミュレーション結果を例として使用します。エミュレーションが正常に実行されると、実行サマリ ファイルが自動的に生成されます。これは、Vitis アナライザーで直接開くことができます。波形は実行サマリ レポートに含まれます。

```
vitis_analyzer rtc_gen_test_hw_emu.xclbin.run_summary
```

<div align="center"><img src="./images/hw_emu_waveform.PNG" alt="ハードウェア エミュレーション波形" ></div>
波形データベースは、Vivado ロジック シミュレータ (`xsim`) で開くこともできます。

```
xsim -gui xilinx_u200_xdma_201830_2-0-rtc_gen_test_hw_emu.wdb
```

ハードウェア エミュレーションの実行中にシミュレーション波形を開く場合は、xrt.ini で debug\_mode を gui に変更します。

```
[Emulation]
debug_mode=gui
```

波形以外にも、実行サマリに含まれるその他の情報は、アプリケーションのプロファイル作成、最適化、デバッグに役立ちます。詳細は、このチュートリアルの[アプリケーションのプロファイリング](./profile_tutorial.md)を参照してください。ハードウェア エミュレーション フローの詳細は、Vitis オンライン資料の[ハードウェア エミュレーション](https://japan.xilinx.com/html_docs/xilinx2020_1/vitis_doc/buildtargets1.html#ldh1504034328524)を参照してください。


---------------------------------------


<p align="center"><sup>Copyright&copy; 2020 Xilinx</sup></p>
<p align= center class="sphinxhide"><b><a href="../../../../README.md">メイン ページに戻る</a> &mdash; <a href="../../../README.md">ハードウェア アクセラレータ チュートリアルの初めに戻る</a></b></p></br>
<p align="center"><sup>この資料は 2021 年 2 月 8 日時点の表記バージョンの英語版を翻訳したもので、内容に相違が生じる場合には原文を優先します。資料によっては英語版の更新に対応していないものがあります。
日本語版は参考用としてご使用の上、最新情報につきましては、必ず最新英語版をご参照ください。</sup></p>
