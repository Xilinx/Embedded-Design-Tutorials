


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../_static/js/jquery.min.js"></script>	
	  <script type="text/javascript" src="../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../_static/js/common-ui-all.min.js"></script>		
    <script type="text/javascript" src="../../_static/js/header-footer.min.js"></script>	
    <script type="text/javascript" src="../../_static/js/jquery-ui.min.js"></script>	
    <script type="text/javascript" src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>	
    <script type="text/javascript" src="../../_static/js/linkid.js"></script>		
    <script type="text/javascript" src="../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Creating Custom IP and Device Drivers for Linux" href="8-custom-ip-driver-linux.html" />
    <link rel="prev" title="Using the HP Slave Port with AXI CDMA IP" href="6-using-hp-port.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search" 
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a> 
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search" 
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Embedded Design Tutorials
          

          
          </a>

          
            
            
              <div class="version">
                2020.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">简体中文</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Embedded-Design-Tutorials/master/docs-cn/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">Versal ACAP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/1-getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/2-cips-noc-ip-config.html">Versal ACAP CIPS and NoC (DDR) IP Core Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/3-debugging.html">Debugging Using the Vitis Software Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/4-boot-and-config.html">Boot and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/5-system-design-example.html">System Design Example using Scalar Engine and Adaptable Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/6-system-design-example-HSDP.html">System Design Example for High-Speed Debug Port with SmartLynq+ Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Versal-EDT/docs/A-creating-plm.html">Appendix: Creating the PLM</a></li>
</ul>
<p class="caption"><span class="caption-text">Zynq UltraScale+ MPSoC</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/1-introduction.html">How Zynq UltraScale+ Devices Offer a Single Chip Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/2-getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/3-system-configuration.html">Zynq UltraScale+ MPSoC Processing System Configuration with Vivado</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/4-build-sw-for-ps-subsystems.html">Building Standalone Software for PS Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/5-debugging-with-vitis-debugger.html">Debugging Standalone Applications with the Vitis Debugger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/6-build-linux-sw-for-ps.html">Building and Debugging Linux Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/7-design1-using-gpio-timer-interrupts.html">Design Example 1: Using GPIOs, Timers, and Interrupts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ZynqMPSoC-EDT/8-boot-and-configuration.html">Boot and Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">Zynq-7000 Devices</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-introduction.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-using-zynq.html">Using the Zynq SoC Processing System</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-debugging-vitis.html">Debugging with the Vitis Software Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-linux-for-zynq.html">Building and Debugging Linux Applications for Zynq-7000 SoCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="5-using-gp-port-zynq.html">Using the GP Port in Zynq Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="6-using-hp-port.html">Using the HP Slave Port with AXI CDMA IP</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Linux Boot Image Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#boot-methods">Boot Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#master-boot-method">Master Boot Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slave-boot-method">Slave Boot Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#booting-linux-from-jtag">Booting Linux from JTAG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-9-booting-linux-with-jtag">Example 9: Booting Linux with JTAG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-and-output-files">Input and Output Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#booting-linux-in-jtag-mode">Booting Linux in JTAG Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-10-booting-linux-from-qspi-flash">Example 10: Booting Linux from QSPI Flash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Input and Output Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reducing-the-root-file-system-size">Reducing the Root File System Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changing-boot-scr-for-image-ub-offset-address-and-size">Changing boot.scr for image.ub Offset Address and Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-petalinux-image">Building the PetaLinux Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-a-linux-bootable-image-for-qspi-flash-with-petalinux">Making a Linux Bootable Image for QSPI Flash with PetaLinux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-a-linux-bootable-image-for-qspi-flash-with-the-vitis-ide">Making a Linux Bootable Image for QSPI Flash with the Vitis IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#programming-qspi-flash-with-the-flash-programming-tool">Programming QSPI Flash with the Flash Programming Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-programning-qspi-flash-with-the-boot-image-using-jtag">(Optional) Programning QSPI Flash with the Boot Image Using JTAG</a></li>
<li class="toctree-l3"><a class="reference internal" href="#booting-linux-from-qspi-flash">Booting Linux from QSPI Flash</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="8-custom-ip-driver-linux.html">Creating Custom IP and Device Drivers for Linux</a></li>
</ul>
<p class="caption"><span class="caption-text">Vitis Performance Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/README.html">About this Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/1-introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/2-system-performance-modeling-project.html">System Performance Modeling Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/3-monitor-framework.html">Monitor Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/4-getting-started-with-SPM.html">Getting Started with SPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/5-evaluating-software-performance.html">Evaluating Software Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/6-evaluating-high-performance-ports.html">Evaluating High-Performance Ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/7-evaluating-DDR-controller-settings.html">Evaluating DDR Controller Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/8-evaluating-memory-hierarchy-ACP.html">Evaluating Memory Hierarchy and the ACP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/9-using-spa-with-custom-target.html">Using SPA with a Custom Target</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/10-end-to-end-performance-analysis.html">End-To-End Performance Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SPA-UG/docs/A-performance-checklist.html">Performance Checklist</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/Embedded-Design-Tutorials/tree/master">Master</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../_sources/Introduction/Zynq7000-EDT/7-linux-booting-debug.md.txt"
						rel="nofollow">Show Source</a></li>						
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Embedded Design Tutorials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Linux Boot Image Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/Introduction/Zynq7000-EDT/7-linux-booting-debug.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linux-boot-image-configuration">
<h1>Linux Boot Image Configuration<a class="headerlink" href="#linux-boot-image-configuration" title="Permalink to this headline">¶</a></h1>
<p>In previous chapters, you used SD boot mode for all Linux examples. SD boot mode is easy to use for development. Sometimes it is necessary to change the boot source to QSPI Flash for its reliability and anti-vibration. In the board bring-up development phase, because the peripherals might not be available yet, boot with JTAG is a common technique for debugging. This chapter describes the detailed steps of these use cases.</p>
<div class="section" id="boot-methods">
<h2>Boot Methods<a class="headerlink" href="#boot-methods" title="Permalink to this headline">¶</a></h2>
<p>The following boot methods are available for Zynq®-7000 devices:</p>
<ul class="simple">
<li><p>Master boot method</p></li>
<li><p>Slave boot method</p></li>
</ul>
<div class="section" id="master-boot-method">
<h3>Master Boot Method<a class="headerlink" href="#master-boot-method" title="Permalink to this headline">¶</a></h3>
<p>In the master boot method, different kinds of non-volatile memories
such as QSPI, NAND, NOR flash, and SD cards are used to store boot
images. In this method, the CPU loads and executes the external boot
images from non-volatile memory into the processor system (PS). The
master boot method is further divided into secure and non-secure
modes. Refer to the <em>Zynq-7000 SoC Technical Reference Manual</em>
(<a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/ndoc?t=user_guides%3Bd=ug585-Zynq-7000-TRM.pdf">UG585</a>) for more details.</p>
<p>The boot process is initiated by one of the Arm® Cortex™-A9 CPUs in
the processing system (PS) and it executes on-chip ROM code. The
on-chip ROM code is responsible for loading the first stage boot
loader (FSBL). The FSBL does the following:</p>
<ul class="simple">
<li><p>Configures the FPGA with the hardware bitstream (if it exists)</p></li>
<li><p>Configures the MIO interface</p></li>
<li><p>Initializes the DDR controller</p></li>
<li><p>Initializes the clock PLL</p></li>
<li><p>Loads and executes the Linux U-Boot image from non-volatile memory
to DDR</p></li>
</ul>
<p>The U-Boot loads and starts the execution of the kernel image, the
root file system, and the device tree from non-volatile RAM to DDR. It
finishes booting Linux on the target platform.</p>
</div>
<div class="section" id="slave-boot-method">
<h3>Slave Boot Method<a class="headerlink" href="#slave-boot-method" title="Permalink to this headline">¶</a></h3>
<p>JTAG can only be used in slave boot mode. An external host computer
acts as the master to load the boot components into the OCM, DDR or FPGA using a JTAG
connection.</p>
<p><strong>Note:</strong> The PS CPU remains in idle mode while the boot image
loads. The slave boot method is always a non-secure mode of booting.</p>
<p>In JTAG boot mode, the CPU enters halt mode immediately after it
disables access to all security related items and enables the JTAG
port. You must download the boot images into the DDR memory before
restarting the CPU for execution.</p>
</div>
<div class="section" id="booting-linux-from-jtag">
<h3>Booting Linux from JTAG<a class="headerlink" href="#booting-linux-from-jtag" title="Permalink to this headline">¶</a></h3>
<p>The flowchart in the following figure describes the process used to
boot Linux on the target platform.</p>
<p><img alt="../../_images/X24074-Page-1.png" src="../../_images/X24074-Page-1.png" /></p>
</div>
</div>
<div class="section" id="example-9-booting-linux-with-jtag">
<h2>Example 9: Booting Linux with JTAG<a class="headerlink" href="#example-9-booting-linux-with-jtag" title="Permalink to this headline">¶</a></h2>
<p>This section covers the flow for booting Linux on the target board
using the pre-compiled images with JTAG.</p>
<div class="section" id="input-and-output-files">
<h3>Input and Output Files<a class="headerlink" href="#input-and-output-files" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Input files: the files generated by PetaLinux in <a class="reference external" href="4-linux-for-zynq.html#example-4-creating-linux-images">Example 4</a> or <a class="reference external" href="4-linux-for-zynq.html#example-5-creating-a-hello-world-application-for-linux-in-the-vitis-ide">Example 5</a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">zynq_fsbl.elf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u-boot.elf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Image.ub</span></code></p></li>
</ul>
</li>
<li><p>Output files: N/A</p></li>
</ul>
</div>
<div class="section" id="booting-linux-in-jtag-mode">
<h3>Booting Linux in JTAG Mode<a class="headerlink" href="#booting-linux-in-jtag-mode" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>Check the following board connections and settings for Linux booting
using JTAG mode:</p>
<ul>
<li><p>Ensure that the settings of Jumpers J27 and J28 are set as described in <a class="reference external" href="2-using-zynq.html#setting-up-the-board">Example 2: Setting Up the Board</a>.</p></li>
<li><p>Ensure that the SW16 switch is set to 00000, as shown in the following figure.</p>
<p><img alt="JTAG Boot Mode" src="../../_images/image671.jpeg" /></p>
</li>
<li><p>Connect an Ethernet cable from the Zynq-7000 SoC board to your
network or directly to your host machine.</p></li>
<li><p>Connect the Windows host machine to your network.</p></li>
<li><p>Connect the power cable to the board.</p></li>
</ul>
</li>
<li><p>Connect a micro USB cable between the Windows host machine and the
target board JTAG port with the following <strong>SW10</strong> switch settings, as shown in
the following figure.</p>
<ul class="simple">
<li><p>Bit-1 is 0</p></li>
<li><p>Bit-2 is 1</p></li>
</ul>
<p><strong>Note:</strong> 0 = switch is open. 1 = switch is closed. The correct JTAG
mode has to be selected, according to the user interface. The JTAG
mode is controlled by switch SW10 on the ZC702 and SW4 on the ZC706.</p>
<p><img alt="../../_images/image68.jpeg" src="../../_images/image68.jpeg" /></p>
</li>
<li><p>Connect a USB cable to connector J17 on the target board with the
Windows host machine. This is used for USB to serial transfer.</p></li>
<li><p>Change Ethernet Jumper J30 and J43 as shown in the following figure.</p>
<p><img alt="../../_images/image69.jpeg" src="../../_images/image69.jpeg" /></p>
</li>
<li><p>Power on the target board.</p></li>
<li><p>Launch Vitis IDE with any workspace.</p></li>
<li><p>If the serial terminal is not open, connect the serial communication
utility with the baud rate set to <strong>115200</strong>.</p>
<p><strong>Note:</strong> This is the baud rate that the UART is programmed to on
Zynq devices.</p>
</li>
<li><p>Download the bitstream by selecting <strong>Xilinx → Program FPGA</strong>, then
clicking <strong>Program</strong>.</p></li>
<li><p>Open the Xilinx System Debugger (XSCT) tool by selecting <strong>Xilinx → XSCT Console</strong>.</p></li>
<li><p>At the XSCT prompt, do the following:</p>
<ol class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">connect</span></code> to connect with the PS section.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">targets</span></code> to get the list of target processors.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">ta</span> <span class="pre">2</span></code> to select the processor CPU1.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span>
<span class="mi">1</span> <span class="n">APU</span>
<span class="mi">2</span> <span class="n">Arm</span> <span class="n">Cortex</span><span class="o">-</span><span class="n">A9</span> <span class="n">MPCore</span> <span class="c1">#0 (Running)</span>
<span class="mi">3</span> <span class="n">Arm</span> <span class="n">Cortex</span><span class="o">-</span><span class="n">A9</span> <span class="n">MPCore</span> <span class="c1">#1 (Running)</span>
<span class="mi">4</span> <span class="n">xc7z020</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">ta</span> <span class="mi">2</span>
<span class="n">xsct</span><span class="o">%</span> <span class="n">targets</span>
<span class="mi">1</span> <span class="n">APU</span>
<span class="mi">2</span><span class="o">*</span> <span class="n">Arm</span> <span class="n">Cortex</span><span class="o">-</span><span class="n">A9</span> <span class="n">MPCore</span> <span class="c1">#0 (Running)</span>
<span class="mi">3</span> <span class="n">Arm</span> <span class="n">Cortex</span><span class="o">-</span><span class="n">A9</span> <span class="n">MPCore</span> <span class="c1">#1 (Running)</span>
<span class="mi">4</span> <span class="n">xc7z02022</span>
</pre></div>
</div>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">dow</span> <span class="pre">zynq_fsbl.elf</span></code> to download
PetaLinux FSBL.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">con</span></code> to start execution of FSBL and then run <code class="docutils literal notranslate"><span class="pre">stop</span></code> to stop
it.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">dow</span> <span class="pre">u-boot.elf</span></code> to download
PetaLinux <code class="docutils literal notranslate"><span class="pre">U-Boot.elf</span></code>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">con</span></code> to start execution of U-Boot. On the serial terminal, the autoboot countdown message appears: <code class="docutils literal notranslate"><span class="pre">Hit</span> <span class="pre">any</span> <span class="pre">key</span> <span class="pre">to</span> <span class="pre">stop</span> <span class="pre">autoboot:</span> <span class="pre">3</span></code>.</p></li>
<li><p>Press <strong>Enter</strong>. Automatic booting from U-Boot stops and a command prompt appears on the serial terminal.</p></li>
<li><p>At the XSCT Prompt, run <code class="docutils literal notranslate"><span class="pre">stop</span></code>. The U-Boot execution stops.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">dow</span> <span class="pre">-data</span> <span class="pre">image.ub</span> <span class="pre">0x30000000</span></code> to download the Linux kernel image.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">con</span></code> to start executing U-Boot.</p></li>
</li>
<li><p>At the command prompt of the serial terminal, run <code class="docutils literal notranslate"><span class="pre">bootm</span> <span class="pre">0x30000000</span></code>.
The Linux OS boots.</p></li>
</ol>
</div>
</div>
<div class="section" id="example-10-booting-linux-from-qspi-flash">
<h2>Example 10: Booting Linux from QSPI Flash<a class="headerlink" href="#example-10-booting-linux-from-qspi-flash" title="Permalink to this headline">¶</a></h2>
<p>In this example, you will make a Linux boot image for QSPI Flash, write it into Flash, and let it boot.</p>
<p>QSPI Flash on a board normally has less capacity than an SD card or eMMC because of its relatively high price. It layout should be planned carefully. The Linux kernel image and rootfs can be stored in the same QSPI as this example, or stored in another non-volatile form of storage such as an SD card, NAND Flash, or eMMC. The only difference is the <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> packaging contents.</p>
<p>In this example, you will not only package normal boot components, such as FSBL, bitstream, and U-Boot into <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code>, but also the following:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code>file (read by U-Boot)</p></li>
<li><p>The flat image <code class="docutils literal notranslate"><span class="pre">image.ub</span></code> which contains the Linux kernel</p></li>
<li><p>The device tree (read by the Linux kernel)</p></li>
<li><p>rootfs</p></li>
</ul>
<p>The normal boot components can be packaged continuously. After the bootROM loads FSBL, FSBL can load bitstream and U-Boot properly and give control to U-Boot.</p>
<p>U-Boot reads <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code> from Flash offset 0x00FC0000 by default. Assign <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code> to this address during packaging.</p>
<p>By default, it is programmed in <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code> that if the boot mode is QSPI, <code class="docutils literal notranslate"><span class="pre">image.ub</span></code> should be read from Flash offset 0x01000000 (16 MB). However, because ZC702 has only 16 MB QSPI Flash, <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code> needs to be modified to load it from around the 5 MB area. Because the <code class="docutils literal notranslate"><span class="pre">petalinux-package</span></code> command uses 0x00520000 by default, you can keep using this address.</p>
<p>The following table shows the memory address layout you will create in this example.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Partition</th>
<th>Flash Offset Address</th>
<th>Size</th>
<th>DDR Loading Address</th>
</tr>
</thead>
<tbody>
<tr>
<td>FSBL</td>
<td>0x0</td>
<td>Very Small</td>
<td>Address info embedded in ELF</td>
</tr>
<tr>
<td>Bitstream</td>
<td>Continuous with previous partition</td>
<td>3.9MB</td>
<td>FSBL loads it as data</td>
</tr>
<tr>
<td>u-boot</td>
<td>Continuous with previous partition</td>
<td>Very Small</td>
<td>Address info embedded in ELF</td>
</tr>
<tr>
<td>image.ub</td>
<td>U-Boot loads it from 0x00520000</td>
<td>11MB</td>
<td>U-Boot loads it to 0x10000000</td>
</tr>
<tr>
<td>boot.scr</td>
<td>U-Boot reads it from Flash offset 0x00FC0000</td>
<td>2KB</td>
<td>U-Boot loads it to 0x03000000</td>
</tr>
</tbody>
</table><div class="section" id="id1">
<h3>Input and Output Files<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Input Files: PetaLinux project in <a class="reference external" href="4-linux-for-zynq.html#example-4-creating-linux-images">Example 4</a> or <a class="reference external" href="4-linux-for-zynq.html#example-5-creating-a-hello-world-application-for-linux-in-the-vitis-ide">Example 5</a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">zynq_fsbl.elf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u-boot.elf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">system.dtb</span></code></p></li>
<li><p>FPGA bit file: <code class="docutils literal notranslate"><span class="pre">system.bit</span></code> in the PetaLinux image directory or <code class="docutils literal notranslate"><span class="pre">system_wrapper.bit</span></code> in the Vivado directory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image.ub</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boot.scr</span></code></p></li>
</ul>
</li>
<li><p>Output Files: <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> binary to write to QSPI Flash</p></li>
</ul>
</div>
<div class="section" id="reducing-the-root-file-system-size">
<h3>Reducing the Root File System Size<a class="headerlink" href="#reducing-the-root-file-system-size" title="Permalink to this headline">¶</a></h3>
<p>Because there is limited QSPI Flash size, you need to shrink the rootfs size so that the rootfs can be packed into 16 MB QSPI Flash. If in your system you have larger QSPI Flash, this step can be skipped.</p>
<ol>
<li><p>Use your preferred editor to open the <code class="docutils literal notranslate"><span class="pre">rootfs_config</span></code> file in the <code class="docutils literal notranslate"><span class="pre">&lt;PetaLinux</span> <span class="pre">Project&gt;/project-spec/configs</span></code> directory.</p></li>
<li><p>Comment the following lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG_imagefeature</span><span class="o">-</span><span class="n">hwcodecs</span><span class="o">=</span><span class="n">y</span>
<span class="n">CONFIG_can</span><span class="o">-</span><span class="n">utils</span><span class="o">=</span><span class="n">y</span>
</pre></div>
</div>
<p>Save the file and quit the text editor.</p>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">petalinux-config</span> <span class="pre">-c</span> <span class="pre">rootfs</span> <span class="pre">--silentconfig</span></code> to update the rootfs configuration</p></li>
</ol>
</div>
<div class="section" id="changing-boot-scr-for-image-ub-offset-address-and-size">
<h3>Changing boot.scr for image.ub Offset Address and Size<a class="headerlink" href="#changing-boot-scr-for-image-ub-offset-address-and-size" title="Permalink to this headline">¶</a></h3>
<p>By default, <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code> loads image.ub from 0x01000000. It is possible to open <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code> with a text editor to check the behavior. If your system has more than 16 MB QSPI Flash, this step can be skipped, but it is important to pay attention to the boot image packaging step to make sure that the <code class="docutils literal notranslate"><span class="pre">image.ub</span></code> offset address is set to match the offset address in <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code>.</p>
<ol>
<li><p>Use a text editor to open <code class="docutils literal notranslate"><span class="pre">&lt;PetaLinux</span> <span class="pre">Project&gt;/project-spec/meta-user/recipes-bsp/u-boot/u-boot-zynq-scr.bbappend</span></code>.</p></li>
<li><p>Change <code class="docutils literal notranslate"><span class="pre">QSPI_KERNEL_OFFSET_zynq</span></code> to <code class="docutils literal notranslate"><span class="pre">0x520000</span></code> and <code class="docutils literal notranslate"><span class="pre">QSPI_FIT_IMAGE_SIZE_zynq</span></code> to <code class="docutils literal notranslate"><span class="pre">0xAE0000</span></code>, because these two variables are used in <code class="docutils literal notranslate"><span class="pre">/project-spec/meta-user/recipes-bsp/u-boot/u-boot-zynq-scr/boot.cmd.default.initrd</span></code> as <code class="docutils literal notranslate"><span class="pre">sf</span> <span class="pre">read</span> <span class="pre">&#64;&#64;QSPI_FIT_IMAGE_LOAD_ADDRESS&#64;&#64;</span> <span class="pre">&#64;&#64;QSPI_KERNEL_OFFSET&#64;&#64;</span> <span class="pre">&#64;&#64;QSPI_FIT_IMAGE_SIZE&#64;&#64;;</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QSPI_KERNEL_OFFSET_zynq</span> <span class="o">=</span> <span class="s2">&quot;0x520000&quot;</span>
<span class="n">QSPI_FIT_IMAGE_SIZE_zynq</span> <span class="o">=</span> <span class="s2">&quot;0xAE0000&quot;</span>
</pre></div>
</div>
<p>Save the file and quit the text editor.</p>
</li>
</ol>
</div>
<div class="section" id="building-the-petalinux-image">
<h3>Building the PetaLinux Image<a class="headerlink" href="#building-the-petalinux-image" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>Rebuild the PetaLinux project:</p>
<ul class="simple">
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">petalinux-build</span></code> command.</p></li>
</ul>
<p>PetaLinux will generate the new U-Boot and <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code>.</p>
<p><strong>Note:</strong> For more information, refer to the <em>PetaLinux Tools Documentation: Reference Guide</em>
(<a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/rdoc?v=2020.2%3Bd%3Dug1144-petalinux-tools-reference-guide.pdf">UG1144</a>).</p>
</li>
</ol>
</div>
<div class="section" id="making-a-linux-bootable-image-for-qspi-flash-with-petalinux">
<h3>Making a Linux Bootable Image for QSPI Flash with PetaLinux<a class="headerlink" href="#making-a-linux-bootable-image-for-qspi-flash-with-petalinux" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> file is generated by the Bootgen utility. It reads in the BIF for boot partition information. PetaLinux can help to create the BIF file with command line options and call Bootgen to generate the <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> file. Alternatively, the Vitis IDE can create BIF files with GUI wizards and call Bootgen as well. This section introduces the PetaLinux method. The next section introduces the Vitis IDE method..</p>
<ol>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">petalinux-package</span> <span class="pre">--boot</span></code> command in the <code class="docutils literal notranslate"><span class="pre">&lt;PetaLinux</span> <span class="pre">Project&gt;/images/linux</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">images</span><span class="o">/</span><span class="n">linux</span>
<span class="n">petalinux</span><span class="o">-</span><span class="n">package</span> <span class="o">--</span><span class="n">boot</span> <span class="o">--</span><span class="n">fpga</span> <span class="o">./</span><span class="n">system</span><span class="o">.</span><span class="n">bit</span> <span class="o">--</span><span class="n">u</span><span class="o">-</span><span class="n">boot</span> <span class="o">--</span><span class="n">add</span> <span class="n">boot</span><span class="o">.</span><span class="n">scr</span> <span class="o">--</span><span class="n">offset</span> <span class="mh">0xfc0000</span> <span class="o">--</span><span class="n">kernel</span> <span class="o">--</span><span class="n">force</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> file should be generated in the <code class="docutils literal notranslate"><span class="pre">images/linux</span></code> directory.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">--fpga</span></code> option assigns the optional FPGA bit file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--u-boot</span></code> packages <code class="docutils literal notranslate"><span class="pre">u-boot.elf</span></code> into <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--add</span> <span class="pre">--offset</span></code> will add a data file to a specific Flash offset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--kernel</span></code> adds <code class="docutils literal notranslate"><span class="pre">image.ub</span></code> to Flash offset 0x520000.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--force</span></code> forces an overwrite if <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> already exists.</p></li>
<li><p>FSBL is added by default. You don’t need to add an option to assign it.</p></li>
</ul>
<p>You can review the <strong>bootgen.bif</strong> contents in the <code class="docutils literal notranslate"><span class="pre">&lt;PetaLinux</span> <span class="pre">Project&gt;/build/</span></code> directory.</p>
</li>
</ol>
<blockquote>
<div><p><strong>Note:</strong> The <code class="docutils literal notranslate"><span class="pre">petalinux-package</span> <span class="pre">--boot</span></code> tool adds <code class="docutils literal notranslate"><span class="pre">system.dtb</span></code> into the <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> for compatibility with a separate uImage, dtb and rootfs, instead of the FIT format for <code class="docutils literal notranslate"><span class="pre">image.ub</span></code>. The added <code class="docutils literal notranslate"><span class="pre">system.dtb</span></code> partition is not used during boot if <code class="docutils literal notranslate"><span class="pre">image.ub</span></code> is used. For details, refer to the code in <code class="docutils literal notranslate"><span class="pre">boot.scr</span></code>.</p>
</div></blockquote>
</div>
<div class="section" id="making-a-linux-bootable-image-for-qspi-flash-with-the-vitis-ide">
<h3>Making a Linux Bootable Image for QSPI Flash with the Vitis IDE<a class="headerlink" href="#making-a-linux-bootable-image-for-qspi-flash-with-the-vitis-ide" title="Permalink to this headline">¶</a></h3>
<p>This method is an alternative to the PetaLinux method. If the PetaLinux tools and Vitis software platform are not installed on the same machine, copy the PetaLinux generated boot component files to the Vitis environment first.</p>
<ol>
<li><p>In the Vitis IDE, go to <strong>Xilinx → Create Boot Image</strong> to open the Create Boot Image wizard.</p>
<p><img alt="../../_images/image861.png" src="../../_images/image861.png" /></p>
<p><strong>Note:</strong> You might see a different initial screen for the Create Boot Image wizard. When a system project is selected, the Vitis IDE tries to generate an initial BIF for that project. When a platform project is selected, or if it is in an empty workspace, the Vitis IDE will show the wizard with no initial values.</p>
</li>
<li><p>From the <strong>Architecture</strong> drop-down list, select <strong>Zynq</strong>.</p></li>
<li><p>Choose <strong>Create New BIF File</strong>.</p></li>
<li><p>Specify the output BIF file path:</p>
<ul class="simple">
<li><p>Click <strong>Browse</strong> next to the <strong>Output BIF file path</strong> field.</p></li>
<li><p>Navigate to any path. For example, <code class="docutils literal notranslate"><span class="pre">C:\edt\boot\output.bif</span></code>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
<li><p>The <strong>Output path</strong> field will be updated automatically. The output <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> will be in the same directory with the BIF file by default. You can also change the output path.</p></li>
</ul>
</li>
<li><p>Click <strong>Add</strong> to add the following boot image partitions:</p></li>
<table>
<thead>
<tr class="header">
<th>File Path</th>
<th>Partition Type</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fsbl.elf</td>
<td>bootloader</td>
<td></td>
</tr>
<tr class="even">
<td>system.bit</td>
<td>datafile</td>
<td></td>
</tr>
<tr class="odd">
<td>u-boot.elf</td>
<td>datafile</td>
<td></td>
</tr>
<tr class="even">
<td>image.ub</td>
<td>datafile</td>
<td>0x520000</td>
</tr>
<tr class="odd">
<td>boot.scr</td>
<td>datafile</td>
<td>0xfc0000</td>
</tr>
</tbody>
</table>
<li><p>Click <strong>Create Image</strong> to create the <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> file in the specified output path folder.</p></li>
<li><p>Review the generated BIF. It should look like this example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">arch</span> <span class="o">=</span> <span class="n">zynq</span><span class="p">;</span> <span class="n">split</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="n">BIN</span>
<span class="n">the_ROM_image</span><span class="p">:</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">bootloader</span><span class="p">]</span><span class="n">C</span><span class="p">:</span>\<span class="n">edt</span>\<span class="n">edt_zc702_linux</span>\<span class="n">qspi</span>\<span class="n">fsbl</span><span class="o">.</span><span class="n">elf</span>
    <span class="n">C</span><span class="p">:</span>\<span class="n">edt</span>\<span class="n">edt_zc702_linux</span>\<span class="n">qspi</span>\<span class="n">system</span><span class="o">.</span><span class="n">bit</span>
    <span class="n">C</span><span class="p">:</span>\<span class="n">edt</span>\<span class="n">edt_zc702_linux</span>\<span class="n">qspi</span>\<span class="n">u</span><span class="o">-</span><span class="n">boot</span><span class="o">.</span><span class="n">elf</span>
    <span class="p">[</span><span class="n">offset</span> <span class="o">=</span> <span class="mh">0x520000</span><span class="p">]</span><span class="n">C</span><span class="p">:</span>\<span class="n">edt</span>\<span class="n">edt_zc702_linux</span>\<span class="n">qspi</span>\<span class="n">image</span><span class="o">.</span><span class="n">ub</span>
    <span class="p">[</span><span class="n">offset</span> <span class="o">=</span> <span class="mh">0xFC0000</span><span class="p">]</span><span class="n">C</span><span class="p">:</span>\<span class="n">edt</span>\<span class="n">edt_zc702_linux</span>\<span class="n">qspi</span>\<span class="n">boot</span><span class="o">.</span><span class="n">scr</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="programming-qspi-flash-with-the-flash-programming-tool">
<h3>Programming QSPI Flash with the Flash Programming Tool<a class="headerlink" href="#programming-qspi-flash-with-the-flash-programming-tool" title="Permalink to this headline">¶</a></h3>
<p>You can use the Flash Programming Tool in the Vitis IDE to program <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span></code> into the QSPI Flash. The Program Flash GUI Wizard in Vitis IDE provides an easy way to select files and programming modes. When the settings are ready, it can call the <code class="docutils literal notranslate"><span class="pre">program_flash</span></code> command line tool to do the programming task. This is an easy-to-use method. You can also use JTAG to load U-Boot to DDR and use the U-Boot to program QSPI Flash. This method will be introduced in the next section.</p>
<p>Following the steps below, you can program QSPI Flash with the flash programming tool in the Vitis software platform:</p>
<ol>
<li><p>Power on the ZC702 board in JTAG boot mode (SW16 = 00000).</p></li>
<li><p>Select <strong>Xilinx → Program Flash</strong> in the Vitis IDE.</p></li>
<li><p>Set the Image File to the <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> file.</p></li>
<li><p>Set the Flash Type to <strong>qspi-x4-single</strong>.</p></li>
<li><p>Enable <strong>Blank Check after Erase</strong> and <strong>Verify after flash</strong>.</p></li>
<li><p>Select <strong>Program</strong>.</p>
<p><img alt="Program Flash Tool" src="../../_images/vitis_program_flash.png" /></p>
</li>
</ol>
<p>Upon successful programming, a message appears in the Console window
saying “Flash Operation Successful”.</p>
<ol class="simple">
<li><p>Power off the board and boot it in QSPI boot mode (SW16=01000).</p></li>
</ol>
</div>
<div class="section" id="optional-programning-qspi-flash-with-the-boot-image-using-jtag">
<h3>(Optional) Programning QSPI Flash with the Boot Image Using JTAG<a class="headerlink" href="#optional-programning-qspi-flash-with-the-boot-image-using-jtag" title="Permalink to this headline">¶</a></h3>
<p>This is an alternative way for programming QSPI Flash with the flash programming tool. You can program QSPI Flash using JTAG and U-Boot. This method provides more control to user because U-Boot is programmable. For example, you can extend this method to use Ethernet, rather than JTAG, to send <code class="docutils literal notranslate"><span class="pre">BOOT.bin</span></code> to the ZC702 DDR memory so that the program process can be faster.</p>
<ol>
<li><p>Power on the ZC702 Board.</p></li>
<li><p>If a serial terminal is not already open, connect the serial
terminal with the baud rate set to 115200.</p>
<p><strong>Note:</strong> This is the baud rate that the UART is programmed to on Zynq devices.</p>
</li>
<li><p>Select <strong>Xilinx → XSCT Console</strong> to open the XSCT tool.</p></li>
<li><p>From the XSCT prompt, do the following:</p>
<ul>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">connect</span></code> to connect with the PS section.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">targets</span></code> to get the list of target processors.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">ta</span> <span class="pre">2</span></code> to select the processor CPU1.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">dow</span> <span class="pre">fsbl.elf</span></code> to download the FSBL image.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">con</span></code> and then run <code class="docutils literal notranslate"><span class="pre">stop</span></code> to use FSBL to initialize the Zynq-7000 device.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">dow</span> <span class="pre">u-boot.elf</span></code> to download the Linux U-Boot.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">dow</span> <span class="pre">-data</span> <span class="pre">BOOT.bin</span> <span class="pre">0x08000000</span></code> to download the Linux bootable image to the target memory at location 0x08000000.</p>
<p>You just downloaded the binary executable to DDR memory. You can
download the binary executable to any address in DDR memory.</p>
</li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">con</span></code> to start execution of U-Boot. U-Boot begins booting. On the serial terminal, the autoboot countdown message appears:</p>
<p><code class="docutils literal notranslate"><span class="pre">Hit</span> <span class="pre">any</span> <span class="pre">key</span> <span class="pre">to</span> <span class="pre">stop</span> <span class="pre">autoboot:</span> <span class="pre">3</span></code></p>
</li>
</ul>
</li>
<li><p>Press <strong>Enter</strong>. Automatic booting from U-Boot stops and the U-Boot command prompt appears on the serial terminal.</p></li>
<li><p>Perform the following steps to use U-Boot to program the bootable image to QSPI Flash in the serial console:</p>
<ul class="simple">
<li><p>At the prompt, run <code class="docutils literal notranslate"><span class="pre">sf</span> <span class="pre">probe</span> <span class="pre">0</span> <span class="pre">1000000</span> <span class="pre">0</span></code> to select the QSPI Flash and set the clock to 1 MHz.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">sf</span> <span class="pre">erase</span> <span class="pre">0</span> <span class="pre">0x01000000</span></code> to erase the Flash data. This command completely erases 16 MB of on-board QSPI Flash memory.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">sf</span> <span class="pre">write</span> <span class="pre">0x08000000</span> <span class="pre">0</span> <span class="pre">0xffffff</span></code> to write the boot image on the
QSPI Flash.</p></li>
</ul>
<p>Note that you already copied the bootable image at DDR location
0x08000000. This command copied the data, of the size equivalent to
the bootable image size, from DDR to QSPI location 0x0.</p>
<p>For this example, because you have 16 MB of Flash memory, you copied
16 MB of data. You can change the argument to adjust the bootable
image size.</p>
</li>
<li><p>Power off the board and follow the booting steps described in the
following section.</p></li>
</ol>
</div>
<div class="section" id="booting-linux-from-qspi-flash">
<h3>Booting Linux from QSPI Flash<a class="headerlink" href="#booting-linux-from-qspi-flash" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>After you program the QSPI Flash, set the SW16 switch on your board as shown in the following figure.</p>
<p><img alt="../../_images/image88.jpeg" src="../../_images/image88.jpeg" /></p>
</li>
<li><p>Connect the serial terminal using a 115200 baud rate setting.</p>
<p><strong>Note:</strong> This is the baud rate that the UART is programmed to on
Zynq devices.</p>
</li>
<li><p>Switch on the board power.</p>
<p>A Linux booting message appears on the serial terminal. After booting
finishes, the <code class="docutils literal notranslate"><span class="pre">root&#64;xilinx-zc702-2020_2:~#</span></code> prompt appears. Enter the
login and password as root when prompted.</p>
</li>
<li><p>Check the board IP address connectivity as described in <a class="reference external" href="#booting-linux-in-jtag-mode">Booting Linux in JTAG Mode</a>.</p></li>
</ol>
<p>See the <a class="reference internal" href="8-custom-ip-driver-linux.html"><span class="doc">next chapter</span></a> for creating custom IP and device drivers for Linux.</p>
<p>© Copyright 2015–2021 Xilinx, Inc.</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p>http://www.apache.org/licenses/LICENSE-2.0</p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>
	  
	  
	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="8-custom-ip-driver-linux.html" class="btn btn-neutral float-right" title="Creating Custom IP and Device Drivers for Linux" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="6-using-hp-port.html" class="btn btn-neutral float-left" title="Using the HP Slave Port with AXI CDMA IP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
  </div>	  
      </div>
    </section>


  




  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>     	    
	    
	    
  
  
    
  
  

  
  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2021, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}
			
			underscoreSetup();
		</script>
	</body>
</html>